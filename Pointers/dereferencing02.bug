Problems with *q++ and use of z2...
Ends up with a wrong unreachable.
