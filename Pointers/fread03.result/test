
PROPER EFFECTS

byte * * LoadPGM_bmatrix(char *filename, int *nrl, int *nrh, int *ncl, int *nch)
{
//             <    is written>: height width
   int height = 10, width = 10;
   //, gris;
   byte **m;
   FILE *file;
   char *buffer;
   int i;
//             <    is written>: buffer

   buffer = (char *) calloc(80, sizeof(char));
//             <may be read   >: *ANY_MODULE*:*ANYWHERE* 
//                               __IO_EFFECTS:LUNS[*]
//             <may be written>: __IO_EFFECTS:LUNS[*]
//             <    is written>: file
   file = fopen(filename, "rb");
//             <    is read   >: file
   if (file==(void *) 0)
//             <may be read   >: stderr[0]
//             <may be written>: stderr[0]
//             <    is read   >: stderr __IO_EFFECTS:LUNS[2]
//             <    is written>: __IO_EFFECTS:LUNS[2]
      nrerror("ouverture du fichier impossible\n");
//             <    is read   >: buffer
   
   // The code synthesis fails because of type_supporting_entities() which explodes the stack
   //readitem(file, buffer);
   if (strcmp(buffer, "P5")!=0)
//             <may be read   >: stderr[0]
//             <may be written>: stderr[0]
//             <    is read   >: stderr __IO_EFFECTS:LUNS[2]
//             <    is written>: __IO_EFFECTS:LUNS[2]
      nrerror("entete du fichier %s invalide\n");
//             <may be written>: *ANY_MODULE*:*ANYWHERE*
//             <    is read   >: nrl
   
   //width  = atoi(readitem(file, buffer));
   //height = atoi(readitem(file, buffer));
   //gris   = atoi(readitem(file, buffer));
   
   *nrl = 0;
//             <may be written>: *ANY_MODULE*:*ANYWHERE*
//             <    is read   >: height nrh
   *nrh = height-1;
//             <may be written>: *ANY_MODULE*:*ANYWHERE*
//             <    is read   >: ncl
   *ncl = 0;
//             <may be written>: *ANY_MODULE*:*ANYWHERE*
//             <    is read   >: nch width
   *nch = width-1;
//             <may be read   >: *ANY_MODULE*:*ANYWHERE*
//             <may be written>: *ANY_MODULE*:*ANYWHERE*
//             <    is read   >: _MALLOC_EFFECTS:_MALLOC_
//             <    is written>: _MALLOC_EFFECTS:_MALLOC_
   m = bmatrix(*nrl, *nrh, *ncl, *nch);
//             <    is read   >: height
//             <    is written>: i

   for(i = 0; i <= height-1; i += 1)
//             <may be read   >: *ANY_MODULE*:*ANYWHERE* 
//                               __IO_EFFECTS:LUNS[*]
//             <may be written>: *ANY_MODULE*:*ANYWHERE* 
//                               __IO_EFFECTS:LUNS[*]
      ReadPGMrow(file, width, m[i]);
//             <may be read   >: *ANY_MODULE*:*ANYWHERE* 
//                               __IO_EFFECTS:LUNS[*]
//             <may be written>: *ANY_MODULE*:*ANYWHERE* 
//                               __IO_EFFECTS:LUNS[*]

   fclose(file);
//             <    is read   >: buffer _MALLOC_EFFECTS:_MALLOC_
//             <    is written>: _MALLOC_EFFECTS:_MALLOC_
   free(buffer);
//             <    is read   >: m

   return m;
}
void ReadPGMrow(FILE *file, int width, byte *line)
{
//             <may be read   >: *ANY_MODULE*:*ANYWHERE* 
//                               __IO_EFFECTS:LUNS[*]
//             <may be written>: *ANY_MODULE*:*ANYWHERE* 
//                               __IO_EFFECTS:LUNS[*]
   fread(&line[0], sizeof(byte), width, file);
}
byte * * bmatrix(int nrl, int nrh, int ncl, int nch)
{
//             <    is read   >: nch ncl nrh nrl
//             <    is written>: ncol nrow
   int i, nrow = nrh-nrl+1, ncol = nch-ncl+1;
   byte **m;
//             <    is read   >: ncol nrow _MALLOC_EFFECTS:_MALLOC_
//             <    is written>: m _MALLOC_EFFECTS:_MALLOC_
   
   /* allocate pointers to rows */
   m = (byte **) malloc((size_t) ((nrow+ncol)*sizeof(byte *)));
//             <    is read   >: nrh nrl
//             <    is written>: i
   for(i = nrl+1; i <= nrh; i += 1)
//             <may be read   >: *ANY_MODULE*:*ANYWHERE*
//             <may be written>: *ANY_MODULE*:*ANYWHERE*
      m[i] = m[i-1]+ncol;
//             <    is read   >: m
   /* return pointer to array of pointers to rows */
   return m;
}
void nrerror(char error_text[])
{
//             <may be read   >: stderr[0]
//             <may be written>: stderr[0]
//             <    is read   >: stderr __IO_EFFECTS:LUNS[2]
//             <    is written>: __IO_EFFECTS:LUNS[2]
   fprintf(stderr, "Numerical Recipes run-time error...\n");
//             <may be read   >: error_text[*] stderr[0]
//             <may be written>: stderr[0]
//             <    is read   >: stderr __IO_EFFECTS:LUNS[2]
//             <    is written>: __IO_EFFECTS:LUNS[2]
   fprintf(stderr, "%s\n", error_text);
//             <may be read   >: stderr[0]
//             <may be written>: stderr[0]
//             <    is read   >: stderr __IO_EFFECTS:LUNS[2]
//             <    is written>: __IO_EFFECTS:LUNS[2]
   fprintf(stderr, "...now exiting to system...\n");
   exit(1);
}

PROPER POINTER EFFECTS

void nrerror(char error_text[])
{
//             <may be read   >: stderr[0]
//             <may be written>: stderr[0]
//             <    is read   >: stderr __IO_EFFECTS:LUNS[2]
//             <    is written>: __IO_EFFECTS:LUNS[2]
   fprintf(stderr, "Numerical Recipes run-time error...\n");
//             <may be read   >: error_text[*] stderr[0]
//             <may be written>: stderr[0]
//             <    is read   >: stderr __IO_EFFECTS:LUNS[2]
//             <    is written>: __IO_EFFECTS:LUNS[2]
   fprintf(stderr, "%s\n", error_text);
//             <may be read   >: stderr[0]
//             <may be written>: stderr[0]
//             <    is read   >: stderr __IO_EFFECTS:LUNS[2]
//             <    is written>: __IO_EFFECTS:LUNS[2]
   fprintf(stderr, "...now exiting to system...\n");
   exit(1);
}

POINTS TO


// Points To IN:
// nch -> *NULL_POINTER* , MAY
// nch -> _nch_5[0] , MAY
// ncl -> *NULL_POINTER* , MAY
// ncl -> _ncl_4[0] , MAY
// nrh -> *NULL_POINTER* , MAY
// nrh -> _nrh_3[0] , MAY
// nrl -> *NULL_POINTER* , MAY
// nrl -> _nrl_2[0] , MAY


// Points To OUT:
// LoadPGM_bmatrix -> *ANY_MODULE*:*ANYWHERE*_b1 , MAY

byte * * LoadPGM_bmatrix(char *filename, int *nrl, int *nrh, int *ncl, int *nch)
{

// Points To: none

   int height = 10, width = 10;
   //, gris;

// Points To: none

   byte **m;

// Points To:
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT

   FILE *file;

// Points To:
// file -> *ANY_MODULE*:*NOWHERE*_b1 , EXACT
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT

   char *buffer;

// Points To:
// buffer -> *ANY_MODULE*:*NOWHERE*_b2 , EXACT
// file -> *ANY_MODULE*:*NOWHERE*_b1 , EXACT
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT

   int i;

// Points To:
// buffer -> *ANY_MODULE*:*NOWHERE*_b2 , EXACT
// file -> *ANY_MODULE*:*NOWHERE*_b1 , EXACT
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT


   buffer = (char *) calloc(80, sizeof(char));

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*NOWHERE*_b1 , EXACT
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT

   file = fopen(filename, "rb");

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT

   if (file==(void *) 0)

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *NULL_POINTER* , EXACT
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT

      nrerror("ouverture du fichier impossible\n");

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// file -> *NULL_POINTER* , MAY
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT

   
   // The code synthesis fails because of type_supporting_entities() which explodes the stack
   //readitem(file, buffer);
   if (strcmp(buffer, "P5")!=0)

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// file -> *NULL_POINTER* , MAY
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT

      nrerror("entete du fichier %s invalide\n");

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// file -> *NULL_POINTER* , MAY
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT

   
   //width  = atoi(readitem(file, buffer));
   //height = atoi(readitem(file, buffer));
   //gris   = atoi(readitem(file, buffer));
   
   *nrl = 0;

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// file -> *NULL_POINTER* , MAY
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT
// nrl -> _nrl_2[0] , EXACT

   *nrh = height-1;

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// file -> *NULL_POINTER* , MAY
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT
// nrh -> _nrh_3[0] , EXACT
// nrl -> _nrl_2[0] , EXACT

   *ncl = 0;

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// file -> *NULL_POINTER* , MAY
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT
// ncl -> _ncl_4[0] , EXACT
// nrh -> _nrh_3[0] , EXACT
// nrl -> _nrl_2[0] , EXACT

   *nch = width-1;

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// file -> *NULL_POINTER* , MAY
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT
// nch -> _nch_5[0] , EXACT
// ncl -> _ncl_4[0] , EXACT
// nrh -> _nrh_3[0] , EXACT
// nrl -> _nrl_2[0] , EXACT

   m = bmatrix(*nrl, *nrh, *ncl, *nch);

// Points To:
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// file -> *NULL_POINTER* , MAY
// m -> *ANY_MODULE*:*ANYWHERE*_b1 , MAY
// nch -> _nch_5[0] , EXACT
// ncl -> _ncl_4[0] , EXACT
// nrh -> _nrh_3[0] , EXACT
// nrl -> _nrl_2[0] , EXACT


   for(i = 0; i <= height-1; i += 1)

// Points To:
// *ANY_MODULE*:*ANYWHERE*_b1[*] -> *ANY_MODULE*:*ANYWHERE*_b2 , MAY
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// file -> *NULL_POINTER* , MAY
// m -> *ANY_MODULE*:*ANYWHERE*_b1 , MAY
// nch -> _nch_5[0] , EXACT
// ncl -> _ncl_4[0] , EXACT
// nrh -> _nrh_3[0] , EXACT
// nrl -> _nrl_2[0] , EXACT

      ReadPGMrow(file, width, m[i]);

// Points To:
// *ANY_MODULE*:*ANYWHERE*_b1[*] -> *ANY_MODULE*:*ANYWHERE*_b2 , MAY
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*ANYWHERE*_b0 , MAY
// file -> *NULL_POINTER* , MAY
// m -> *ANY_MODULE*:*ANYWHERE*_b1 , MAY
// nch -> _nch_5[0] , EXACT
// ncl -> _ncl_4[0] , EXACT
// nrh -> _nrh_3[0] , EXACT
// nrl -> _nrl_2[0] , EXACT


   fclose(file);

// Points To:
// *ANY_MODULE*:*ANYWHERE*_b1[*] -> *ANY_MODULE*:*ANYWHERE*_b2 , MAY
// buffer -> *ANY_MODULE*:*HEAP*_b1[0] , MAY
// file -> *ANY_MODULE*:*NOWHERE*_b1 , EXACT
// m -> *ANY_MODULE*:*ANYWHERE*_b1 , MAY
// nch -> _nch_5[0] , EXACT
// ncl -> _ncl_4[0] , EXACT
// nrh -> _nrh_3[0] , EXACT
// nrl -> _nrl_2[0] , EXACT

   free(buffer);

// Points To:
// *ANY_MODULE*:*ANYWHERE*_b1[*] -> *ANY_MODULE*:*ANYWHERE*_b2 , MAY
// buffer -> *ANY_MODULE*:*NOWHERE*_b2 , EXACT
// file -> *ANY_MODULE*:*NOWHERE*_b1 , EXACT
// m -> *ANY_MODULE*:*ANYWHERE*_b1 , MAY
// nch -> _nch_5[0] , EXACT
// ncl -> _ncl_4[0] , EXACT
// nrh -> _nrh_3[0] , EXACT
// nrl -> _nrl_2[0] , EXACT


   return m;
}

// Points To IN:
// line -> *NULL_POINTER* , MAY
// line -> _line_3[0] , MAY


// Points To OUT: none

void ReadPGMrow(FILE *file, int width, byte *line)
{

// Points To: none

   fread(&line[0], sizeof(byte), width, file);
}

// Points To IN: none


// Points To OUT:
// bmatrix -> *ANY_MODULE*:*HEAP*_b0[0] , MAY

byte * * bmatrix(int nrl, int nrh, int ncl, int nch)
{

// Points To: none

   int i, nrow = nrh-nrl+1, ncol = nch-ncl+1;

// Points To: none

   byte **m;

// Points To:
// m -> *ANY_MODULE*:*NOWHERE*_b0 , EXACT

   
   /* allocate pointers to rows */
   m = (byte **) malloc((size_t) ((nrow+ncol)*sizeof(byte *)));

// Points To:
// m -> *ANY_MODULE*:*HEAP*_b0[0] , MAY

   for(i = nrl+1; i <= nrh; i += 1)

// Points To:
// m -> *ANY_MODULE*:*HEAP*_b0[0] , MAY

      m[i] = m[i-1]+ncol;

// Points To:
// m -> *ANY_MODULE*:*HEAP*_b0[0] , MAY

   /* return pointer to array of pointers to rows */
   return m;
}

// Points To IN: none


// Points To OUT: none

void nrerror(char error_text[])
{

// Points To: none

   fprintf(stderr, "Numerical Recipes run-time error...\n");

// Points To: none

   fprintf(stderr, "%s\n", error_text);

// Points To: none

   fprintf(stderr, "...now exiting to system...\n");

// Points To: none

   exit(1);
}
