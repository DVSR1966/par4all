The C code is incorrect.
