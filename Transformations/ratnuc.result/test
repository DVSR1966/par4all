
C  <QNUC(PHI1)-W-MAY-{1<=PHI1}>
C  <RATX(PHI1)-W-MAY-{1<=PHI1}>
C  <TA(PHI1)-R-MAY-{2<=PHI1, PHI1<=NPP1}>
C  <VA(PHI1)-R-MAY-{2<=PHI1, PHI1<=NPP1}>
C  <XXA(PHI1)-R-MAY-{2<=PHI1, PHI1<=NPP1}>
C  <YYA(PHI1)-R-MAY-{2<=PHI1, PHI1<=NPP1}>
C  <ZZA(PHI1)-R-MAY-{2<=PHI1, PHI1<=NPP1}>

CDECK RATNUC
      SUBROUTINE  RATNUC
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      SAVE
C     ------------------------------------------------------------------
      COMMON  /VECTA/  VA(401),SA(401),PA(401),PEA(401),TA(401)
      COMMON  /VECTA/  RA(401),TAUA(401),FRA(401),FCA(401)
      COMMON  /VECTA/  QNUC(401),RATX(401)
      COMMON  /VECTA/  CPA(401),DADA(401)
      COMMON  /VECTA/  CC(401),UA(401),QT(401),EA(401)
      COMMON  /VECTA/  FCT(401),TAUC(401)
      COMMON  /VECTA/  PVS(401)
      COMMON  /VECTA/  OPACA(401),DOPDVA(401),DOPDTA(401)
      COMMON  /VECTAI/ KONV(401)
C     ------------------------------------------------------------------
      COMMON  /COMPOS/  XXX,YYY,ZZZ
      COMMON  /COMPOS/  XXA(401),YYA(401),ZZA(401)
      COMMON  /COMPOS/  EFF(401),DRODEF(401)
      COMMON  /COMPOSI/ JPOINT
C     ------------------------------------------------------------------
      COMMON  /COMPROG/  FACMIX,FLUM,PEXTER,TAUEX,PSTART
      COMMON  /COMPROI/  NP,NPP1

C  <QNUC(PHI1)-W-MAY-{2<=PHI1, PHI1<=NPP1}>
C  <RATX(PHI1)-W-MAY-{2<=PHI1, PHI1<=NPP1}>
C  <TA(PHI1)-R-MAY-{2<=PHI1, PHI1<=NPP1}>
C  <VA(PHI1)-R-MAY-{2<=PHI1, PHI1<=NPP1}>
C  <XXA(PHI1)-R-MAY-{2<=PHI1, PHI1<=NPP1}>
C  <YYA(PHI1)-R-MAY-{2<=PHI1, PHI1<=NPP1}>
C  <ZZA(PHI1)-R-MAY-{2<=PHI1, PHI1<=NPP1}>

C     ------------------------------------------------------------------
      DO 1 I = 2, NPP1                                                  0001

C  <QNUC(PHI1)-W-EXACT-{PHI1==I, 2<=I, I<=NPP1}>

         QNUC(I) = 0.0D0                                                0002

C  <RATX(PHI1)-W-EXACT-{PHI1==I, 2<=I, I<=NPP1}>

         RATX(I) = 0.0D0                                                0003

C  <XXA(PHI1)-R-EXACT-{PHI1==I, 2<=I, I<=NPP1}>

         X = XXA(I)                                                     0004

C  <YYA(PHI1)-R-EXACT-{PHI1==I, 2<=I, I<=NPP1}>

         Y = YYA(I)                                                     0005

C  <ZZA(PHI1)-R-EXACT-{PHI1==I, 2<=I, I<=NPP1}>

         ZCN = ZZA(I)                                                   0006
         EPP = 0.D0                                                     0007
         ECN = 0.D0                                                     0008

C  <TA(PHI1)-R-EXACT-{PHI1==I, 2<=I, I<=NPP1}>

         T = TA(I)/1.D+6                                                0009
         T13 = T**(1.D0/3.D0)                                           0010

C  <VA(PHI1)-R-EXACT-{PHI1==I, 2<=I, I<=NPP1}>

         RO = 1.D0/VA(I)                                                0011

C  <QNUC(PHI1)-W-MAY-{PHI1==I, 2<=I, I<=NPP1}>
C  <RATX(PHI1)-W-MAY-{PHI1==I, 2<=I, I<=NPP1}>

         IF (T.GE.1.0D0) THEN                                           0012

C  <QNUC(PHI1)-W-MAY-{PHI1==I, 2<=I, I<=NPP1}>
C  <RATX(PHI1)-W-MAY-{PHI1==I, 2<=I, I<=NPP1}>

            IF (X.GE.1.D-20) THEN                                       0013
               SQTR = SQRT(RO/(T**3))                                   0014
               W = 1.22D16*X/(1.D0+X)*(1.D0+SQTR)/SQRT(T13)*EXP(-       0015
     &         102.6D0/T13)                                             0015
               ALPHA = 5.48D17*(Y*0.25D0/X)**2*EXP(-100.D0/T13)         0016
C     changed to avoid data dependencies
C               IF(ALPHA.LE.1.D5) GAMA=SQRT(ALPHA*(2.D0+ALPHA))-ALPHA
C               IF(ALPHA.GT.1.D5) GAMA=1.D0-0.5D0/ALPHA
C     1              *(1.D0-1.D0/ALPHA)
               IF (ALPHA.LE.1.D5) THEN                                  0017
                  GAMA = SQRT(ALPHA*(2.D0+ALPHA))-ALPHA                 0018
               ELSE
                  GAMA = 1.D0-0.5D0/ALPHA*(1.D0-1.D0/ALPHA)             0019
               ENDIF
               PSI = 1.D0+GAMA*(0.959D0+0.47D0*W)/(1.D0+W)              0020
               G11 = 1.D0+0.0012D0*T13+0.0078D0*T13**2+0.0006D0*T       0021
               F11 = 1.D0+0.25D0*SQTR                                   0022
               EPP = 2.206D6*RO*X**2/(T13**2)*EXP(-33.81D0/T13)*F11*    0023
     &         G11*PSI                                                  0023
               IF (T.GE.6.D0) THEN                                      0024
                  IF (ZCN.GE.1.D-10) THEN                               0025
                     F14 = 1.D0+1.75D0*SQTR                             0026
                     G14 = 1.D0+0.0027D0*T13-0.0037D0*T13**2-0.0007D0   0027
     &               *T                                                 0027
                     ECN = 7.94D27*RO*X*ZCN/(T13**2)*EXP(-152.313D0/    0028
     &               T13)*F14*G14                                       0028
                  ENDIF
               ENDIF
2              CONTINUE                                                 0029
               E = EPP+ECN                                              0030
               RAT = EPP/6256.D0+ECN/6035.D0                            0031
               RAT = RAT/1.D15                                          0032

C  <QNUC(PHI1)-W-EXACT-{PHI1==I, 2<=I, I<=NPP1}>

               QNUC(I) = E                                              0033

C  <RATX(PHI1)-W-EXACT-{PHI1==I, 2<=I, I<=NPP1}>

               RATX(I) = RAT                                            0034
            ENDIF
         ENDIF
1        CONTINUE                                                       0035

C  <QNUC(PHI1)-W-EXACT-{PHI1==1, 1+NPP1<=I, 2<=I}>

      QNUC(1) = 0.0D0                                                   0036

C  <RATX(PHI1)-W-EXACT-{PHI1==1, 1+NPP1<=I, 2<=I}>

      RATX(1) = 0.0D0                                                   0037
      END
CDECK RATNUC
      SUBROUTINE  RATNUC
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      SAVE
C     ------------------------------------------------------------------
      COMMON  /VECTA/  VA(401),SA(401),PA(401),PEA(401),TA(401)
      COMMON  /VECTA/  RA(401),TAUA(401),FRA(401),FCA(401)
      COMMON  /VECTA/  QNUC(401),RATX(401)
      COMMON  /VECTA/  CPA(401),DADA(401)
      COMMON  /VECTA/  CC(401),UA(401),QT(401),EA(401)
      COMMON  /VECTA/  FCT(401),TAUC(401)
      COMMON  /VECTA/  PVS(401)
      COMMON  /VECTA/  OPACA(401),DOPDVA(401),DOPDTA(401)
      COMMON  /VECTAI/ KONV(401)
C     ------------------------------------------------------------------
      COMMON  /COMPOS/  XXX,YYY,ZZZ
      COMMON  /COMPOS/  XXA(401),YYA(401),ZZA(401)
      COMMON  /COMPOS/  EFF(401),DRODEF(401)
      COMMON  /COMPOSI/ JPOINT
C     ------------------------------------------------------------------
      COMMON  /COMPROG/  FACMIX,FLUM,PEXTER,TAUEX,PSTART
      COMMON  /COMPROI/  NP,NPP1
C     ------------------------------------------------------------------
      DOALL I = 2, NPP1                                                 0001
         PRIVATE ALPHA,E,ECN,EPP,F11,F14,G11,G14,GAMA,PSI,RAT,RO,SQTR
     &   ,T,T13,W,X,Y,ZCN
         QNUC(I) = 0.0D0                                                0002
         RATX(I) = 0.0D0                                                0003
         X = XXA(I)                                                     0004
         Y = YYA(I)                                                     0005
         ZCN = ZZA(I)                                                   0006
         EPP = 0.D0                                                     0007
         ECN = 0.D0                                                     0008
         T = TA(I)/1.D+6                                                0009
         T13 = T**(1.D0/3.D0)                                           0010
         RO = 1.D0/VA(I)                                                0011
         IF (T.GE.1.0D0) THEN                                           0012
            IF (X.GE.1.D-20) THEN                                       0013
               SQTR = SQRT(RO/(T**3))                                   0014
               W = 1.22D16*X/(1.D0+X)*(1.D0+SQTR)/SQRT(T13)*EXP(-       0015
     &         102.6D0/T13)                                             0015
               ALPHA = 5.48D17*(Y*0.25D0/X)**2*EXP(-100.D0/T13)         0016
C     changed to avoid data dependencies
C               IF(ALPHA.LE.1.D5) GAMA=SQRT(ALPHA*(2.D0+ALPHA))-ALPHA
C               IF(ALPHA.GT.1.D5) GAMA=1.D0-0.5D0/ALPHA
C     1              *(1.D0-1.D0/ALPHA)
               IF (ALPHA.LE.1.D5) THEN                                  0017
                  GAMA = SQRT(ALPHA*(2.D0+ALPHA))-ALPHA                 0018
               ELSE
                  GAMA = 1.D0-0.5D0/ALPHA*(1.D0-1.D0/ALPHA)             0019
               ENDIF
               PSI = 1.D0+GAMA*(0.959D0+0.47D0*W)/(1.D0+W)              0020
               G11 = 1.D0+0.0012D0*T13+0.0078D0*T13**2+0.0006D0*T       0021
               F11 = 1.D0+0.25D0*SQTR                                   0022
               EPP = 2.206D6*RO*X**2/(T13**2)*EXP(-33.81D0/T13)*F11*    0023
     &         G11*PSI                                                  0023
               IF (T.GE.6.D0) THEN                                      0024
                  IF (ZCN.GE.1.D-10) THEN                               0025
                     F14 = 1.D0+1.75D0*SQTR                             0026
                     G14 = 1.D0+0.0027D0*T13-0.0037D0*T13**2-0.0007D0   0027
     &               *T                                                 0027
                     ECN = 7.94D27*RO*X*ZCN/(T13**2)*EXP(-152.313D0/    0028
     &               T13)*F14*G14                                       0028
                  ENDIF
               ENDIF
2              CONTINUE                                                 0029
               E = EPP+ECN                                              0030
               RAT = EPP/6256.D0+ECN/6035.D0                            0031
               RAT = RAT/1.D15                                          0032
               QNUC(I) = E                                              0033
               RATX(I) = RAT                                            0034
            ENDIF
         ENDIF
1        CONTINUE                                                       0035
      ENDDO
      QNUC(1) = 0.0D0                                                   0036
      RATX(1) = 0.0D0                                                   0037
      END
