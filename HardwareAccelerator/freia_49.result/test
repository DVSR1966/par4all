#
# AIPO
#

! initial function

freia_status freia_49(freia_data2d *out, freia_data2d *in)
{
   freia_data2d *ta = freia_common_create_data(16, 128, 128);           /*0005*/
   freia_data2d *tb = freia_common_create_data(16, 128, 128);           /*0006*/
   freia_data2d *tc = freia_common_create_data(16, 128, 128);           /*0007*/
   freia_data2d *td = freia_common_create_data(16, 128, 128);           /*0008*/

   freia_aipo_set_constant(ta, 255);                                    /*0010*/
   freia_aipo_dilate_8c(tb, in, freia_morpho_kernel_8c);                /*0011*/
   freia_aipo_inf(tc, ta, tb);                                          /*0012*/
   freia_aipo_erode_8c(tb, tb, freia_morpho_kernel_8c);                 /*0013*/
   freia_aipo_inf(td, tc, tb);                                          /*0014*/
   freia_aipo_sub(out, in, td);                                         /*0015*/

   freia_common_destruct_data(ta);                                      /*0017*/
   freia_common_destruct_data(tb);                                      /*0018*/
   freia_common_destruct_data(tc);                                      /*0019*/
   freia_common_destruct_data(td);                                      /*0020*/
   return FREIA_OK;                                                     /*0021*/
}

! graphs

// graph for dag "dag_0" of module "freia_49" in dot format
digraph "dag_0" {
  // inputs
  "in" [shape=circle];

  // outputs
  "out" [shape=circle];

  // computation vertices
  "15 -" [shape=trapezium,orientation=270];
  "15 -" -> "out";
  "14 <" [shape=trapezium,orientation=270];
  "14 <" -> "15 -" [label="td"];
  "13 E8" [shape=box];
  "13 E8" -> "14 <" [label="tb"];
  "12 <" [shape=trapezium,orientation=270];
  "12 <" -> "14 <" [label="tc"];
  "11 D8" [shape=box];
  "11 D8" -> "13 E8" [label="tb"];
  "11 D8" -> "12 <" [label="tb"];
  "in" -> "15 -";
  "in" -> "11 D8";
  "10 C" [shape=trapezium,orientation=270];
  "10 C" -> "12 <" [label="ta"];
}
// graph for dag "dag_cleaned_0" of module "freia_49" in dot format
digraph "dag_cleaned_0" {
  // inputs
  "in" [shape=circle];

  // outputs
  "out" [shape=circle];

  // computation vertices
  "15 -" [shape=trapezium,orientation=270];
  "15 -" -> "out";
  "14 <" [shape=trapezium,orientation=270];
  "14 <" -> "15 -" [label="td"];
  "13 E8" [shape=box];
  "13 E8" -> "14 <" [label="tb"];
  "12 <" [shape=trapezium,orientation=270];
  "12 <" -> "14 <" [label="tc"];
  "11 D8" [shape=box];
  "11 D8" -> "13 E8" [label="tb"];
  "11 D8" -> "12 <" [label="tb"];
  "in" -> "15 -";
  "in" -> "11 D8";
  "10 C" [shape=trapezium,orientation=270];
  "10 C" -> "12 <" [label="ta"];
}

! updated function for

freia_status freia_49(freia_data2d *out, freia_data2d *in)
{
   freia_data2d *ta = freia_common_create_data(16, 128, 128);           /*0005*/
   freia_data2d *tb = freia_common_create_data(16, 128, 128);           /*0006*/
   freia_data2d *tc = freia_common_create_data(16, 128, 128);           /*0007*/
   freia_data2d *td = freia_common_create_data(16, 128, 128);           /*0008*/

   freia_aipo_set_constant(ta, 255);                                    /*0010*/
   freia_aipo_dilate_8c(tb, in, freia_morpho_kernel_8c);                /*0011*/
   freia_aipo_inf(tc, ta, tb);                                          /*0012*/
   freia_aipo_erode_8c(tb, tb, freia_morpho_kernel_8c);                 /*0013*/
   freia_aipo_inf(td, tc, tb);                                          /*0014*/
   freia_aipo_sub(out, in, td);                                         /*0015*/

   freia_common_destruct_data(ta);                                      /*0017*/
   freia_common_destruct_data(tb);                                      /*0018*/
   freia_common_destruct_data(tc);                                      /*0019*/
   freia_common_destruct_data(td);                                      /*0020*/
   return FREIA_OK;                                                     /*0021*/
}
#
# SPOC
#

! initial function

freia_status freia_49(freia_data2d *out, freia_data2d *in)
{
   freia_data2d *ta = freia_common_create_data(16, 128, 128);           /*0005*/
   freia_data2d *tb = freia_common_create_data(16, 128, 128);           /*0006*/
   freia_data2d *tc = freia_common_create_data(16, 128, 128);           /*0007*/
   freia_data2d *td = freia_common_create_data(16, 128, 128);           /*0008*/

   freia_aipo_set_constant(ta, 255);                                    /*0010*/
   freia_aipo_dilate_8c(tb, in, freia_morpho_kernel_8c);                /*0011*/
   freia_aipo_inf(tc, ta, tb);                                          /*0012*/
   freia_aipo_erode_8c(tb, tb, freia_morpho_kernel_8c);                 /*0013*/
   freia_aipo_inf(td, tc, tb);                                          /*0014*/
   freia_aipo_sub(out, in, td);                                         /*0015*/

   freia_common_destruct_data(ta);                                      /*0017*/
   freia_common_destruct_data(tb);                                      /*0018*/
   freia_common_destruct_data(tc);                                      /*0019*/
   freia_common_destruct_data(td);                                      /*0020*/
   return FREIA_OK;                                                     /*0021*/
}
