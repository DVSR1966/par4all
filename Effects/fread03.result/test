byte * * LoadPGM_bmatrix(char *filename, int *nrl, int *nrh, int *ncl, int *nch)
{
   int height;
   int width;
   int gris;
   byte **m;
   FILE *file;
   char *buffer;
   int i;

   buffer = (char *) calloc(80, sizeof(char));
   file = fopen(filename, "rb");
   if (file==(void *) 0) 
      nrerror("ouverture du fichier impossible\n");

   readitem(file, buffer);
   if (strcmp(buffer, "P5")!=0) 
      nrerror("entete du fichier %s invalide\n");

   width = atoi(readitem(file, buffer));
   height = atoi(readitem(file, buffer));
   gris = atoi(readitem(file, buffer));

   *nrl = 0;
   *nrh = height-1;
   *ncl = 0;
   *nch = width-1;
   m = bmatrix(*nrl, *nrh, *ncl, *nch);

   for(i = 0; i <= height-1; i += 1)
      ReadPGMrow(file, width, m[i]);

   fclose(file);
   free(buffer);

   return m;
}
void ReadPGMrow(FILE *file, int width, byte *line)
{
   fread(&line[0], sizeof(byte), width, file);
}
