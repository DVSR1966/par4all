#!/bin/sh

tpips=${tpips_version:-tpips}

# Initialization:
# rm -f destroy.result/test
# tpips >destroy.result/test <<EOF

Delete destroy

$tpips <<EOF
# Check that interferences between scalar and non integer 
# scalar variables are well handled

echo
echo First version: no array or real interference in module BAR
echo

create destroy ${PIPS_ROOT}/Validation/Semantics/destroy.f

# Comment out the previous line and the next line can be used to core dump tpips
# create destroy /Semantics/destroy.f

activate TRANSFORMERS_INTER_FAST
activate PRECONDITIONS_INTER_FAST

module DESTROY
activate PRINT_CODE_PRECONDITIONS
display PRINTED_FILE

close
delete destroy

echo
echo Second version: array and real variable interference in module BAR
echo

shell rm -f destroy2.f
shell sed s/cfirst// ${PIPS_ROOT}/Validation/Semantics/destroy.f >destroy2.f

create destroy destroy2.f

activate TRANSFORMERS_INTER_FAST
activate PRECONDITIONS_INTER_FAST

module DESTROY
activate PRINT_CODE_PRECONDITIONS
display PRINTED_FILE

close
delete destroy

shell rm -f destroy2.f

quit
EOF

