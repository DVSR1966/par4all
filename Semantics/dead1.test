#!/bin/sh

tpips=${tpips_version:-tpips}

# Initialization:
# rm -f precprec.result/test
# tpips >precprec.result/test <<EOF

$tpips <<EOF
# Check that a dead call to PR does not impact PR's precondition

delete dead1
create dead1 ${PIPS_ROOT}/Validation/Semantics/dead1.f
# create dead1 dead1.f
module PR
activate TRANSFORMERS_INTER_FULL
activate INTERPROCEDURAL_SUMMARY_PRECONDITION
activate PRECONDITIONS_INTER_FULL
activate PRINT_CODE_PRECONDITIONS

shell echo Without explicit dead code elimination:

display PRINTED_FILE

# This SHOULD be useless
module DEAD1
apply SUPPRESS_DEAD_CODE

shell echo After dead code elimination:

module PR
display PRINTED_FILE

close
delete dead1
quit
EOF

