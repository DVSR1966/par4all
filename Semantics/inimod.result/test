
C  T() {}

      SUBROUTINE INIMOD

      IMPLICIT REAL*8 (A-H, O-Z)
*
*
      PARAMETER  ( MP   =      402 ,   NP   =       160 )
      PARAMETER  ( M1   =   MP - 1 ,   N1   =   NP - 1 )
*
*
*
      PARAMETER  ( XLZ =       30.0D0 )
      PARAMETER  ( XLR =        8.0D0 )
*
C     PARAMETER  ( XCZ =       30.0D0 )
      PARAMETER  ( XCZ =       15.0D0 )
      PARAMETER  ( XSZ =       30.0D0 )
*
      PARAMETER  ( RO0 =        1.0D0 )
      PARAMETER  ( PR0 =        0.6D0 )
*
      PARAMETER  ( XLJET =      1.0D0 )
      PARAMETER  ( ROJET =      0.1D0 )
      PARAMETER  ( PRJET =      0.6D0 )
      PARAMETER  (  VJET =    18.97D0 )

      COMMON /PRMT/   TS, DT, GAM, CFL,VCT,
     &                TZ,TR, FTZ,FTR, BSZ,BSR, QTZ,QTR, IS
      COMMON /GRID/   Z(MP), ZB(0:MP), DZ(MP), DBZ(0:MP), FZ(M1),
     &                R(NP), RB(0:NP), DR(NP), DBR(0:NP), FR(N1),
     &                DUM(8)
* Dum is a dummy             a.w.
      COMMON /VAR1/   RO(MP,NP), EN(MP,NP),
     &                GZ(MP,NP), GR(MP,NP)

C  T(I,J,MPCON,MPSTR,NPJET) {3<=I, 803<=I+400J, 2I+5J<=811,
C    NPJET+1<=J, MPCON<=401}

C (0,1)
C     BEGIN BLOCK

C  T() {}

C (0,2)
*
*
***********************************************************************
*     OPEN MODEL INPUT
***********************************************************************
      OPEN (UNIT=11,FILE='HYDRO2D.MODEL',STATUS='OLD')                  0001

C  T() {}

C (0,3)
***********************************************************************
*     SET BASIC PARAMETERS
***********************************************************************
*
*
      GAM = DBLE(5.0D0)/DBLE(3.0D0)                                     0002

C  T() {}

C (0,4)
*
      TZ = XLZ/(MP-2)                                                   0003

C  T() {}

C (0,5)
      TR = XLR/NP                                                       0004

C  T() {}

C (0,6)
      FTZ = DBLE(-2.0D0)*TZ                                             0005

C  T() {}

C (0,7)
      FTR = 0.0D0                                                       0006

C  T() {}

C (0,8)
      BSZ = 1.0D0                                                       0007

C  T() {}

C (0,9)
      BSR = 1.0D0                                                       0008

C  T() {}

C (0,10)
      QTZ = 1.0D0                                                       0009

C  T() {}

C (0,11)
      QTR = 1.0D0                                                       0010

C  T() {}

C (0,12)
*
*
***********************************************************************
*     SET VARIABLES
***********************************************************************
*
*
      CON = GAM-1.0D0                                                   0011

C  T() {}

C (0,13)
      EN0 = PR0/CON                                                     0012

C  T(MPCON) {}

C (0,14)
*
      MPCON = NINT(MP*XCZ/XLZ)                                          0013

C  T(MPSTR) {}

C (0,15)
      MPSTR = NINT(MP*XSZ/XLZ)                                          0014

C  T(J) {J==1}

C (0,16)
      J = 1                                                             0015
C (0,17)
99995 CONTINUE

C  T() {}

C (1,1)
*
C     DO loop 5 with exit had to be desugared
      IF (J.GT.NP) GOTO 99998                                           0015

C  T(I) {I==1, J<=160}

C (10,1)
      I = 1                                                             0016
99996 CONTINUE

C  T() {J<=160}

C (7,1)
C     DO loop 5 with exit had to be desugared
      IF (I.GT.MP) GOTO 99997                                           0016

C  T() {1<=I, I<=402, 1<=J, J<=160}

C (9,1)
      READ (UNIT=11,FMT=1000,END=99) RO(I,J)                            0017

C  T(I) {I==I#init+1, 2<=I, I<=403, 1<=J, J<=160}

C (6,1)
C     BEGIN BLOCK

C  T() {1<=I, I<=402, 1<=J, J<=160}

C (6,2)
5     CONTINUE                                                          0018

C  T(I) {I==I#init+1, 2<=I, I<=403, 1<=J, J<=160}

C (6,3)
      I = I+1                                                           0016
C     END BLOCK
      GOTO 99996

C  T() {0==-1}

C (4,1)
C     BEGIN BLOCK

C  T() {1<=I, I<=402, 1<=J, J<=160}

C (4,2)
99    WRITE (6, 1099)                                                   0039

C  T() {0==-1}

C (4,3)
      STOP                                                              0040

C  T() {0==-1}

C (4,4)
1000  FORMAT(E20.14)                                                    0041

C  T() {0==-1}

C (4,5)
1099  FORMAT(' NO FURTHER MODEL DATA AVAILABLE, STOP')                  0042
C     END BLOCK
99997 CONTINUE

C  T(J) {I==403, J==J#init+1, J<=161}

C (8,1)
      J = J+1                                                           0015
      GOTO 99995
99998 CONTINUE

C  T(I,J,NPJET) {3<=I, 803<=I+400J, 2I+5J<=811, NPJET+1<=J,
C    MPCON<=401}

C (2,1)
C     BEGIN BLOCK

C  T(I,J) {1<=J}

C (2,2)
      DO 10 J = 1, NP                                                   0019

C  T(I) {1<=I, 1<=J, J<=160}

C (2,3)
         DO 10 I = 1, MPCON                                             0020

C  T() {1<=I, I<=402, I<=MPCON, 1<=J, J<=160}

C (2,4)
C           BEGIN BLOCK

C  T() {1<=I, I<=402, I<=MPCON, 1<=J, J<=160}

C (2,5)
C        RO(I,J) =  RO0
            EN(I,J) = EN0                                               0021

C  T() {1<=I, I<=402, I<=MPCON, 1<=J, J<=160}

C (2,6)
            GZ(I,J) = 0.0D0                                             0022

C  T() {1<=I, I<=402, I<=MPCON, 1<=J, J<=160}

C (2,7)
            GR(I,J) = 0.0D0                                             0023

C  T() {1<=I, I<=402, I<=MPCON, 1<=J, J<=160}

C (2,8)
10          CONTINUE                                                    0024
C           END BLOCK

C  T(I,J) {2<=I#init, I#init<=403, MPCON+1<=I#init, 1<=J}

C (2,9)
*
      DO 12 J = 1, NP                                                   0025

C  T(I) {MPCON+1<=I, 1<=J, J<=160, MPCON<=402}

C (2,10)
         DO 12 I = MPCON+1, MP                                          0026

C  T() {1<=I, I<=402, MPCON+1<=I, 1<=J, J<=160, MPCON<=402}

C (2,11)
C           BEGIN BLOCK

C  T() {1<=I, I<=402, MPCON+1<=I, 1<=J, J<=160, MPCON<=402}

C (2,12)
*        RO(I,J) =  RO0  *  10 ** ( REAL(MPCON-I) / REAL(MPSTR) )
C        RO(I,J) =  RO0  *  10 ** ( DBLE(MPCON-I) / DBLE(MPSTR) )
            EN(I,J) = EN0                                               0027

C  T() {1<=I, I<=402, MPCON+1<=I, 1<=J, J<=160, MPCON<=402}

C (2,13)
            GZ(I,J) = 0.0D0                                             0028

C  T() {1<=I, I<=402, MPCON+1<=I, 1<=J, J<=160, MPCON<=402}

C (2,14)
            GR(I,J) = 0.0D0                                             0029

C  T() {1<=I, I<=402, MPCON+1<=I, 1<=J, J<=160, MPCON<=402}

C (2,15)
12          CONTINUE                                                    0030
C           END BLOCK

C  T() {I==403, J==161, MPCON<=401}

C (2,16)
*
*
      ENJET = PRJET/CON+0.5D0*ROJET*VJET**2                             0031

C  T() {I==403, J==161, MPCON<=401}

C (2,17)
      GZJET = ROJET*VJET                                                0032

C  T(NPJET) {I==403, J==161, MPCON<=401}

C (2,18)
*
      NPJET = NINT(NP*XLJET/XLR)                                        0033

C  T(I,J) {I#init==403, 1<=J, MPCON<=401}

C (2,19)
*
      DO 20 J = 1, NPJET                                                0034

C  T(I) {1<=I, 1<=J, J<=NPJET, MPCON<=401}

C (2,20)
         DO 20 I = 1, 2                                                 0035

C  T() {1<=I, I<=2, 1<=J, J<=160, J<=NPJET, MPCON<=401}

C (2,21)
C           BEGIN BLOCK

C  T() {1<=I, I<=2, 1<=J, J<=160, J<=NPJET, MPCON<=401}

C (2,22)
C        RO(I,J) =  ROJET
            EN(I,J) = ENJET                                             0036

C  T() {1<=I, I<=2, 1<=J, J<=160, J<=NPJET, MPCON<=401}

C (2,23)
            GZ(I,J) = GZJET                                             0037

C  T() {1<=I, I<=2, 1<=J, J<=160, J<=NPJET, MPCON<=401}

C (2,24)
20          CONTINUE                                                    0038
C           END BLOCK
*
*
***********************************************************************
*
*
C     END BLOCK
C     END BLOCK
      END

C  P() {}

      SUBROUTINE INIMOD

      IMPLICIT REAL*8 (A-H, O-Z)
*
*
      PARAMETER  ( MP   =      402 ,   NP   =       160 )
      PARAMETER  ( M1   =   MP - 1 ,   N1   =   NP - 1 )
*
*
*
      PARAMETER  ( XLZ =       30.0D0 )
      PARAMETER  ( XLR =        8.0D0 )
*
C     PARAMETER  ( XCZ =       30.0D0 )
      PARAMETER  ( XCZ =       15.0D0 )
      PARAMETER  ( XSZ =       30.0D0 )
*
      PARAMETER  ( RO0 =        1.0D0 )
      PARAMETER  ( PR0 =        0.6D0 )
*
      PARAMETER  ( XLJET =      1.0D0 )
      PARAMETER  ( ROJET =      0.1D0 )
      PARAMETER  ( PRJET =      0.6D0 )
      PARAMETER  (  VJET =    18.97D0 )

      COMMON /PRMT/   TS, DT, GAM, CFL,VCT,
     &                TZ,TR, FTZ,FTR, BSZ,BSR, QTZ,QTR, IS
      COMMON /GRID/   Z(MP), ZB(0:MP), DZ(MP), DBZ(0:MP), FZ(M1),
     &                R(NP), RB(0:NP), DR(NP), DBR(0:NP), FR(N1),
     &                DUM(8)
* Dum is a dummy             a.w.
      COMMON /VAR1/   RO(MP,NP), EN(MP,NP),
     &                GZ(MP,NP), GR(MP,NP)

C  P() {}

C (0,1)
C     BEGIN BLOCK

C  P() {}

C (0,2)
*
*
***********************************************************************
*     OPEN MODEL INPUT
***********************************************************************
      OPEN (UNIT=11,FILE='HYDRO2D.MODEL',STATUS='OLD')                  0001

C  P() {}

C (0,3)
***********************************************************************
*     SET BASIC PARAMETERS
***********************************************************************
*
*
      GAM = DBLE(5.0D0)/DBLE(3.0D0)                                     0002

C  P() {}

C (0,4)
*
      TZ = XLZ/(MP-2)                                                   0003

C  P() {}

C (0,5)
      TR = XLR/NP                                                       0004

C  P() {}

C (0,6)
      FTZ = DBLE(-2.0D0)*TZ                                             0005

C  P() {}

C (0,7)
      FTR = 0.0D0                                                       0006

C  P() {}

C (0,8)
      BSZ = 1.0D0                                                       0007

C  P() {}

C (0,9)
      BSR = 1.0D0                                                       0008

C  P() {}

C (0,10)
      QTZ = 1.0D0                                                       0009

C  P() {}

C (0,11)
      QTR = 1.0D0                                                       0010

C  P() {}

C (0,12)
*
*
***********************************************************************
*     SET VARIABLES
***********************************************************************
*
*
      CON = GAM-1.0D0                                                   0011

C  P() {}

C (0,13)
      EN0 = PR0/CON                                                     0012

C  P() {}

C (0,14)
*
      MPCON = NINT(MP*XCZ/XLZ)                                          0013

C  P(MPCON) {}

C (0,15)
      MPSTR = NINT(MP*XSZ/XLZ)                                          0014

C  P(MPCON,MPSTR) {}

C (0,16)
      J = 1                                                             0015
C (0,17)
99991 CONTINUE

C  P(I,J,MPCON,MPSTR) {1<=J, J<=161}

C (1,1)
*
C     DO loop 5 with exit had to be desugared
      IF (J.GT.NP) GOTO 99994                                           0015

C  P(I,J,MPCON,MPSTR) {1<=J, J<=160}

C (10,1)
      I = 1                                                             0016
99992 CONTINUE

C  P(I,J,MPCON,MPSTR) {1<=I, I<=403, 1<=J, J<=160}

C (7,1)
C     DO loop 5 with exit had to be desugared
      IF (I.GT.MP) GOTO 99993                                           0016

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, 1<=J, J<=160}

C (9,1)
      READ (UNIT=11,FMT=1000,END=99) RO(I,J)                            0017

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, 1<=J, J<=160}

C (6,1)
C     BEGIN BLOCK

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, 1<=J, J<=160}

C (6,2)
5     CONTINUE                                                          0018

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, 1<=J, J<=160}

C (6,3)
      I = I+1                                                           0016
C     END BLOCK
      GOTO 99992

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, 1<=J, J<=160}

C (4,1)
C     BEGIN BLOCK

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, 1<=J, J<=160}

C (4,2)
99    WRITE (6, 1099)                                                   0039

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, 1<=J, J<=160}

C (4,3)
      STOP                                                              0040

C  P() {0==-1}

C (4,4)
1000  FORMAT(E20.14)                                                    0041

C  P() {0==-1}

C (4,5)
1099  FORMAT(' NO FURTHER MODEL DATA AVAILABLE, STOP')                  0042
C     END BLOCK
99993 CONTINUE

C  P(I,J,MPCON,MPSTR) {I==403, 1<=J, J<=160}

C (8,1)
      J = J+1                                                           0015
      GOTO 99991
99994 CONTINUE

C  P(I,J,MPCON,MPSTR) {J==161}

C (2,1)
C     BEGIN BLOCK

C  P(I,J,MPCON,MPSTR) {J==161}

C (2,2)
      DO 10 J = 1, NP                                                   0019

C  P(I,J,MPCON,MPSTR) {1<=J, J<=160}

C (2,3)
         DO 10 I = 1, MPCON                                             0020

C  P(I,J,MPCON,MPSTR) {1<=I, I<=MPCON, 1<=J, J<=160}

C (2,4)
C           BEGIN BLOCK

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, I<=MPCON, 1<=J, J<=160}

C (2,5)
C        RO(I,J) =  RO0
            EN(I,J) = EN0                                               0021

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, I<=MPCON, 1<=J, J<=160}

C (2,6)
            GZ(I,J) = 0.0D0                                             0022

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, I<=MPCON, 1<=J, J<=160}

C (2,7)
            GR(I,J) = 0.0D0                                             0023

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, I<=MPCON, 1<=J, J<=160}

C (2,8)
10          CONTINUE                                                    0024
C           END BLOCK

C  P(I,J,MPCON,MPSTR) {J==161, 1<=I, I<=403, MPCON+1<=I}

C (2,9)
*
      DO 12 J = 1, NP                                                   0025

C  P(I,J,MPCON,MPSTR) {1<=J, J<=160, MPCON<=402}

C (2,10)
         DO 12 I = MPCON+1, MP                                          0026

C  P(I,J,MPCON,MPSTR) {I<=402, MPCON+1<=I, 1<=J, J<=160, MPCON<=402}

C (2,11)
C           BEGIN BLOCK

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, MPCON+1<=I, 1<=J, J<=160,
C    MPCON<=402}

C (2,12)
*        RO(I,J) =  RO0  *  10 ** ( REAL(MPCON-I) / REAL(MPSTR) )
C        RO(I,J) =  RO0  *  10 ** ( DBLE(MPCON-I) / DBLE(MPSTR) )
            EN(I,J) = EN0                                               0027

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, MPCON+1<=I, 1<=J, J<=160,
C    MPCON<=402}

C (2,13)
            GZ(I,J) = 0.0D0                                             0028

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, MPCON+1<=I, 1<=J, J<=160,
C    MPCON<=402}

C (2,14)
            GR(I,J) = 0.0D0                                             0029

C  P(I,J,MPCON,MPSTR) {1<=I, I<=402, MPCON+1<=I, 1<=J, J<=160,
C    MPCON<=402}

C (2,15)
12          CONTINUE                                                    0030
C           END BLOCK

C  P(I,J,MPCON,MPSTR) {I==403, J==161, MPCON<=402}

C (2,16)
*
*
      ENJET = PRJET/CON+0.5D0*ROJET*VJET**2                             0031

C  P(I,J,MPCON,MPSTR) {I==403, J==161, MPCON<=401}

C (2,17)
      GZJET = ROJET*VJET                                                0032

C  P(I,J,MPCON,MPSTR) {I==403, J==161, MPCON<=401}

C (2,18)
*
      NPJET = NINT(NP*XLJET/XLR)                                        0033

C  P(I,J,MPCON,MPSTR,NPJET) {I==403, J==161, MPCON<=401}

C (2,19)
*
      DO 20 J = 1, NPJET                                                0034

C  P(I,J,MPCON,MPSTR,NPJET) {1<=J, J<=NPJET, MPCON<=401}

C (2,20)
         DO 20 I = 1, 2                                                 0035

C  P(I,J,MPCON,MPSTR,NPJET) {1<=I, I<=2, 1<=J, J<=NPJET, MPCON<=401}

C (2,21)
C           BEGIN BLOCK

C  P(I,J,MPCON,MPSTR,NPJET) {1<=I, I<=2, 1<=J, J<=160, J<=NPJET,
C    MPCON<=401}

C (2,22)
C        RO(I,J) =  ROJET
            EN(I,J) = ENJET                                             0036

C  P(I,J,MPCON,MPSTR,NPJET) {1<=I, I<=2, 1<=J, J<=160, J<=NPJET,
C    MPCON<=401}

C (2,23)
            GZ(I,J) = GZJET                                             0037

C  P(I,J,MPCON,MPSTR,NPJET) {1<=I, I<=2, 1<=J, J<=160, J<=NPJET,
C    MPCON<=401}

C (2,24)
20          CONTINUE                                                    0038
C           END BLOCK
*
*
***********************************************************************
*
*
C     END BLOCK
C     END BLOCK
      END

