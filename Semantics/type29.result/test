
C  T(INEW,LNEW,SNEW,XNEW) {INEW==IOLD, LNEW==LOLD, SNEW==SOLD,
C    XNEW==XOLD, 0<=LNEW, LNEW<=1}


      SUBROUTINE COPY_FOUR(INEW, IOLD,
     &     XNEW, XOLD, SNEW, SOLD, LNEW, LOLD)

      CHARACTER*4 SNEW, SOLD
      LOGICAL LNEW, LOLD

C  T(INEW) {INEW==IOLD}


      INEW = IOLD                                                       0001

C  T(XNEW) {XNEW==XOLD}

      XNEW = XOLD                                                       0002

C  T(SNEW) {SNEW==SOLD}

      SNEW = SOLD                                                       0003

C  T(LNEW) {LNEW==LOLD, 0<=LNEW, LNEW<=1}

      LNEW = LOLD                                                       0004

      END

C  T() {}

      PROGRAM TYPE29

C     Check analysis of non affine arguments

      REAL X, Y, U, V
      LOGICAL L, L1, L2, L3
      CHARACTER*4 S, S1, S2, S3

C  T(U) {2.==U}


      U = 2.                                                            0001

C  T(V) {3.==V}

      V = 3.                                                            0002

C  T(S2) {"Hi!"==S2}

      S2 = "Hi!"                                                        0003

C  T(L2) {L2==1}

      L2 = .TRUE.                                                       0004

C  T(I,L1,S1,X) {S1==S2, U+V==X, 1<=I, I<=2, 0<=L1, L1<=1, L1<=L2,
C    L2+L3<=L1+1, L1<=L3, 0<=L2, L2<=1, 0<=L3, L3<=1}


      CALL COPY_FOUR(I, 1+MOD(J, 2), X, U+V, S1, S2, L1, L2.AND.L3)     0005

C  T() {}


      PRINT *, I, X, S1, L1                                             0006

C  T(J,L2,S2,U,V) {}


      READ *, J, U, V, S2, L2                                           0007

C  T() {}


      PRINT *, I, X, S1, L1                                             0008

      END

C  P() {"Hi!"==SOLD, 2.+3.==XOLD, 1<=IOLD, IOLD<=2, 0<=LNEW, LNEW<=1,
C    0<=LOLD, LOLD<=1}


      SUBROUTINE COPY_FOUR(INEW, IOLD,
     &     XNEW, XOLD, SNEW, SOLD, LNEW, LOLD)

      CHARACTER*4 SNEW, SOLD
      LOGICAL LNEW, LOLD

C  P() {"Hi!"==SOLD, 2.+3.==XOLD, 1<=IOLD, IOLD<=2, 0<=LNEW, LNEW<=1,
C    0<=LOLD, LOLD<=1}


      INEW = IOLD                                                       0001

C  P(INEW) {"Hi!"==SOLD, 2.+3.==XOLD, INEW==IOLD, 1<=INEW, INEW<=2,
C    0<=LNEW, LNEW<=1, 0<=LOLD, LOLD<=1}

      XNEW = XOLD                                                       0002

C  P(INEW,XNEW) {"Hi!"==SOLD, 2.+3.==XNEW, INEW==IOLD, XNEW==XOLD,
C    1<=INEW, INEW<=2, 0<=LNEW, LNEW<=1, 0<=LOLD, LOLD<=1}

      SNEW = SOLD                                                       0003

C  P(INEW,SNEW,XNEW) {"Hi!"==SNEW, 2.+3.==XNEW, INEW==IOLD,
C    SNEW==SOLD, XNEW==XOLD, 1<=INEW, INEW<=2, 0<=LNEW, LNEW<=1,
C    0<=LOLD, LOLD<=1}

      LNEW = LOLD                                                       0004

      END

C  P() {}

      PROGRAM TYPE29

C     Check analysis of non affine arguments

      REAL X, Y, U, V
      LOGICAL L, L1, L2, L3
      CHARACTER*4 S, S1, S2, S3

C  P() {}


      U = 2.                                                            0001

C  P(U) {2.==U}

      V = 3.                                                            0002

C  P(U,V) {2.==U, 3.==V}

      S2 = "Hi!"                                                        0003

C  P(S2,U,V) {"Hi!"==S2, 2.==U, 3.==V}

      L2 = .TRUE.                                                       0004

C  P(L2,S2,U,V) {"Hi!"==S2, 2.==U, 3.==V, L2==1}


      CALL COPY_FOUR(I, 1+MOD(J, 2), X, U+V, S1, S2, L1, L2.AND.L3)     0005

C  P(I,L1,L2,S1,S2,U,V,X) {"Hi!"==S1, 2.+3.==X, 2.==U, 3.==V, L1==L3,
C    L2==1, S1==S2, 1<=I, I<=2, 0<=L1, L1<=1}


      PRINT *, I, X, S1, L1                                             0006

C  P(I,L1,L2,S1,S2,U,V,X) {"Hi!"==S1, 2.+3.==X, 2.==U, 3.==V, L1==L3,
C    L2==1, S1==S2, 1<=I, I<=2, 0<=L1, L1<=1}


      READ *, J, U, V, S2, L2                                           0007

C  P(I,J,L1,L2,S1,S2,U,V,X) {"Hi!"==S1, 2.+3.==X, L1==L3, 1<=I, I<=2,
C    0<=L1, L1<=1}


      PRINT *, I, X, S1, L1                                             0008

      END

