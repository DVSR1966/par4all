
Refuse alternate returns


Ignore alternate returns and substitute STOP

      SUBROUTINE ALTRET01(X, FORMAL_RETURN_LABEL_1)
      INTEGER IY
      REAL*4 X
      CHARACTER*(*) FORMAL_RETURN_LABEL_1
      SAVE IY

      DATA IY /1/

C     Check different handlings of alternate return constructs

      CALL FOO("*123")                                                  0001

      CALL BAR(X, "*123")                                               0002

      CALL BAR2("*123", X)                                              0003

      IF (X.GT.FLOAT(IY)) RETURN                                        0004

123   CONTINUE                                                          0006
      STOP "1 in ALTRET01"                                              0007

      END

Replace alternate returns

      SUBROUTINE ALTRET01(X, FORMAL_RETURN_LABEL_1, 
     &I_PIPS_RETURN_CODE_)
      INTEGER I_PIPS_RETURN_CODE_, IY
      REAL*4 X
      CHARACTER*(*) FORMAL_RETURN_LABEL_1
      SAVE IY

      DATA IY /1/

C     Check different handlings of alternate return constructs

      CALL FOO("*123", I_PIPS_RETURN_CODE_)                             0001
      IF (I_PIPS_RETURN_CODE_.EQ.1) GOTO 123                            0001

      CALL BAR(X, "*123", I_PIPS_RETURN_CODE_)                          0002
      IF (I_PIPS_RETURN_CODE_.EQ.1) GOTO 123                            0002

      CALL BAR2("*123", X, I_PIPS_RETURN_CODE_)                         0003
      IF (I_PIPS_RETURN_CODE_.EQ.1) GOTO 123                            0003

      IF (X.GT.FLOAT(IY)) GOTO 99998                                    0005

123   CONTINUE                                                          0007
      I_PIPS_RETURN_CODE_ = 1                                           0008
      RETURN
99998 CONTINUE
      I_PIPS_RETURN_CODE_ = 0                                           0006
      END
