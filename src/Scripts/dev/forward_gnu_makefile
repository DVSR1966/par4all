# $RCSfile: forward_gnu_makefile,v $ (version $Revision$)
# $Date: 1996/07/11 14:35:16 $, 
# (c) Fabien COELHO 1996
#
# this makefile forwards make targets to sub-directories...
# it must be used with GNU make.
#
# these variables may be overwritten on the command line
# gmake FWD_DIRS="foo blah" FWD_MSG="argh!" FWD_REPORT="> /dev/null"
#

# the list of sub directories for forwarding commands:
# default is all sub-directories
FWD_DIRS=$(wildcard *)

# the message if reporting a failure or success: 
# default is none. dir is appended.
FWD_MSG=

# where to report a failure or success:
# default is stdout
FWD_REPORT=

# forward any command to the specified directories
%::
	@echo Forwarding $@ to $(FWD_DIRS)
	-@for d in $(FWD_DIRS) ; do \
	  if test -d $$d ; then \
	    if $(MAKE) -C $$d FWD_MSG="$(FWD_MSG)/$$d" $@ ;\
	    then echo "$(FWD_MSG)/$$d: $@ succeeded" $(FWD_REPORT) ;\
	    else echo "$(FWD_MSG)/$$d: $@ failed" $(FWD_REPORT) ;\
	fi ; fi ; done

debug:
	@echo "FWD_DIRS=$(FWD_DIRS)"
	@echo "FWD_MSG=$(FWD_MSG)"
	@echo "FWD_REPORT=$(FWD_REPORT)"

# end of $RCSfile: forward_gnu_makefile,v $
#
