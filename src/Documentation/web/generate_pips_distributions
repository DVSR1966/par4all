#! /bin/sh
# 
# $RCSfile$ (version $Revision$)
#
# to regenerate the distribution files:
#

move()
{ test -f $1 && { rm -f $1.old ; mv $1 $1.old ; } ; }

verbose()
{ echo "$RCSfile$: $*" ; }

error()
{ ret=$1; shift; echo "$RCSfile$ [$ret]: $*" >&2 ; exit $ret; }

#
# SOURCES
#

echo "all sources [Pips (including Validation), Newgen, Linear]"
move pips_sources
make_pips_release -CS -D Examples -F Validation/exportonly -pnle -rsz \
	pips_sources || error 1 "ret $?"

echo "Newgen sources"
move newgen_sources
make_pips_release -CS -n -rsz newgen_sources || error 2 "ret $?"

echo "Linear sources"
move linear_sources
make_pips_release -CS -l -rsz linear_sources || error 3 "ret $?"

echo "Xpomp sources"
move xpomp_sources
make_pips_release -rz -D Doc/xpomp_manual.ps \
	-D Include -w "-s Src/Runtimes/xpomp" -p -w -e xpomp_sources || 
	    error 4 "ret $?"


#
# BINARIES
#

echo "SunOS4 binary version"
move pips_GNU
make_pips_release -CB GNU -D Examples -pe -rsz pips_GNU || 
	error 5 "ret $?"

echo "Solaris 2 binary version "
move pips_GNUSOL2LL
make_pips_release -CB GNUSOL2LL -D Examples -pe -rz pips_GNUSOL2LL || 
	error 6 "ret $?"

echo "Solaris 2 public softs (big!)"
move public_GNUSOL2LL
make_pips_release -P -rz public_GNUSOL2LL ||
	error 7 "ret $?"

echo done

chmod a+r *.tar.gz

# that is all
