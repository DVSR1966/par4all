
C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

C
C     1993 version - Modified by Beatrice Creusillet for PIPS -
C
C     MODIFICATIONS:
C
C     AUGUST 1995:
C     ~~~~~~~~~~~~
C     - CXxxxxx and CYyyyyy commentaries removed for clarity.
C     - CPUTIM and ELAPSE subroutines uncommented.
C     - BLOCK DATA moved in main procedure.
C     - Macro definition LSTMOD(MODEHI) in module DEALSE replaced where
C       it is used.
C     - (1.,0.) replaced by CMPLX(1.,0.) wherever needed.
C     - In RUNINF, computed GOTO's are replaced by block if's.
C     - Passed through stf; one empty if block removed afterwards.
C     - Add common /TIMING/ in DATAST, TEMPFO, TEMPHY, PSIFOU, PSIPHY,
C       ZETAFO, ZETAPH, VVELFO, VVELPH, UVELFO, UVELPH, DEALSE, in order
C       to help the interprocedural propagation.
C     - Common //NMBRS/ declared in RCS, CSR, ACAC, SCSC to
C       propagate major predicates (like N2P==129) downwards to FTRVMT 
C       (fi, June 1993).
C     - Add common /FT/ in TEMPHY
C     - Add common /MEMORY/ in OCEAN
C     - variable NUMBER in common /DEBUG/ renamed into NUM1 to avoid clashes
C       with variable NUMBER in common /OPTONS/
C     - use full declaration of /FT/ in UVELFO (Francois Irigoin)
C
C******NOTE: USE OF MACHINE-DEPENDENT CONSTANT: ZERO IN SUBROUTINE RUNIN
C
C            ZERO = 1.0E-200 (MAY HAVE TO REPLACE WITH YOUR MACHINES
C                             RELATIVE PRECISION FOR REAL DATA TYPE)
C

C***********************************************************************
C                        OCEAN FORTRAN PROGRAMS
C                        CREATION DATE: 3/22/81
C***********************************************************************
      PROGRAM OCEAN
C
C  D(Z)/DT + (U,V).GRAD(Z) = RNU*DELSQ(Z) + ALPHA*D(TEMP)/DX
C
C  D(TEMP)/DT + (U,V).GRAD(TEMP) = RKAPA*DELSQ(TEMP) + BETA*V
C
C
C
C THIS PROGRAM SIMULATES TWO-DIMENSIONAL FLUID FLOW ON A   (N2+1) * N1
C GRID. IT IS POSSIBLE TO SPECIFY NON-LINEAR DISTRIBUTION OF DATA POINTS
C THE Y-DIRECTION (THE FIRST INDEX CORRESPONDS TO Y DIRECTION, SECOND TO
C X DIRECTION). N1 AND N2 HAVE TO BE POWERS OF TWO GREATER OR EQUAL TO 8
C
C THE PROGRAM USES LARGE CORE MEMORY. IT REQUIRES 8*(N2+1)*N1+(N2-1)*(N2
C WORDS OF IT. IF NOTEMP = 1 IT IS POSSIBLE TO SAVE 2*(N2+1)*N1 WORDS,
C IF LMAPP = 1 YOU SAVE ADDITIONAL (N2-1)*(N2+1) WORDS.
C
C IF  LMAPP = 2 , LCM REQUIREMENTS ARE AT LEAST  3 * (N2-1) * (N2-1)
C MORE MEMORY COULD BE NEEDED IN THIS CASE BECAUSE OF EIGSET AND LCMRQR.
C
C
C FOR CDC7600 RUNS: DELETE ROUTINES LCMREQ, IN AND OUT FROM THE END OF
C                   THIS PACKAGE. ON CDC7600 THE LCM IS USED THROUGH
C                   THE ASSEMBLY ROUTINES.
C
C                   LIBRARY.
C FOR CRAY-1 RUNS : DELETE ROUTINES SECOND, DATE, TIME, EXSET AND
C                   LOG2 FROM THE END OF THIS PACKAGE. THEY ARE
C                   OBTAINED AT LOAD TIME FROM CRAY LIBRARIES AND
C                   FFTLIB.
C                   ALSO, ADJUST THE SIZE OF PARAMETER LCMSIZ IN
C                   THE ROUTINE LCMREQ SO THAT THE COMMON IS LARGE
C                   ENOUGH TO EMULATE CDC7600 LCM REQUIRED FOR THE RUN.
C
C THE FOLLOWING PARAMETERS DEFINE THE SIZE OF THE RUN:
C
      PARAMETER (NX=128,NY=128)
      PARAMETER (NA1=2* (NY+1),NA2=NX/2,NE=NY-1,NW1=NY+1)
      PARAMETER (NW2=128,NEX=256)
      PARAMETER (NI=2*NY-1,NEQ=3*NY-2,NCW2=2*NW1+1,NCW3=4*NW1+1)
C
C PLEASE REFER TO THE DIMENSIONING AND EQUIVALENCING INSTRUCTIONS IN
C THE CASE YOUR COMPILER CANNOT HANDLE PARAMETER STATEMENTS...
C COMMON BLOCKS:
C
      COMMON /FT/NPTS,NSKIP,MTRN,MSKIP,ISIGN,LOG,IEXSHF
C
C THE DIMENSION OF  GSOLV  HAS TO BE AT LEAST (N2-1)
C
      COMMON /SOLV/LVECT,LSKIP,NVECT,NVSKIP,GSOLV(127)
C
C THE DIMENSIONS OF  GMAPP  AND  G  HAVE TO BE AT LEAST (N2+1)
C
      COMMON /MAPING/GMAPP(129),G(129)
      COMMON /MFLOW/U(129)
      COMMON /DATA/ALPHA,BETA,BOXX,H,RNU,RKAPA,DT,DTT,T,NSTEPS
      COMMON /OPTONS/N1,N2,NUMBER,KDATA,LMAPP,NOTEMP,KTA,KTAPE,KSM,KPP,
     +       KZP,KTP,KUP,KVP,KPF,KZF,KTF,KUF,KVF,KPRESS,NOALS
      COMMON /PI/PI
      COMMON /NMBRS/N1H,N1Q,N1E,N2M,N2P,N2DP,N2DM,N2PD
      COMMON /EXSIZE/NMAX2
      COMMON /LADDR/LZN,LTN,LPN,LZO,LTO,LPY,LZX,LZY,LEIG,LE,LH,LEV
      COMMON /TIMING/TXXXIN,TXXOUT,TXXRCS,TXXCSR,TXSCSC,TXACAC,TFTVMT,
     +       TXSHUF,TUSHUF,TXPRNT,TXLOG2,EXXRCS,EXXCSR,EXSCSC,EXACAC,
     +       EFTVMT,NXXXIN,NXXOUT,NXXRCS,NXXCSR,NXSCSC,NXACAC,NFTVMT,
     +       NXSHUF,NUSHUF,NXPRNT,NXLOG2
      PARAMETER (LCMSIZ=165117)
      COMMON /MEMORY/MEMSIZ,RM(LCMSIZ)
C
C
C COMPLEX ARRAYS HAVE TO BE DIMENSIONED EXACTLY AS THE FORMULAS SAY:
C            CA        (N2+1) X N1/2
C            CWORK     N2+1
C            CWORK2    N2+1
C            CWORK3    N2+1
C            EX        MAX(2*N2, N1)
C
C EX ARRAY MUST NOT BE THE FIRST ARRAY IN THE MEMORY.
C
      COMPLEX CA(NW1,NA2),CWORK(NW1),CWORK2(NW1)
      COMPLEX CWORK3(NW1),EX(NEX),CF
C
C REAL ARRAYS HAVE TO BE DIMENSIONED EXACTLY AS THE FORMULAS SAY:
C            A      2*(N2+1) X N1/2
C            E      (N2-1)   X (N2-1)
C            WORK   N2+1     X MAX(6, 2*MIN(64, N1/2))   (AT LEAST)
C            EVAL   N2-1
C            IR     N2-1
C            IC     N2-1
C
      REAL A(NA1,NA2),E(NE,NE)
      REAL WORK(NW1*NW2)
      REAL EVAL(NE),IR(NE),IC(NE)
      INTEGER VALID
C
C EQUIVALENCE STATEMENTS ARE SAVING MEMORY SPACE. THE FOLLOWING PATTERN
C HAS TO BE FOLLOWED EXACTLY:
C
C     A-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
C     CA+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
C     EVAL+-+IR-+-+-IC+-+-+E+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
C
C
C     WORK+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
C     CWORK-+-+-+CWORK2-+-+-CWORK3+-+-+
C
C      EQUIVALENCE (A,CA,EVAL), (A(NY),IR), (A(NI),IC), A(NEQ),E) - ORGI
C      EQUIVALENCE (A,CA,EVAL), (EVAL(NY),IR), (EVAL(NI),IC),
C     *             (EVAL(NEQ),E) - MACFARLANE'S FIX. BAD.
C POINTER'S FIX. ANSI REQUIRES THAT THE NUMBER OF SUBSCRIPTS MATCH
C THE NUMBER OF DIMENSIONS OF THE ARRAY. THAT WAS THE PROBLEM WITH
C THE ORGINAL STATEMENT. THE PROBLEM WITH MACFARLANE'S FIX IS THAT
C NY,NI,NEQ>NE (THE DIMENSION OF EVAL). HERE 3*NE+1-NA1 IS THE 3*NE+1TH
C ELEMENT OF A AND 3*NE+1 = NEQ.
      EQUIVALENCE (A,CA,EVAL), (A(NY,1),IR), (A(NI,1),IC),
     +            (A(3*NE+1-NA1,2),E)
      EQUIVALENCE (WORK,CWORK), (WORK(NCW2),CWORK2), (WORK(NCW3),CWORK3)
      COMMON /VERIFY/VDAT(15),CDAT(15)
      COMMON /DEBUG/NUM1,TLAST
C
C     former BLOCK DATA
C
C
      DATA TXXXIN,TXXOUT,TXXRCS,TXXCSR,TXSCSC,TXACAC,TFTVMT/0.,0.,0.,0.,
     +     0.,0.,0./
      DATA TXSHUF,TUSHUF,TXPRNT,TXLOG2/0.,0.,0.,0./
      DATA EXXRCS,EXXCSR,EXSCSC,EXACAC,EFTVMT/0.,0.,0.,0.,0./
      DATA NXXXIN,NXXOUT,NXXRCS,NXXCSR,NXSCSC,NXACAC,NFTVMT/0,0,0,0,0,0,
     +     0/
      DATA NXSHUF,NUSHUF,NXPRNT,NXLOG2/0,0,0,0/
      DATA VDAT/0.10000E+03,-0.10000E+03,0.10000E-04,-0.10000E+03,
     +     -0.15708E+01,0.99983E+02,-0.18147E+01,-0.20427E+01,
     +     -0.22452E+01,-0.24181E+01,0.95976E+02,-0.95977E+02,
     +     0.10000E-04,-0.95978E+02,-0.25589E+01/
C
C PI IS A USEFULL CONSTANT
C
      DATA PI/3.141592653589793/
      DATA NUM1/1/,TLAST/0.0/

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

C
C
C
C NOW WE CAN START WITH THE PROGRAM...
C SUBROUTINE START TELLS OCEAN WHAT TO DO:
C
      CALL CPUTIM(CPU1)                                                 0183

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      CALL ELAPSE(TCLCK1)                                               0184

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      OPEN (UNIT=1,FILE='OCV')                                          0185

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      OPEN (UNIT=6,FILE='OCO6')                                         0186

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      WRITE (1, 9000)                                                   0187

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}


      CALL START(NX, NY)                                                0189

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N2,NOALS,NOTEMP,NUMBER) {KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128,
C    N2==128, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0,
C    NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0}

C
C IF  LMAPP = 1 , H  (THE SIZE OF THE BOX IN Y DIRECTION)  SHOULD BE
C SPECIFIED IN THE MAIN PROGRAM.
C
      H = PI                                                            0194

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N2,NOALS,NOTEMP,NUMBER) {KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128,
C    N2==128, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0,
C    NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0}

C
C DEFINING CONSTANTS THAT WILL BE NEEDED:
C
      N1H = N1/2                                                        0198

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1H,N2,NOALS,NOTEMP,NUMBER) {KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1,
C    N1==128, N1H==64, N2==128, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N1Q = N1/4                                                        0199

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1H,N1Q,N2,NOALS,NOTEMP,NUMBER) {KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1,
C    N1==128, N1H==64, N1Q==32, N2==128, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N1E = N1/8                                                        0200

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,NOALS,NOTEMP,NUMBER) {KDATA==1,
C    KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N2M = N2-1                                                        0201

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2M,NOALS,NOTEMP,NUMBER) {KDATA==1,
C    KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2M==127,
C    NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0}

      N2P = N2+1                                                        0202

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2M,N2P,NOALS,NOTEMP,NUMBER)
C    {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2M==127, N2P==129, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N2DP = 2*N2+1                                                     0203

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DP,N2M,N2P,NOALS,NOTEMP,NUMBER)
C    {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DP==257, N2M==127, N2P==129, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N2DM = 2*N2-1                                                     0204

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,NOALS,NOTEMP,
C    NUMBER) {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N2PD = 2*N2P                                                      0205

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER) {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0}

      NW = N2PD*N1H                                                     0206

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER,NW) {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0,
C    NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0}

      NWH = NW/2                                                        0207

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER,NW,NWH) {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0,
C    NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 2NWH<=NW, NW<=2NWH+1}

      NWQ = NW/4                                                        0208

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER,NW,NWH,NWQ) {KDATA==1, KPF==1, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1,
C    NUMBER==250, NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW,
C    NW<=4NWQ+3}

      NWEIG = N2M                                                       0209

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER,NW,NWEIG,NWH,NWQ) {KDATA==1, KPF==1, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1,
C    NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      IF (LMAPP.NE.1) NWEIG = (N2M+3)*N2M                               0210

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER,NW,NWEIG,NWH,NWQ) {KDATA==1, KPF==1, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1,
C    NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      NMAX2 = MAX(2*N2, N1)                                             0211

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,
C    NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      K1Q = N1E+1                                                       0212

C  P(K1Q,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,
C    NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW,
C    NW<=4NWQ+3}

      K2Q = K1Q+N1E                                                     0213

C  P(K1Q,K2Q,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,
C    KVP,KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,
C    NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K2Q==33,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW,
C    NW<=4NWQ+3}

      K3Q = K2Q+N1E                                                     0214

C  P(K1Q,K2Q,K3Q,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,
C    KVF,KVP,KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K2Q==33,
C    K3Q==49, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0,
C    NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      K1QM = K1Q-1                                                      0215

C  P(K1Q,K1QM,K2Q,K3Q,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,
C    KUP,KVF,KVP,KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,
C    N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17,
C    K1QM==16, K2Q==33, K3Q==49, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      K2QM = K2Q-1                                                      0216

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,
C    KUF,KUP,KVF,KVP,KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,
C    N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      K3QM = K3Q-1                                                      0217

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW,
C    NW<=4NWQ+3}

C
C LCM ALLOCATION AND COMPUTATION OF ADDRESSES:
C
      LARGE = 8*NW                                                      0221

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,N1,N1E,N1H,N1Q,N2,
C    N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,
C    NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8NW, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      IF (NOTEMP.EQ.1) LARGE = 6*NW                                     0222

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,N1,N1E,N1H,N1Q,N2,
C    N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,
C    NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8NW, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      IF (LMAPP.NE.2) THEN                                              0223

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,N1,N1E,N1H,N1Q,N2,
C    N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,
C    NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8NW, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

C
         LARGE = LARGE+NWEIG                                            0225

      ELSE

C  P() {0==-1}

C
         IF (KPRESS.GT.1) LARGE = MAX(LARGE, 3*N2M*N2M)+NWEIG+NWEIG     0229

C  P() {0==-1}

         IF (KPRESS.LE.1) LARGE = MAX(LARGE+NWEIG, 3*N2M*N2M)           0230
      ENDIF

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,N1,N1E,N1H,N1Q,N2,
C    N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,
C    NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8NW+127, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

C
      LZN = LCMREQ(LARGE)                                               0233

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LZN,MEMSIZ,N1,N1E,
C    N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,
C    NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8NW+127, LMAPP==1, LZN==1,
C    MEMSIZ==8NW+127, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 256<=NMAX2, NW<=20623, 2NWH<=NW, NW<=2NWH+1,
C    4NWQ<=NW, NW<=4NWQ+3}

      LTN = LZN+NW                                                      0234

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LTN,LZN,MEMSIZ,N1,
C    N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,
C    NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8NW+127, LMAPP==1, LTN==NW+1, LZN==1,
C    MEMSIZ==8NW+127, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 256<=NMAX2, NW<=20623, 2NWH<=NW, NW<=2NWH+1,
C    4NWQ<=NW, NW<=4NWQ+3}

      IF (NOTEMP.EQ.1) LTN = LZN                                        0235

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LTN,LZN,MEMSIZ,N1,
C    N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,
C    NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LMAPP==1, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LPN = LTN+NW                                                      0236

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LTN,LZN,MEMSIZ,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,
C    NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LMAPP==1,
C    LPN==2LTN-1, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

      LZO = LPN+NW                                                      0237

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LTN,LZN,LZO,
C    MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,
C    NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, 3LTN==LZO+2, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LTO = LZO+NW                                                      0238

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LTN,LTO,LZN,LZO,
C    MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,
C    NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, 4LTN==LTO+3, 3LTN==LZO+2,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      IF (NOTEMP.EQ.1) LTO = LZO                                        0239

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LTN,LTO,LZN,LZO,
C    MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,
C    NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, 4LTN==LTO+3, 3LTN==LZO+2,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LPY = LTO+NW                                                      0240

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LPY,LTN,LTO,LZN,
C    LZO,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,
C    NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LZX = LPY+NW                                                      0241

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LPY,LTN,LTO,LZN,
C    LZO,LZX,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,
C    NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

      LZY = LZX+NW                                                      0242

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LPY,LTN,LTO,LZN,
C    LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LPRESS = LZN+LARGE-NWEIG                                          0243

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LPRESS,LPY,LTN,
C    LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,
C    N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LEIG = LPRESS                                                     0244

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LEIG,LMAPP,LPN,LPRESS,LPY,
C    LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,
C    N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LEIG==LPRESS, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

      IF (KPRESS.GT.1.AND.LMAPP.NE.1) LEIG = LPRESS-NWEIG               0245

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LEIG,LMAPP,LPN,LPRESS,LPY,
C    LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,
C    N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C THESE LCM ADDRESSES ARE USED BY EIGSET AND LCMRQR
C
      LE = LZN                                                          0249

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LMAPP,LPN,LPRESS,
C    LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,
C    N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LH = LE+N2M*N2M                                                   0250

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=LH, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LEV = LH+N2M*N2M                                                  0251

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
      CALL EXSET(EX, NMAX2)                                             0253

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C SET ALL  U(I) TO 0. TO AVOID TROUBLE IF NO MEAN FLOW IS DESIRED
C
      DO 10 I = 1, N2P                                                  0257

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=129, LH<=LEV, 1<=LH, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         U(I) = 0.                                                      0258

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=129, LH<=LEV, 1<=LH, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

10       CONTINUE                                                       0259

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C SET UP ARRAYS ASSOCIATED WITH THE MAPPING FUNCTION:
C
      IF (LMAPP.EQ.1) THEN                                              0263

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8NW+1, LMAPP==1,
C    LPN==2LTN-1, 3LPN==2LZO+1, LPRESS==8NW+1, LPY==5NW+1, LTO==4NW+1,
C    LZN==1, LZO==3NW+1, LZX==6NW+1, LZY==7NW+1, MEMSIZ==8NW+127,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 256<=NMAX2, NW<=20623, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

C
C LINEAR MAPPING - EIGENVALUES KNOWN, EIGENFUNCTIONS ARE SIMPLY SINES
C AND COSINES, SO THAT NO MATRICES ARE NEEDED:
C
         F = H/REAL(N2)                                                 0268

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8NW+1, LMAPP==1,
C    LPN==2LTN-1, 3LPN==2LZO+1, LPRESS==8NW+1, LPY==5NW+1, LTO==4NW+1,
C    LZN==1, LZO==3NW+1, LZX==6NW+1, LZY==7NW+1, MEMSIZ==8NW+127,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 256<=NMAX2, NW<=20623, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

         FZ = PI/H                                                      0269

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8NW+1, LMAPP==1,
C    LPN==2LTN-1, 3LPN==2LZO+1, LPRESS==8NW+1, LPY==5NW+1, LTO==4NW+1,
C    LZN==1, LZO==3NW+1, LZX==6NW+1, LZY==7NW+1, MEMSIZ==8NW+127,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 256<=NMAX2, NW<=20623, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

         FZSQ = FZ*FZ                                                   0270

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8NW+1, LMAPP==1,
C    LPN==2LTN-1, 3LPN==2LZO+1, LPRESS==8NW+1, LPY==5NW+1, LTO==4NW+1,
C    LZN==1, LZO==3NW+1, LZX==6NW+1, LZY==7NW+1, MEMSIZ==8NW+127,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 256<=NMAX2, NW<=20623, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

         GMAPP(1) = 0.                                                  0271

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8NW+1, LMAPP==1,
C    LPN==2LTN-1, 3LPN==2LZO+1, LPRESS==8NW+1, LPY==5NW+1, LTO==4NW+1,
C    LZN==1, LZO==3NW+1, LZX==6NW+1, LZY==7NW+1, MEMSIZ==8NW+127,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 256<=NMAX2, NW<=20623, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

         G(1) = FZ                                                      0272

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8NW+1, LMAPP==1,
C    LPN==2LTN-1, 3LPN==2LZO+1, LPRESS==8NW+1, LPY==5NW+1, LTO==4NW+1,
C    LZN==1, LZO==3NW+1, LZX==6NW+1, LZY==7NW+1, MEMSIZ==8NW+127,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 256<=NMAX2, NW<=20623, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

         DO 20 I = 1, N2M                                               0273

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8NW+1, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8NW+1, LPY==5NW+1, LTN==NW+1, LTO==4NW+1,
C    LZN==1, LZO==3NW+1, LZX==6NW+1, LZY==7NW+1, MEMSIZ==8NW+127,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=127, LH<=LEV, 1<=LH, 256<=NMAX2,
C    NW<=20623, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

            GMAPP(I+1) = F*REAL(I)                                      0274

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8NW+1, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8NW+1, LPY==5NW+1, LTN==NW+1, LTO==4NW+1,
C    LZN==1, LZO==3NW+1, LZX==6NW+1, LZY==7NW+1, MEMSIZ==8NW+127,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=127, LH<=LEV, 1<=LH, 256<=NMAX2,
C    NW<=20623, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

            G(I+1) = FZ                                                 0275

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8NW+1, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8NW+1, LPY==5NW+1, LTN==NW+1, LTO==4NW+1,
C    LZN==1, LZO==3NW+1, LZX==6NW+1, LZY==7NW+1, MEMSIZ==8NW+127,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=127, LH<=LEV, 1<=LH, 256<=NMAX2,
C    NW<=20623, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

            EVAL(I) = -REAL(I)**2*FZSQ                                  0276

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8NW+1, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8NW+1, LPY==5NW+1, LTN==NW+1, LTO==4NW+1,
C    LZN==1, LZO==3NW+1, LZX==6NW+1, LZY==7NW+1, MEMSIZ==8NW+127,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=127, LH<=LEV, 1<=LH, 256<=NMAX2,
C    NW<=20623, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

20          CONTINUE                                                    0277

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         GMAPP(N2P) = H                                                 0278

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         G(N2P) = FZ                                                    0279

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL OUT(EVAL, LEIG, NWEIG)                                    0280
C
      ENDIF

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==1, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 1<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C READ THE DATA:
C
      IF (KDATA.EQ.1.OR.KDATA.EQ.2) CALL DATAST(A, N2P, N1, GMAPP)      0286

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 6LPY==5LZX+1,
C    4LTN==LTO+3, 3LTN==LZO+2, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    7LZX==6LZY+1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG, LEIG<=16NWH+9,
C    32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH, 1<=LTN,
C    256<=NMAX2}

      FX = 2.0*PI/BOXX                                                  0287

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 6LPY==5LZX+1,
C    4LTN==LTO+3, 3LTN==LZO+2, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    7LZX==6LZY+1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG, LEIG<=16NWH+9,
C    32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH, 1<=LTN,
C    256<=NMAX2}

      FX2 = 2.*FX                                                       0288

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 6LPY==5LZX+1,
C    4LTN==LTO+3, 3LTN==LZO+2, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    7LZX==6LZY+1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG, LEIG<=16NWH+9,
C    32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH, 1<=LTN,
C    256<=NMAX2}

C
C PREPARE THE INPUT FOR PROCESSING:
C
      IF (KDATA.EQ.1) THEN                                              0292

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1, 4LPY==5LTO-1,
C    6LPY==5LZX+1, 3LTN==LZO+2, LTN==NW+1, 3LTO==4LZO-1,
C    2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1,
C    NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==3, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=LEIG,
C    LEIG<=164985, 16NWH+1<=LEIG, LEIG<=16NWH+9, 32NWQ+1<=LEIG,
C    LEIG<=32NWQ+25, LH<=LEV, 1<=LH, 256<=NMAX2}

C
C THE INPUT WAS STREAMFUNCTION IN PHYSICAL SPACE - SHUFFLE THE DATA AND
C GO TO FOURIER SPACE:
C
         CALL IN(A, LPN, NW)                                            0297

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT,NXXXIN) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1,
C    4LPY==5LTO-1, 6LPY==5LZX+1, 3LTN==LZO+2, LTN==NW+1, 3LTO==4LZO-1,
C    2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1,
C    NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==3, NXXRCS==0,
C    NXXXIN==1, TEMPHY:NCALL==0, ZETAPH:NCALL==0, LEIG<=164985,
C    16NWH+1<=LEIG, LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25,
C    LH<=LEV, 1<=LH, 2<=LTN, 256<=NMAX2}

         CALL SHUF(A, N2P, N1, WORK)                                    0298

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXSHUF,NXXOUT,NXXXIN) {I==128, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, 7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1,
C    4LPY==5LTO-1, 6LPY==5LZX+1, 3LTN==LZO+2, LTN==NW+1, 3LTO==4LZO-1,
C    2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1,
C    NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==0,
C    NXXXIN==1, TEMPHY:NCALL==0, ZETAPH:NCALL==0, LEIG<=164985,
C    16NWH+1<=LEIG, LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25,
C    LH<=LEV, 1<=LH, 2<=LTN, 256<=NMAX2}

         NPTS = N1                                                      0299

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,NUMBER,NW,NWEIG,NWH,
C    NWQ,NXSHUF,NXXOUT,NXXXIN) {I==128, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, 7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1,
C    4LPY==5LTO-1, 6LPY==5LZX+1, 3LTN==LZO+2, LTN==NW+1, 3LTO==4LZO-1,
C    2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NPTS==128,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3,
C    NXXRCS==0, NXXXIN==1, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LEIG<=164985, 16NWH+1<=LEIG, LEIG<=16NWH+9, 32NWQ+1<=LEIG,
C    LEIG<=32NWQ+25, LH<=LEV, 1<=LH, 2<=LTN, 256<=NMAX2}

         NSKIP = N2P                                                    0300

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,
C    NWH,NWQ,NXSHUF,NXXOUT,NXXXIN) {I==128, K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, 7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1,
C    4LPY==5LTO-1, 6LPY==5LZX+1, 3LTN==LZO+2, LTN==NW+1, 3LTO==4LZO-1,
C    2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NPTS==128,
C    NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG, LEIG<=16NWH+9,
C    32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH, 2<=LTN,
C    256<=NMAX2}

         MTRN = N2P                                                     0301

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MTRN,N1,N1E,N1H,N1Q,N2,
C    N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NW,
C    NWEIG,NWH,NWQ,NXSHUF,NXXOUT,NXXXIN) {I==128, K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, 7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1,
C    4LPY==5LTO-1, 6LPY==5LZX+1, 3LTN==LZO+2, LTN==NW+1, 3LTO==4LZO-1,
C    2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==0, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG,
C    LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH,
C    2<=LTN, 256<=NMAX2}

         MSKIP = 1                                                      0302

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,
C    N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,
C    NUMBER,NW,NWEIG,NWH,NWQ,NXSHUF,NXXOUT,NXXXIN) {I==128, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1,
C    LPRESS==2LTO-1, 4LPY==5LTO-1, 6LPY==5LZX+1, 3LTN==LZO+2,
C    LTN==NW+1, 3LTO==4LZO-1, 2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1,
C    MSKIP==1, MTRN==129, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NPTS==128, NSKIP==129, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==0, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG,
C    LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH,
C    2<=LTN, 256<=NMAX2}

         ISIGN = -1                                                     0303

C  P(I,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,
C    KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,
C    LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,
C    N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,
C    NUMBER,NW,NWEIG,NWH,NWQ,NXSHUF,NXXOUT,NXXXIN) {I==128, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1, LMAPP==1,
C    LPN==2LTN-1, LPRESS==2LTO-1, 4LPY==5LTO-1, 6LPY==5LZX+1,
C    3LTN==LZO+2, LTN==NW+1, 3LTO==4LZO-1, 2LTO==MEMSIZ-125, LZN==1,
C    7LZX==6LZY+1, MSKIP==1, MTRN==129, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NPTS==128, NSKIP==129,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3,
C    NXXRCS==0, NXXXIN==1, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LEIG<=164985, 16NWH+1<=LEIG, LEIG<=16NWH+9, 32NWQ+1<=LEIG,
C    LEIG<=32NWQ+25, LH<=LEV, 1<=LH, 2<=LTN, 256<=NMAX2}

         CALL XLOG2(NPTS, LOG)                                          0304

C  P(I,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,
C    KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,
C    LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,N1,
C    N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,
C    NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,NXXXIN)
C    {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1,
C    4LPY==5LTO-1, 6LPY==5LZX+1, 3LTN==LZO+2, LTN==NW+1, 3LTO==4LZO-1,
C    2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1, MSKIP==1, MTRN==129,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NPTS==128, NSKIP==129, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==0, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG,
C    LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH,
C    2<=LTN, 256<=NMAX2}

         IEXSHF = NMAX2/NPTS                                            0305

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,
C    NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,NXXXIN)
C    {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1,
C    4LPY==5LTO-1, 6LPY==5LZX+1, 3LTN==LZO+2, LTN==NW+1, 3LTO==4LZO-1,
C    2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1, MSKIP==1, MTRN==129,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NPTS==128, NSKIP==129, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==0, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG,
C    LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH,
C    2<=LTN, 256<=NMAX2}

         CALL RCS(A, EX)                                                0306

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, 7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, 7LZX==6LZY+1, MSKIP==1,
C    MTRN==129, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1,
C    NOALS==1, NOTEMP==0, NPTS==128, NSKIP==129, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG,
C    LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH,
C    2<=LTN, 256<=NMAX2}

         NPTS = 2*N2                                                    0307

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, 7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==1, MTRN==129,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==129, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG,
C    LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH,
C    2<=LTN, 256<=NMAX2}

         NSKIP = 1                                                      0308

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==1, MTRN==129,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LEIG<=164985, 16NWH+1<=LEIG,
C    LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH,
C    2<=LTN, 256<=NMAX2}

         MTRN = N1H                                                     0309

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==1, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==1, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         MSKIP = N2P                                                    0310

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         ISIGN = -1                                                     0311

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         CALL XLOG2(NPTS, LOG)                                          0312

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==2, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         IEXSHF = NMAX2/NPTS                                            0313

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==2, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         CALL ACAC(A, EX, WORK)                                         0314

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

C           F = 0.125/REAL(N1*N2)
         F = 0.0625/REAL(N1*N2)                                         0316

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

         DO 30 J = 1, N1H                                               0317

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=J, J<=64, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

            DO 40 I = 1, N2PD                                           0318

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64, LH<=LEV, 1<=LH,
C    2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN,
C    LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

               A(I,J) = A(I,J)*F                                        0319

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64, LH<=LEV, 1<=LH,
C    2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN,
C    LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

40             CONTINUE                                                 0320

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=J, J<=64, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

30          CONTINUE                                                    0321

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL OUT(A, LPN, NW)                                           0322

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==4, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL OUT(A, LZN, NW)                                           0323
      ENDIF

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

C
CC*****C H E C K   F O U R I E R   C O E F F I C I E N T S**************
C
C         WRITE (6,7010) A(1,1),A(1,2),A(1,3)
C         WRITE (6,7020) A(2,1),A(2,2),A(2,3)
C         WRITE (6,7030) A(3,1),A(3,2),A(3,3)
C 7010    FORMAT(/2X,26HCHECK FOURIER COEFFICIENTS/4X,8HA(1,1) =,1PE13.6
C     1   2X,8HA(1,2) =,1PE13.6,2X,8HA(1,3) =,1PE13.6)
C 7020    FORMAT(4X,8HA(2,1) =,1PE13.6,2X,8HA(2,2) =,1PE13.6,2X,
C     1   8HA(2,3) =,1PE13.6)
C 7030    FORMAT(4X,8HA(3,1) =,1PE13.6,2X,8HA(3,2) =,1PE13.6,2X,
C     1   8HA(3,3) =,1PE13.6/)
C
C
      IF (KDATA.NE.3) THEN                                              0339

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, 3LARGE==8LZO+373, LE==1, 7LEIG==8LZY-1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1, 4LPY==5LTO-1,
C    6LPY==5LZX+1, LTN==NW+1, 3LTO==4LZO-1, 2LTO==MEMSIZ-125, LZN==1,
C    7LZX==6LZY+1, MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1,
C    NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1,
C    NXXXIN==1, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 9<=LEIG,
C    LEIG<=164985, 16NWH+1<=LEIG, LEIG<=16NWH+9, 32NWQ+1<=LEIG,
C    LEIG<=32NWQ+25, LH<=LEV, 1<=LH, 256<=NMAX2, 255<=NPTS, NPTS<=256}

C                                                     2
C STREAMFUNCTION KNOWN - FIND THE VORTICITY:  Z =  DEL  (PSI):
C
         CALL IN(EVAL, LEIG, NWEIG)                                     0343

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1,
C    LPRESS==2LTO-1, 4LPY==5LTO-1, 6LPY==5LZX+1, 4LTN==LTO+3,
C    3LTN==LZO+2, LTN==NW+1, 2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==2,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 9<=LEIG, LEIG<=164985,
C    16NWH+1<=LEIG, LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25,
C    LH<=LEV, 1<=LH, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         KZN = LZN                                                      0344

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,
C    MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,
C    NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,
C    NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1, LMAPP==1, LPN==2LTN-1,
C    LPRESS==2LTO-1, 4LPY==5LTO-1, 6LPY==5LZX+1, 4LTN==LTO+3,
C    3LTN==LZO+2, LTN==NW+1, 2LTO==MEMSIZ-125, LZN==1, 7LZX==6LZY+1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==2,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 9<=LEIG, LEIG<=164985,
C    16NWH+1<=LEIG, LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25,
C    LH<=LEV, 1<=LH, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         LVECT = N2M                                                    0345

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,
C    MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZP==249, LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1, 4LPY==5LTO-1,
C    6LPY==5LZX+1, 4LTN==LTO+3, 3LTN==LZO+2, LTN==NW+1,
C    2LTO==MEMSIZ-125, LVECT==127, LZN==1, 7LZX==6LZY+1, MSKIP==129,
C    MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==5, NXXRCS==1, NXXXIN==2, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 9<=LEIG, LEIG<=164985, 16NWH+1<=LEIG,
C    LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         LSKIP = 2                                                      0346

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZP==249, LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1, 4LPY==5LTO-1,
C    6LPY==5LZX+1, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, LTN==NW+1,
C    2LTO==MEMSIZ-125, LVECT==127, LZN==1, 7LZX==6LZY+1, MSKIP==129,
C    MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==5, NXXRCS==1, NXXXIN==2, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 9<=LEIG, LEIG<=164985, 16NWH+1<=LEIG,
C    LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25, LH<=LEV, 1<=LH,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         NVECT = 2                                                      0347

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NW,NWEIG,NWH,
C    NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN==1, KZP==249, LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1, 4LPY==5LTO-1,
C    6LPY==5LZX+1, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, LTN==NW+1,
C    2LTO==MEMSIZ-125, LVECT==127, LZN==1, 7LZX==6LZY+1, MSKIP==129,
C    MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==2,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 9<=LEIG, LEIG<=164985,
C    16NWH+1<=LEIG, LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25,
C    LH<=LEV, 1<=LH, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         NVSKIP = 1                                                     0348

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN==1, KZP==249, LARGE==8LTN+119, LE==1, 7LEIG==8LZY-1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==2LTO-1, 4LPY==5LTO-1,
C    6LPY==5LZX+1, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, LTN==NW+1,
C    2LTO==MEMSIZ-125, LVECT==127, LZN==1, 7LZX==6LZY+1, MSKIP==129,
C    MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==2,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 9<=LEIG, LEIG<=164985,
C    16NWH+1<=LEIG, LEIG<=16NWH+9, 32NWQ+1<=LEIG, LEIG<=32NWQ+25,
C    LH<=LEV, 1<=LH, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         DO 50 J = 1, N1H                                               0349

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, J==NXXOUT-4, J==NXXXIN-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, LH<=LEV,
C    1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN,
C    LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

            CALL IN(CWORK, KZN, N2PD)                                   0350

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

            F = REAL((J-1)*(J-1))*FX*FX                                 0351

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

            DO 60 I = 2, N2                                             0352

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 2<=I, I<=128, 1<=J, J<=64,
C    J<=KZN, 1<=KZN, KZN+138<=8LTN, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

               CWORK(I) = (EVAL(I-1)-F)*CWORK(I)                        0353

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 2<=I, I<=128, 1<=J, J<=64,
C    J<=KZN, 1<=KZN, KZN+138<=8LTN, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

60             CONTINUE                                                 0354

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

            CWORK(1) = -F*CWORK(1)                                      0355

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

            CWORK(N2P) = 0.0                                            0356

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

            CALL OUT(CWORK, KZN, N2PD)                                  0357

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==NXXOUT-5, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

            KZN = KZN+N2PD                                              0358

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==NXXOUT-5, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J+258<=KZN,
C    259<=KZN, KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

50          CONTINUE                                                    0359

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==66,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         NPTS = 2*N2                                                    0360

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         NSKIP = 1                                                      0361

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         MTRN = N1H                                                     0362

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         MSKIP = N2P                                                    0363

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         ISIGN = 1                                                      0364

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL XLOG2(NPTS, LOG)                                          0365

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         IEXSHF = NMAX2/NPTS                                            0366

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL IN(A, LZN, NW)                                            0367

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==67, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL ACAC(A, EX, WORK)                                         0368

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         DO 70 J = 1, N1H                                               0369

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

            DO 80 I = 1, N2PD                                           0370

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

               A(I,J) = 0.5*A(I,J)                                      0371

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

80             CONTINUE                                                 0372

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

70          CONTINUE                                                    0373

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL OUT(A, LZO, NW)                                           0374

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==70, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         IF (NOTEMP.NE.1) THEN                                          0375

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8NW+127, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2NW+1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, 3LTO==4LZO-1,
C    LVECT==127, LZN==1, LZO==3NW+1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==70, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8NW+128,
C    LH<=LEV, 1<=LH, 256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW,
C    NW<=20623, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

            IF (KDATA.NE.1) THEN                                        0376

C  P() {0==-1}

               CALL IN(A, LTN, NW)                                      0377

C  P() {0==-1}

C
C NEW TEMPERATURE KNOWN - SET UP T(OLD):
C
               NPTS = 2*N2                                              0381

C  P() {0==-1}

               NSKIP = 1                                                0382

C  P() {0==-1}

               MTRN = N1H                                               0383

C  P() {0==-1}

               MSKIP = N2P                                              0384

C  P() {0==-1}

               ISIGN = 1                                                0385

C  P() {0==-1}

               CALL XLOG2(NPTS, LOG)                                    0386

C  P() {0==-1}

               IEXSHF = NMAX2/NPTS                                      0387

C  P() {0==-1}

               CALL ACAC(A, EX, WORK)                                   0388

C  P() {0==-1}

               DO 90 J = 1, N1H                                         0389

C  P() {0==-1}

                  DO 100 I = 1, N2PD                                    0390

C  P() {0==-1}

                     A(I,J) = A(I,J)*0.5                                0391

C  P() {0==-1}

100                  CONTINUE                                           0392

C  P() {0==-1}

90                CONTINUE                                              0393

C  P() {0==-1}

               CALL OUT(A, LTO, NW)                                     0394

            ELSE

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8NW+127, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2NW+1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, LZO==3NW+1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==70, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

C
C TEMPERATURE IS SUPPLIED IN PHYSICAL SPACE - SHUFFLE THE DATA AND
C GO TO FOURIER REPRESENTATION:
C
               CALL IN(A, LTN, NW)                                      0401

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==70, NXXRCS==1, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

               CALL SHUF(A, N2P, N1, WORK)                              0402

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

               NPTS = N1                                                0403

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               NSKIP = N2P                                              0404

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               MTRN = N2P                                               0405

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               MSKIP = 1                                                0406

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               ISIGN = -1                                               0407

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               CALL XLOG2(NPTS, LOG)                                    0408

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               IEXSHF = NMAX2/NPTS                                      0409

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               CALL RCS(A, EX)                                          0410

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               F = 0.5/REAL(N1)                                         0411

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               DO 110 J = 1, N1H                                        0412

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

                  DO 120 I = 1, N2PD                                    0413

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J,
C    J<=64, 322<=KZN, KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

                     A(I,J) = F*A(I,J)                                  0414

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J,
C    J<=64, 322<=KZN, KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

120                  CONTINUE                                           0415

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

110               CONTINUE                                              0416

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               CALL OUT(A, LTO, NW)                                     0417

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               NPTS = 2*N2                                              0418

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               NSKIP = 1                                                0419

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               MTRN = N1H                                               0420

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               MSKIP = N2P                                              0421

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               ISIGN = -1                                               0422

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               CALL XLOG2(NPTS, LOG)                                    0423

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==5, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               IEXSHF = NMAX2/NPTS                                      0424

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==5, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               CALL ACAC(A, EX, WORK)                                   0425

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

C           F = 0.25/REAL(N2)
               F = 0.125/REAL(N2)                                       0427

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

               DO 130 J = 1, N1H                                        0428

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

                  DO 140 I = 1, N2PD                                    0429

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

                     A(I,J) = F*A(I,J)                                  0430

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

140                  CONTINUE                                           0431

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

130               CONTINUE                                              0432

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

               CALL OUT(A, LTN, NW)                                     0433
            ENDIF

         ENDIF

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==72, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}


         T = 0.                                                         0438

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==72, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         DTT = DT                                                       0439

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==72, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         NSTEPS = 1                                                     0440
      ENDIF

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NSTEPS,NUMBER,NVECT,NVSKIP,
C    NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {I==259, ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1,
C    NOTEMP==0, NSKIP==1, NSTEPS==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==72, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}


      CALL RUNINF                                                       0443

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NSTEPS,NUMBER,NVECT,NVSKIP,
C    NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {I==259, ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1,
C    NOTEMP==0, NSKIP==1, NSTEPS==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==72, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

      CALL BUG('AFT INITAL')                                            0444

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NVECT,
C    NVSKIP,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,
C    NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==5, NOALS==1, NOTEMP==0, NSKIP==1, NSTEPS==1, NUM1==2,
C    NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0, NXSHUF==2, NXXCSR==0,
C    NXXOUT==72, NXXRCS==2, NXXXIN==68, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120, LH<=LEV, 1<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}


C#
      IF (.TRUE.) THEN                                                  0447

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256}

150      CONTINUE                                                       0448

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256}

C
C THIS IS THE BEGINNING OF THE TIME STEP.
C
         IF (MOD(NSTEPS, KTF).EQ.1.AND.NOTEMP.NE.1) CALL TEMPFO(CA,     0452
     &   N2P, N1H, CWORK)                                               0452

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256}

         IF (MOD(NSTEPS, KPF).EQ.1) CALL PSIFOU(CA, N2P, N1H, CWORK)    0454

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256}

         IF (MOD(NSTEPS, KZF).EQ.1) CALL ZETAFO(CA, N2P, N1H, CWORK)    0455

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256}

         IF (MOD(NSTEPS, KVF).EQ.1) CALL VVELFO(CA, N2P, N1H, FX,       0456
     &   CWORK)                                                         0456

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256}

         IF (MOD(NSTEPS+1, KTA).EQ.1) THEN                              0457

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    5LEIG==8LPY-3, 7LEIG==8LZY-1, LMAPP==1, 6LPY==5LZX+1, LSKIP==2,
C    4LTN==LTO+3, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256}

C
C TIME AVERAGE VORTICITY:
C
            DTT = DT                                                    0461

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    5LEIG==8LPY-3, 7LEIG==8LZY-1, LMAPP==1, 6LPY==5LZX+1, LSKIP==2,
C    4LTN==LTO+3, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256}

            T = T-0.5*DT                                                0462

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    5LEIG==8LPY-3, 7LEIG==8LZY-1, LMAPP==1, 6LPY==5LZX+1, LSKIP==2,
C    4LTN==LTO+3, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256}

            CALL IN(A, LZO, NW)                                         0463

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    5LEIG==8LPY-3, LEIG==8LTN-7, LMAPP==1, 6LPY==5LZX+1, LSKIP==2,
C    4LTN==LTO+3, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1, 256<=NMAX2,
C    NPTS<=256, 1<=NW}

            NPTS = 2*N2                                                 0464

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, 6LPY==5LZX+1, LSKIP==2,
C    4LTN==LTO+3, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

            NSKIP = 1                                                   0465

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

            MTRN = N1H                                                  0466

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

            MSKIP = N2P                                                 0467

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

            ISIGN = -1                                                  0468

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

            IEXSHF = NMAX2/NPTS                                         0469

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

            CALL XLOG2(NPTS, LOG)                                       0470

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

            CALL ACAC(A, EX, WORK)                                      0471

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1, 256<=NMAX2,
C    255<=NPTS, NPTS<=256, 1<=NW}

            F = 0.125/REAL(N2)                                          0472

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1, 256<=NMAX2,
C    255<=NPTS, NPTS<=256, 1<=NW}

            DO 160 J = 1, N1H                                           0473

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=64, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW}

               DO 170 I = 1, N2PD                                       0474

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=258, 1<=J, J<=64, LH<=LEV, 1<=LH, 1<=LZO,
C    LZO+NW<=MEMSIZ+1, 256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW}

                  A(I,J) = A(I,J)*F                                     0475

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=258, 1<=J, J<=64, LH<=LEV, 1<=LH, 1<=LZO,
C    LZO+NW<=MEMSIZ+1, 256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW}

170               CONTINUE                                              0476

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, LH<=LEV, 1<=LH, 1<=LZO,
C    LZO+NW<=MEMSIZ+1, 256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW}

160            CONTINUE                                                 0477

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW}

            CALL OUT(A, LZO, NW)                                        0478

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW}

            ISIGN = 1                                                   0479

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW}

            MTRN = N1Q                                                  0480

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW}

            KZN = LZN                                                   0481

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LZO, LZO+NW<=MEMSIZ+1,
C    256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW}

            KZO = LZO                                                   0482

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZO==LZO, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=KZO,
C    KZO+NW<=MEMSIZ+1, LH<=LEV, 1<=LH, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256, 1<=NW}

            DO 180 K = 1, 2                                             0483

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, 256<=K+NPTS, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256, 1<=NW}

               CALL IN(A, KZO, NWH)                                     0484

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, 256<=K+NPTS, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

               CALL IN(A(1,K2Q), KZN, NWH)                              0485

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, 256<=K+NPTS, 1<=KZN,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256, 1<=NW,
C    1<=NWH}

               DO 190 J = 1, N1Q                                        0486

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K<=KZN,
C    256<=K+NPTS, 1<=KZN, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  K2QJ = J+K2QM                                         0487

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K,
C    K<=2, K<=KZN, 256<=K+NPTS, 1<=KZN, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  DO 200 I = 1, N2PD                                    0488

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=J,
C    J<=32, 1<=K, K<=2, K<=KZN, 256<=K+NPTS, 1<=KZN, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                     A(I,J) = A(I,J)+0.5*A(I,K2QJ)                      0489

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=J,
C    J<=32, 1<=K, K<=2, K<=KZN, 256<=K+NPTS, 1<=KZN, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

200                  CONTINUE                                           0490

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K,
C    K<=2, K<=KZN, 256<=K+NPTS, 1<=KZN, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

190               CONTINUE                                              0491

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    256<=K+NPTS, 1<=KZN, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

               CALL OUT(A, KZN, NWH)                                    0492

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    256<=K+NPTS, 1<=KZN, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

               CALL ACAC(A, EX, WORK)                                   0493

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    255<=K+NPTS, 1<=KZN, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

               DO 210 J = 1, N1Q                                        0494

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K,
C    K<=2, K<=KZN, 255<=K+NPTS, 1<=KZN, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  DO 220 I = 1, N2PD                                    0495

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=J,
C    J<=32, 1<=K, K<=2, K<=KZN, 255<=K+NPTS, 1<=KZN, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                     A(I,J) = 0.5*A(I,J)                                0496

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=J,
C    J<=32, 1<=K, K<=2, K<=KZN, 255<=K+NPTS, 1<=KZN, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

220                  CONTINUE                                           0497

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K,
C    K<=2, K<=KZN, 255<=K+NPTS, 1<=KZN, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

210               CONTINUE                                              0498

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    255<=K+NPTS, 1<=KZN, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

               CALL OUT(A, KZO, NWH)                                    0499

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    255<=K+NPTS, 1<=KZN, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

               KZO = KZO+NWH                                            0500

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO+NWH==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K<=KZN, 255<=K+NPTS, 1<=KZN, KZO+NW<=KZN+MEMSIZ+NWH,
C    KZN+NWH<=KZO, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    LH<=LEV, 1<=LH, 256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

               KZN = KZN+NWH                                            0501

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2,
C    K+NWH<=KZN, 255<=K+NPTS, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN<=MEMSIZ+1, NWH+1<=KZN, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV,
C    1<=LH, 256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

180            CONTINUE                                                 0502

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 256<=NMAX2, 253<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH}

            IF (NOTEMP.NE.1) THEN                                       0503

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, 5LEIG==8LPY-3,
C    7LEIG==8LZY-1, LMAPP==1, LPY==5LTN-4, LSKIP==2, 6LTN==LZX+5,
C    7LTO==4LZY+3, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 256<=NMAX2, 253<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH}

C
C TIME AVERAGE TEMPERATURE:
C
               ISIGN = -1                                               0507

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    7LEIG==8LZY-1, LMAPP==1, LPY==5LTN-4, LSKIP==2, 6LTN==LZX+5,
C    7LTO==4LZY+3, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 256<=NMAX2, 253<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH}

               MTRN = N1H                                               0508

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 6LTN==LZX+5, 7LTN==LZY+6,
C    7LTO==4LZY+3, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 256<=NMAX2, 253<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH}

               CALL IN(A, LTO, NW)                                      0509

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTO,
C    LTO+NW<=MEMSIZ+1, 256<=NMAX2, 253<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

               CALL ACAC(A, EX, WORK)                                   0510

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

               F = 0.125/REAL(N2)                                       0511

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

               DO 230 J = 1, N1H                                        0512

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

                  DO 240 I = 1, N2PD                                    0513

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=J,
C    J<=64, KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

                     A(I,J) = F*A(I,J)                                  0514

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=J,
C    J<=64, KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

240                  CONTINUE                                           0515

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

230               CONTINUE                                              0516

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

               CALL OUT(A, LTO, NW)                                     0517

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

               ISIGN = 1                                                0518

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

               MTRN = N1Q                                               0519

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NW,
C    1<=NWH}

               KTO = LTO                                                0520

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO==4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV,
C    1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4, 256<=NMAX2, 252<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH}

               KTN = LTN                                                0521

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, 4KTN==KTO+3, 8KTN==LEIG+7,
C    5KTN==LPY+4, KTN==LTN, 4KTN==LTO+3, 6KTN==LZX+5, 7KTN==LZY+6,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZO==KZO+1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127,
C    LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=KTN, 4KTN+NW<=MEMSIZ+4, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 256<=NMAX2, 252<=NPTS, NPTS<=256,
C    1<=NW, 1<=NWH}

               DO 250 K = 1, 2                                          0522

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2,
C    K+4LTN<=KTO+4, 253<=K+NPTS, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV,
C    1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4, 256<=NMAX2, NPTS<=256, 1<=NW,
C    1<=NWH}

                  CALL IN(A, KTO, NWH)                                  0523

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2,
C    K+4LTN<=KTO+4, 253<=K+NPTS, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  CALL IN(A(1,K2Q), KTN, NWH)                           0524

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2,
C    K+4LTN<=KTO+4, 253<=K+NPTS, 1<=KTN, KTN+NWH<=MEMSIZ+1, 1<=KTO,
C    KTO+NWH<=MEMSIZ+1, KZN<=KZO, KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+NW<=MEMSIZ+4, 256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  DO 260 J = 1, N1Q                                     0525

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K,
C    K<=2, K+4LTN<=KTO+4, 253<=K+NPTS, 1<=KTN, KTN+NWH<=MEMSIZ+1,
C    1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO, KZO+NW<=KZN+MEMSIZ,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV,
C    1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4, 256<=NMAX2, NPTS<=256, 1<=NW,
C    1<=NWH}

                     K2QJ = J+K2QM                                      0526

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS, 1<=KTN,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                     DO 270 I = 1, N2PD                                 0527

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=258, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS,
C    1<=KTN, KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                        A(I,J) = A(I,J)+0.5*A(I,K2QJ)                   0528

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=258, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS,
C    1<=KTN, KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

270                     CONTINUE                                        0529

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS,
C    1<=KTN, KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

260                  CONTINUE                                           0530

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS, 1<=KTN,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  CALL OUT(A, KTN, NWH)                                 0531

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS, 1<=KTN,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  CALL ACAC(A, EX, WORK)                                0532

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS, 1<=KTN,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  DO 280 J = 1, N1Q                                     0533

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS, 1<=KTN,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                     DO 290 I = 1, N2PD                                 0534

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=258, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS,
C    1<=KTN, KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                        A(I,J) = 0.5*A(I,J)                             0535

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=258, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS,
C    1<=KTN, KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

290                     CONTINUE                                        0536

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS,
C    1<=KTN, KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

280                  CONTINUE                                           0537

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS, 1<=KTN,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  CALL OUT(A, KTO, NWH)                                 0538

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS, 1<=KTN,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  KTO = KTO+NWH                                         0539

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN+NWH==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+4LTN+NWH<=KTO+4, 252<=K+NPTS, 1<=KTN,
C    KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

                  KTN = KTN+NWH                                         0540

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+LZO==KZO+1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+4LTN+NWH<=KTO+4, 252<=K+NPTS,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=KZO,
C    KZO+NW<=KZN+MEMSIZ, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LTN, 4LTN+NW<=MEMSIZ+4,
C    256<=NMAX2, NPTS<=256, 1<=NW, 1<=NWH}

250               CONTINUE                                              0541
            ENDIF

         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {16ISIGN+MTRN==48,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 0<=ISIGN+1, ISIGN<=1, LH<=LEV, 1<=LH, 256<=NMAX2,
C    NPTS<=256}

C
C THE BEGINING OF A NORMAL TIME STEP
C (U IS X VELOCITY AND V IS Y VELOCITY)
C FIND (-U) = D(PSI)/DY
C
C
         IF (NSTEPS.LT.3) THEN                                          0551

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {16ISIGN+MTRN==48,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, 5LEIG==8LPY-3, 7LEIG==8LZY-1, LMAPP==1,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, LVECT==127, LZN==1,
C    7LZX==6LZY+1, MSKIP==129, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, NSTEPS<=2}

            CALL IN(CA, LPN, NW)                                        0552

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {16ISIGN+MTRN==48,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, 5LEIG==8LPY-3, 7LEIG==8LZY-1, LMAPP==1,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==129, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1, LH<=LEV, 1<=LH,
C    1<=LPN, LPN+NW<=MEMSIZ+1, 256<=NMAX2, NPTS<=256, NSTEPS<=2,
C    1<=NW}

            CALL PSIPHY(CA, N2P, N1H, EX, G, U, WORK, CWORK3, 1)        0553

         ELSE

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {16ISIGN+MTRN==48,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, 5LEIG==8LPY-3, 7LEIG==8LZY-1, LMAPP==1,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, LVECT==127, LZN==1,
C    7LZX==6LZY+1, MSKIP==129, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1, LH<=LEV, 1<=LH,
C    256<=NMAX2, NPTS<=256, 3<=NSTEPS}

            CALL IN(CA, LPN, NW)                                        0556

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {16ISIGN+MTRN==48,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, 5LEIG==8LPY-3, 7LEIG==8LZY-1, LMAPP==1,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==129, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1, LH<=LEV, 1<=LH,
C    1<=LPN, LPN+NW<=MEMSIZ+1, 256<=NMAX2, NPTS<=256, 3<=NSTEPS,
C    1<=NW}

            IF (MOD(NSTEPS, KPP).EQ.1) CALL PSIPHY(CA, N2P, N1H, EX,    0557
     &      G, U, WORK, CWORK3, -1)                                     0557
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL)
C    {2048ISIGN+97MSKIP+128MTRN==18657, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP+NSKIP==130,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV,
C    1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, MSKIP<=129,
C    16609<=97MSKIP+128MTRN, 65MSKIP+128MTRN<=16577, NPTS<=MSKIP+127,
C    256<=NMAX2, 1<=NW}

C
         NPTS = 2*N2                                                    0561

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL)
C    {2048ISIGN+97MSKIP+128MTRN==18657, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP+NSKIP==130,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, MSKIP<=129,
C    16609<=97MSKIP+128MTRN, 65MSKIP+128MTRN<=16577, 256<=NMAX2,
C    1<=NW}

         NSKIP = 1                                                      0562

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL)
C    {2048ISIGN+97MSKIP+128MTRN==18657, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV,
C    1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, MSKIP<=129,
C    16609<=97MSKIP+128MTRN, 65MSKIP+128MTRN<=16577, 256<=NMAX2,
C    1<=NW}

         MTRN = N1H                                                     0563

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    ISIGN<=1, 65<=64ISIGN+MSKIP, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, MSKIP<=129, 256<=NMAX2, 1<=NW}

         MSKIP = N2P                                                    0564

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1, LH<=LEV, 1<=LH,
C    1<=LPN, LPN+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW}

         ISIGN = 1                                                      0565

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

         CALL XLOG2(NPTS, LOG)                                          0566

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

         IEXSHF = NMAX2/NPTS                                            0567

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

         CALL IN(CA, LPN, NW)                                           0568

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

         F = 0.                                                         0569

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

         DO 300 I = 1, N2                                               0570

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW}

            DO 310 J = 1, N1H                                           0571

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64, LH<=LEV, 1<=LH,
C    1<=LPN, LPN+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW}

               CA(I,J) = CMPLX(-F*AIMAG(CA(I,J)), F*REAL(CA(I,J)))      0572

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64, LH<=LEV, 1<=LH,
C    1<=LPN, LPN+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW}

310            CONTINUE                                                 0573

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==65,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=128, LH<=LEV, 1<=LH,
C    1<=LPN, LPN+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW}

            F = F+1.                                                    0574

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==65,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=128, LH<=LEV, 1<=LH,
C    1<=LPN, LPN+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW}

300         CONTINUE                                                    0575

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW}

         DO 320 J = 1, N1H                                              0576

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, LH<=LEV, 1<=LH,
C    1<=LPN, LPN+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW}

            CA(N2P,J) = 0.                                              0577

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, LH<=LEV, 1<=LH,
C    1<=LPN, LPN+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW}

320         CONTINUE                                                    0578

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW}

         CALL SCSC(CA, EX, WORK)                                        0579

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW}

         CALL OUT(CA, LPY, NW)                                          0580

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 255<=NPTS, NPTS<=256,
C    1<=NW}

         IF (KSM.EQ.1) CALL MEAN(CA, U, G)                              0581

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, 5LEIG==8LPY-3, LMAPP==1, 4LPY==5LTO-1, LSKIP==2,
C    6LTN==LZX+5, 7LTN==LZY+6, 3LTO==2LZX+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=LEIG, 5LEIG+8NW<=8MEMSIZ+5, LH<=LEV,
C    1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256, 1<=NW}

         IF (MOD(NSTEPS, KUF).EQ.1) CALL UVELFO(CA, N2P, N1H, G, EX,    0582
     &   CWORK)                                                         0582

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==2LTO-1, LMAPP==1, 4LPY==5LTO-1, LSKIP==2,
C    4LTN==LTO+3, 7LTN==LZY+6, 3LTO==2LZX+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTO, 5LTO+4NW<=4MEMSIZ+5, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NW}

         CALL IN(CA, LPN, NW)                                           0583

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NW}

C
C FIND  V = D(PSI)/DX
C
         F = 0.                                                         0587

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NW}

         DO 330 J = 1, N1H                                              0588

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=64, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NW}

            DO 340 I = 1, N2P                                           0589

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

               CA(I,J) = CMPLX(-F*AIMAG(CA(I,J)), F*REAL(CA(I,J)))      0590

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

340            CONTINUE                                                 0591

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

            F = F+FX                                                    0592

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

330         CONTINUE                                                    0593

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NW}

         CALL ACAC(CA, EX, WORK)                                        0594

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 253<=NPTS, NPTS<=256,
C    1<=NW}

         CALL OUT(CA, LPN, NW)                                          0595

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 253<=NPTS, NPTS<=256,
C    1<=NW}

         IF (MOD(NSTEPS, KPP).EQ.1.AND.NOTEMP.NE.1) CALL IN(CA, LPN,    0596
     &   NW)                                                            0596

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 253<=NPTS, NPTS<=256,
C    1<=NW}

         NPTS = 2*N2                                                    0597

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

         NSKIP = 1                                                      0598

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

         MTRN = N1H                                                     0599

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

         MSKIP = N2P                                                    0600

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

         ISIGN = 1                                                      0601

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

         CALL XLOG2(NPTS, LOG)                                          0602

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

         IEXSHF = NMAX2/NPTS                                            0603

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

         IF (NOTEMP.NE.1) THEN                                          0604

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, 3LEIG==4LZX-1, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 7LTN==LZY+6, 3LTO==2LZX+1, LVECT==127,
C    LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTO, 5LTO+4NW<=4MEMSIZ+5, 256<=NMAX2, 1<=NW}

C
C T(TOTAL) = T-BETA*Y
C WHERE BETA < 0 MEANS   STABLE STRATIFICATION AND
C       BETA > 0 MEANS UNSTABLE STRATIFICATION
C
            KTO = LTO                                                   0610

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO==LTO, 3KTO==2LZX+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=KTO,
C    5KTO+4NW<=4MEMSIZ+5, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

            DTB = 0.5*BETA*DTT                                          0611

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO==LTO, 3KTO==2LZX+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=KTO,
C    5KTO+4NW<=4MEMSIZ+5, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW}

            DO 350 J = 1, N1H                                           0612

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+4LTN<=KTO+4, LH<=LEV,
C    1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5,
C    256<=NMAX2, 1<=NW}

               CALL IN(CWORK, KTO, N2PD)                                0613

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+4LTN<=KTO+4, 1<=KTO,
C    KTO+257<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

               F = -REAL(J-1)*FX*DTT*0.25                               0614

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+4LTN<=KTO+4, 1<=KTO,
C    KTO+257<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

               DO 360 I = 1, N2P                                        0615

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, J+4LTN<=KTO+4,
C    1<=KTO, KTO+257<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

                  CWORK(I) = CWORK(I)*CMPLX(1., U(I)*F)+DTB*CA(I,J)     0616

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, J+4LTN<=KTO+4,
C    1<=KTO, KTO+257<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

360               CONTINUE                                              0617

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+4LTN<=KTO+4,
C    1<=KTO, KTO+257<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

               CALL OUT(CWORK, KTO, N2PD)                               0618

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+4LTN<=KTO+4,
C    1<=KTO, KTO+257<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

               KTO = KTO+N2PD                                           0619

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+4LTN+254<=KTO,
C    259<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}

350            CONTINUE                                                 0620
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 256<=NMAX2, 1<=NW}


         CALL IN(CA, LZN, NW)                                           0623

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ, 256<=NMAX2, 1<=NW}

C
C FIND DZ/DY:
C
         F = 0.                                                         0627

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ, 256<=NMAX2, 1<=NW}

         DO 370 I = 1, N2                                               0628

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ, 256<=NMAX2, 1<=NW}

            DO 380 J = 1, N1H                                           0629

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64, 259<=KTO,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ,
C    256<=NMAX2, 1<=NW}

               CA(I,J) = CMPLX(-F*AIMAG(CA(I,J)), F*REAL(CA(I,J)))      0630

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64, 259<=KTO,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ,
C    256<=NMAX2, 1<=NW}

380            CONTINUE                                                 0631

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==65,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=128, 259<=KTO,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ,
C    256<=NMAX2, 1<=NW}

            F = F+1.                                                    0632

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==65,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=128, 259<=KTO,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ,
C    256<=NMAX2, 1<=NW}

370         CONTINUE                                                    0633

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ, 256<=NMAX2, 1<=NW}

         DO 390 J = 1, N1H                                              0634

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, 259<=KTO,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ,
C    256<=NMAX2, 1<=NW}

            CA(N2P,J) = 0.                                              0635

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, 259<=KTO,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ,
C    256<=NMAX2, 1<=NW}

390         CONTINUE                                                    0636

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ, 256<=NMAX2, 1<=NW}

         CALL SCSC(CA, EX, WORK)                                        0637

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, NW<=MEMSIZ, 256<=NMAX2, 255<=NPTS, NPTS<=256,
C    1<=NW}

         CALL OUT(CA, LZY, NW)                                          0638

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    255<=NPTS, NPTS<=256, 1<=NW}

         CALL IN(CA, LZN, NW)                                           0639

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    255<=NPTS, NPTS<=256, 1<=NW}

         CALL ACAC(CA, EX, WORK)                                        0640

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

         DO 400 J = 1, N1H                                              0641

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=64, 259<=KTO, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

            DO 410 I = 1, N2P                                           0642

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

               CA(I,J) = CA(I,J)*0.5                                    0643

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

410            CONTINUE                                                 0644

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

400         CONTINUE                                                    0645

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

         CALL OUT(CA, LZN, NW)                                          0646

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW}

         NPTS = N1                                                      0647

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    1<=NW}

         NSKIP = N2P                                                    0648

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    1<=NW}

         MTRN = N2P                                                     0649

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    1<=NW}

         MSKIP = 1                                                      0650

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    1<=NW}

         ISIGN = 1                                                      0651

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    1<=NW}

         CALL XLOG2(NPTS, LOG)                                          0652

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    1<=NW}

         IEXSHF = NMAX2/NPTS                                            0653

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 7LTN+NW<=MEMSIZ+7, NW<=MEMSIZ, 256<=NMAX2,
C    1<=NW}

         IF (MOD(NSTEPS, KZP).EQ.1) CALL ZETAPH(CA, N2PD, N1H, EX,      0654
     &   WORK, -1)                                                      0654

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         IF (MOD(NSTEPS, KZP).EQ.1) CALL IN(CA, LZN, NW)                0655

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==2LTO-1, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

C
C FIND DZ/DX:
C
         F = 0.                                                         0659

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==2LTO-1, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         DO 420 J = 1, N1H                                              0660

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

            DO 430 I = 1, N2P                                           0661

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

               CA(I,J) = CMPLX(-F*AIMAG(CA(I,J)), F*REAL(CA(I,J)))      0662

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

430            CONTINUE                                                 0663

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

            F = F+FX2                                                   0664

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

420         CONTINUE                                                    0665

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         CALL CSR(CA, EX)                                               0666

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         CALL OUT(CA, LZX, NW)                                          0667

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         CALL IN(CA, LZY, NW)                                           0668

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         CALL CSR(CA, EX)                                               0669

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         CALL OUT(CA, LZY, NW)                                          0670

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         CALL IN(CA, LPN, NW)                                           0671

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         CALL CSR(CA, EX)                                               0672

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         CALL OUT(CA, LPN, NW)                                          0673

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         CALL IN(CA, LPY, NW)                                           0674

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW}

         CALL CSR(CA, EX)                                               0675

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW}

         CALL OUT(CA, LPY, NW)                                          0676

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW}

C
C WE ARE IN PHYSICAL SPACE NOW - FIND  (U,V).GRAD (Z):
C
         IF (MOD(NSTEPS, KUP).EQ.1) CALL UVELPH(A, N2PD, N1H, WORK, -   0680
     &   1)                                                             0680

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         IF (MOD(NSTEPS, KVP).EQ.1) CALL VVELPH(A, N2PD, N1H, WORK, -   0681
     &   1)                                                             0681

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         KPY = LPY                                                      0682

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KPY==5LTN-4, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, 1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         KPN = LPN                                                      0683

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN==LPN, KPP==249, KPRESS==1, KPY==5LTN-4,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=KPN, KPN+NW<=MEMSIZ+1, 4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV,
C    1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         KZY = LZY                                                      0684

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN==LPN, KPP==249, KPRESS==1, KPY==5LTN-4,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZY==7LTN-6, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=KPN, KPN+NW<=MEMSIZ+1, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW}

         KZX = LZX                                                      0685

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN==LPN, KPP==249, KPRESS==1, KPY==5LTN-4,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX==6LTN-5, KZY==7LTN-6,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=KPN, KPN+NW<=MEMSIZ+1,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         UKSM1F = REAL(2-KSM)                                           0686

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN==LPN, KPP==249, KPRESS==1, KPY==5LTN-4,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX==6LTN-5, KZY==7LTN-6,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=KPN, KPN+NW<=MEMSIZ+1,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

         DO 440 K = 1, 4                                                0687

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN<=KZX+6, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, 4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV,
C    1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW}

            CALL IN(A, KPY, NWQ)                                        0688

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN<=KZX+6, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, 1<=KPY, KPY+NWQ<=MEMSIZ+1,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

            CALL IN(A(1,K1Q), KPN, NWQ)                                 0689

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN+NWQ<=MEMSIZ+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO, KTO<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

            CALL IN(A(1,K2Q), KZY, NWQ)                                 0690

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN+NWQ<=MEMSIZ+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

            CALL IN(A(1,K3Q), KZX, NWQ)                                 0691

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN+NWQ<=MEMSIZ+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZX,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

            DO 450 I = 1, N2PD                                          0692

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=I, I<=258, 1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN+NWQ<=MEMSIZ+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZX,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

               IPH = (I+1)/2                                            0693

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=K, K<=4, K+6LTN<=KZX+6,
C    1<=KPN, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZX, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

               GG = G(IPH)                                              0694

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=K, K<=4, K+6LTN<=KZX+6,
C    1<=KPN, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZX, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

               UU = U(IPH)*UKSM1F                                       0695

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=K, K<=4, K+6LTN<=KZX+6,
C    1<=KPN, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZX, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

               DO 460 J = 1, N1E                                        0696

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=J, J<=16, 1<=K, K<=4,
C    K+6LTN<=KZX+6, 1<=KPN, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN+NWQ<=MEMSIZ+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZX,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

                  A(I,J) = A(I,J)*GG+UU                                 0697

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=J, J<=16, 1<=K, K<=4,
C    K+6LTN<=KZX+6, 1<=KPN, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN+NWQ<=MEMSIZ+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZX,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

                  A(I,K2QM+J) = A(I,J)*A(I,K3QM+J)-A(I,K1QM+J)*A(I,     0698
     &            K2QM+J)*GG                                            0698

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=J, J<=16, 1<=K, K<=4,
C    K+6LTN<=KZX+6, 1<=KPN, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN+NWQ<=MEMSIZ+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZX,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

460               CONTINUE                                              0700

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==17,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=258, 2IPH<=I+1,
C    I<=2IPH, 1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN+NWQ<=MEMSIZ+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZX,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

450            CONTINUE                                                 0701

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN<=KZX+6,
C    1<=KPN, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZX, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

            CALL OUT(A, KPY, NWQ)                                       0702

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN<=KZX+6,
C    1<=KPN, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZX, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

            CALL OUT(A(1,K2Q), KZY, NWQ)                                0703

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN<=KZX+6,
C    1<=KPN, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZX, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

            KPN = KPN+NWQ                                               0704

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZX+LPN+NWQ==KPN+6LTN-5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN<=KZX+6,
C    KPN+6LTN+NW<=KZX+MEMSIZ+NWQ+6, KZX+NWQ+6<=KPN+6LTN,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, 1<=KPY, KPY+NWQ<=MEMSIZ+1,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZX, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

            KPY = KPY+NWQ                                               0705

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZX+LPN+NWQ==KPN+6LTN-5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+NWQ+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN<=KZX+6,
C    KPN+6LTN+NW<=KZX+MEMSIZ+NWQ+6, KZX+NWQ+6<=KPN+6LTN,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZX, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

            KZX = KZX+NWQ                                               0706

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LTN==KZY+NWQ+1, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN+NWQ<=KZX+6,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

            KZY = KZY+NWQ                                               0707

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN+NWQ<=KZX+6,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY<=MEMSIZ+1,
C    NWQ+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWQ}

440         CONTINUE                                                    0708

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

C
C [Z(OLD) + (MEAN -U) * (-DZ(OLD)/DX)] + (U,V).GRAD(Z)
C
         ISIGN = -1                                                     0712

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

         CALL IN(A, LZY, NW)                                            0713

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

         CALL RCS(A, EX)                                                0714

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

         CALL OUT(A, LZY, NW)                                           0715

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

         KZO = LZO                                                      0716

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZO==LZO, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

         KZN = LZN                                                      0717

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZO==LZO, KZP==249, KZX+LTN==KZY+1, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

         KZY = LZY                                                      0718

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZO==LZO, KZP==249, KZY==7LTN-6, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

         DTFAC = 0.125*DTT/REAL(N1)                                     0719

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZO==LZO, KZP==249, KZY==7LTN-6, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

         F1 = DTT*FX*0.25                                               0720

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZO==LZO, KZP==249, KZY==7LTN-6, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

         F = F1                                                         0721

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZO==LZO, KZP==249, KZY==7LTN-6, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

         DO 470 K = 1, 2                                                0722

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+7LTN==KZY+7,
C    KZO+7LTN==KZY+LZO+6, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K+7LTN<=KZY+7, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWQ}

            CALL IN(CA, KZO, NWH)                                       0723

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+7LTN==KZY+7,
C    KZO+7LTN==KZY+LZO+6, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K+7LTN<=KZY+7, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1,
C    KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL IN(CA(1,K2Q), KZN, NWH)                                0724

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+7LTN==KZY+7,
C    KZO+7LTN==KZY+LZO+6, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K+7LTN<=KZY+7, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(CA(1,K2Q), KZO, NWH)                               0725

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+7LTN==KZY+7,
C    KZO+7LTN==KZY+LZO+6, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K+7LTN<=KZY+7, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL IN(CA(1,K2Q), KZY, NWH)                                0726

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+7LTN==KZY+7,
C    KZO+7LTN==KZY+LZO+6, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K+7LTN<=KZY+7, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            DO 480 J = 1, N1Q                                           0727

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+7LTN==KZY+7,
C    KZO+7LTN==KZY+LZO+6, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K+7LTN<=KZY+7, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, 1<=KZO, KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    1<=KZY, KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               K2QJ = J+K2QM                                            0728

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+7LTN<=KZY+7,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               F = F-F1                                                 0729

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+7LTN<=KZY+7,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               DO 490 I = 1, N2P                                        0730

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K+7LTN<=KZY+7, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  CA(I,J) = CA(I,J)*CMPLX(1., F*U(I))+DTFAC*CA(I,K2QJ   0731
     &            )                                                     0731

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K+7LTN<=KZY+7, KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

490               CONTINUE                                              0732

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+7LTN<=KZY+7,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

480            CONTINUE                                                 0733

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+7LTN<=KZY+7,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(CA, KZN, NWH)                                      0734

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+7LTN<=KZY+7,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KZN = KZN+NWH                                               0735

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+NWH+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+7LTN<=KZY+7,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+1<=KZN, 1<=KZO,
C    KZO+NWH<=MEMSIZ+1, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KZO = KZO+NWH                                               0736

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+NWH+7, KZY+LZO+NWH==KZO+7LTN-6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+7LTN<=KZY+7,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+1<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=MEMSIZ+1, LH<=LEV,
C    1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

            KZY = KZY+NWH                                               0737

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+7LTN+NWH<=KZY+7,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+1<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

470         CONTINUE                                                    0738

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         IF (NOTEMP.NE.1) THEN                                          0739

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    2KPN+3LTO==2KZX+2LPN+1, KPP==249, KPRESS==1, 4KPY+LTO==4KZX+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, 4KZN+7LTO==4KZY+7,
C    4KZO+7LTO==4KZY+4LZO+3, KZP==249, LE==1, LEIG==2LTO-1, LMAPP==1,
C    4LPY==5LTO-1, 6LPY==5LZX+1, LSKIP==2, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    2KZX+3<=2KPN+3LTO, 2KPN+3LTO+2NW<=2KZX+2MEMSIZ+3, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, LTO+321<=KTO,
C    KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    4KZX+LTO<=4MEMSIZ+5, 4NWQ+5<=4KZX+LTO, 3LTO+2NWQ+5<=2KZX,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, 7LTO+4NWH+1<=4KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LTO, 7LTO+4NW<=4MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

C
C FIND DT/DY:
C
            NPTS = 2*N2                                                 0743

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    2KPN+3LTO==2KZX+2LPN+1, KPP==249, KPRESS==1, 4KPY+LTO==4KZX+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, 4KZN+7LTO==4KZY+7,
C    4KZO+7LTO==4KZY+4LZO+3, KZP==249, LE==1, LEIG==2LTO-1, LMAPP==1,
C    LPY==5LTN-4, 4LPY==5LTO-1, LSKIP==2, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    2KZX+3<=2KPN+3LTO, 2KPN+3LTO+2NW<=2KZX+2MEMSIZ+3, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, LTO+321<=KTO,
C    KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    4KZX+LTO<=4MEMSIZ+5, 4NWQ+5<=4KZX+LTO, 3LTO+2NWQ+5<=2KZX,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, 7LTO+4NWH+1<=4KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LTO, 7LTO+4NW<=4MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            NSKIP = 1                                                   0744

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    2KPN+3LTO==2KZX+2LPN+1, KPP==249, KPRESS==1, 4KPY+LTO==4KZX+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, 4KZN+7LTO==4KZY+7,
C    4KZO+7LTO==4KZY+4LZO+3, KZP==249, LE==1, LEIG==2LTO-1, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    2KZX+3<=2KPN+3LTO, 2KPN+3LTO+2NW<=2KZX+2MEMSIZ+3, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, LTO+321<=KTO,
C    KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    4KZX+LTO<=4MEMSIZ+5, 4NWQ+5<=4KZX+LTO, 3LTO+2NWQ+5<=2KZX,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, 7LTO+4NWH+1<=4KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LTO, 7LTO+4NW<=4MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            MTRN = N1H                                                  0745

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            MSKIP = N2P                                                 0746

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            ISIGN = 1                                                   0747

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL XLOG2(NPTS, LOG)                                       0748

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            IEXSHF = NMAX2/NPTS                                         0749

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL IN(CA, LTN, NW)                                        0750

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            F = 0.                                                      0751

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            DO 500 I = 1, N2                                            0752

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               DO 510 J = 1, N1H                                        0753

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, 7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN, LTN+NW<=MEMSIZ+1,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  CA(I,J) = CMPLX(-F*AIMAG(CA(I,J)), F*REAL(CA(I,J)))   0754

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64,
C    KZX+6<=KPN+6LTN, KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, 7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN, LTN+NW<=MEMSIZ+1,
C    7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

510               CONTINUE                                              0755

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               F = F+1.                                                 0756

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

500            CONTINUE                                                 0757

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            DO 520 J = 1, N1H                                           0758

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               CA(N2P,J) = 0.                                           0759

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

520            CONTINUE                                                 0760

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            CALL SCSC(CA, EX, WORK)                                     0761

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2,
C    255<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(CA, LZY, NW)                                       0762

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2,
C    255<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL IN(CA, LTN, NW)                                        0763

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2,
C    255<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL ACAC(CA, EX, WORK)                                     0764

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(CA, LTN, NW)                                       0765

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            NPTS = N1                                                   0766

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            NSKIP = N2P                                                 0767

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            MTRN = N2P                                                  0768

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            MSKIP = 1                                                   0769

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            CALL XLOG2(NPTS, LOG)                                       0770

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            IEXSHF = NMAX2/NPTS                                         0771

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            IF (NSTEPS.EQ.1) THEN                                       0772

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    7KPN+6LZY==7KZX+7LPN-1, KPP==249, KPRESS==1, 7KPY+LZY==7KZX+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+LZY==KZY+1, KZO+LZY==KZY+LZO,
C    KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1, LPY==5LTN-4,
C    6LPY==5LZX+1, LSKIP==2, 4LTN==LTO+3, LVECT==127, LZN==1,
C    7LZX==6LZY+1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NSTEPS==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    7KZX+6<=7KPN+6LZY, 7KPN+6LZY+7NW<=7KZX+7MEMSIZ+6, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LZY+2250<=7KTO,
C    KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    7KZX+LZY<=7MEMSIZ+8, 7NWQ+8<=7KZX+LZY, 6LZY+7NWQ+22<=7KZX,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+7NW<=7MEMSIZ+1,
C    LZY+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL TEMPHY(A, N2PD, N1H, EX, WORK, 0)                   0773

            ELSEIF (MOD(NSTEPS, KTP).EQ.1.OR.MOD(NSTEPS, KPP).EQ.1      0772
     &      ) THEN                                                      0772

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LEIG==2LTO-1, LMAPP==1, 4LPY==5LTO-1, LSKIP==2,
C    4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               CALL TEMPHY(A, N2PD, N1H, EX, WORK, -1)                  0777
            ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

C
C TEMPERATURE INFLUENCE:
C
            F = -FX                                                     0782

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+7LTN==KZY+7, KZO+7LTN==KZY+LZO+6, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2,
C    NWQ+2<=KZX+LTN, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            KZN = LZN                                                   0783

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN==1, KZO+7LTN==KZY+LZO+6, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=MEMSIZ+1,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LTN<=MEMSIZ+2, NWQ+2<=KZX+LTN,
C    6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+6<=7LTN+MEMSIZ,
C    7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            KZX = LZX                                                   0784

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+5LTN==KPY+LPN+4, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN==1, KZO+7LTN==KZY+LZO+6, KZP==249, KZX==6LTN-5,
C    LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KPY+5<=KPN+5LTN,
C    KPN+5LTN+NW<=KPY+MEMSIZ+5, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY+LTN<=MEMSIZ+2, KPY+2LTN<=MEMSIZ+3, NWQ+3<=KPY+2LTN,
C    NWQ+2<=KPY+LTN, 5LTN+NWQ<=KPY+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZY+6<=7LTN+MEMSIZ, 7LTN+NWH<=KZY+5, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    LH<=LEV, 1<=LH, 1<=LTN, LTN+NW<=MEMSIZ+1, 7LTN+NW<=MEMSIZ+7,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KTN = LTN                                                   0785

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+5KTN==KPY+LPN+4, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 7KTN+KZO==KZY+LZO+6, 6KTN==KZX+5, KTN==LTN,
C    6KTN==LZX+5, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KPY+5<=KPN+5KTN,
C    KPN+5KTN+NW<=KPY+MEMSIZ+5, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY+KTN<=MEMSIZ+2, KPY+2KTN<=MEMSIZ+3, NWQ+3<=KPY+2KTN,
C    NWQ+2<=KPY+KTN, 5KTN+NWQ<=KPY+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    1<=KTN, 4KTN+318<=KTO, KZY+6<=7KTN+MEMSIZ, 7KTN+NWH<=KZY+5,
C    KTN+NW<=MEMSIZ+1, 7KTN+NW<=MEMSIZ+7, KTO<=MEMSIZ+1,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            DTA = 0.5*ALPHA*DTT                                         0786

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+5KTN==KPY+LPN+4, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 7KTN+KZO==KZY+LZO+6, 6KTN==KZX+5, KTN==LTN,
C    6KTN==LZX+5, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KPY+5<=KPN+5KTN,
C    KPN+5KTN+NW<=KPY+MEMSIZ+5, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY+KTN<=MEMSIZ+2, KPY+2KTN<=MEMSIZ+3, NWQ+3<=KPY+2KTN,
C    NWQ+2<=KPY+KTN, 5KTN+NWQ<=KPY+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    1<=KTN, 4KTN+318<=KTO, KZY+6<=7KTN+MEMSIZ, 7KTN+NWH<=KZY+5,
C    KTN+NW<=MEMSIZ+1, 7KTN+NW<=MEMSIZ+7, KTO<=MEMSIZ+1,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            DO 530 K = 1, 2                                             0787

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1,
C    5KZN+KZX==6KTN, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, KPY+5KZN<=KPN+5KTN,
C    KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTO<=MEMSIZ+1,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(CA, KZN, NWH)                                    0788

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1,
C    5KZN+KZX==6KTN, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, KPY+5KZN<=KPN+5KTN,
C    KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTO<=MEMSIZ+1, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(CA(1,K2Q), KTN, NWH)                             0789

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1,
C    5KZN+KZX==6KTN, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, KPY+5KZN<=KPN+5KTN,
C    KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               DO 540 J = 1, N1Q                                        0790

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1,
C    5KZN+KZX==6KTN, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K<=KZN,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  K2QJ = J+K2QM                                         0791

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1,
C    KPY+2KTN<=2KZN+MEMSIZ+1, 2KZN+NWQ+1<=KPY+2KTN,
C    KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  F = F+FX                                              0792

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1,
C    KPY+2KTN<=2KZN+MEMSIZ+1, 2KZN+NWQ+1<=KPY+2KTN,
C    KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  DO 550 I = 1, N2P                                     0793

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32,
C    1<=K, K<=2, K<=KZN, KPY+5KZN<=KPN+5KTN,
C    KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                     CA(I,K2QJ) = CMPLX(-F*AIMAG(CA(I,K2QJ)), F*REAL(   0794
     &               CA(I,K2QJ)))                                       0794

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32,
C    1<=K, K<=2, K<=KZN, KPY+5KZN<=KPN+5KTN,
C    KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                     CA(I,J) = CA(I,J)+DTA*CA(I,K2QJ)                   0796

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32,
C    1<=K, K<=2, K<=KZN, KPY+5KZN<=KPN+5KTN,
C    KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN,
C    KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

550                  CONTINUE                                           0797

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1,
C    KPY+2KTN<=2KZN+MEMSIZ+1, 2KZN+NWQ+1<=KPY+2KTN,
C    KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

540               CONTINUE                                              0798

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL OUT(CA, KZN, NWH)                                   0799

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL OUT(CA(1,K2Q), KZX, NWH)                            0800

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, 1<=KZX, KZX+NWH<=MEMSIZ+1, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    LH<=LEV, 1<=LH, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               KZX = KZX+NWH                                            0801

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 6KTN+NWH==5KZN+KZX, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    LH<=LEV, 1<=LH, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               KTN = KTN+NWH                                            0802

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPY+5KZN+LPN+5NWH==KPN+5KTN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, 7KZN+KZY+LZO+7NWH==7KTN+KZO+1,
C    5KZN+KZX+5NWH==6KTN, KZN+LTN+NWH==KTN+1, 6KZN+LZX+6NWH==6KTN+1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    KPN+5KTN+NW<=KPY+5KZN+MEMSIZ+5NWH, KPY+5KZN+5NWH<=KPN+5KTN,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+NWH+1,
C    KPY+2KTN<=2KZN+MEMSIZ+2NWH+1, 2KZN+2NWH+NWQ+1<=KPY+2KTN,
C    KZN+NWH+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN+5NWH, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 4KTN+322<=KTO+4KZN+4NWH,
C    7KZN+KZY+7NWH<=7KTN+MEMSIZ+1, 7KTN+2<=7KZN+KZY+6NWH,
C    KTN+NW<=KZN+MEMSIZ+NWH, 7KTN+NW<=7KZN+MEMSIZ+7NWH, KZN+NWH<=KTN,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWH+1<=KZX, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               KZN = KZN+NWH                                            0803

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPY+5KZN+LPN==KPN+5KTN+1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+NWH<=KZN,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+1<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

530            CONTINUE                                                 0804

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            CALL IN(A, LZX, NW)                                         0805

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, LZX+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL CSR(A, EX)                                             0806

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, LZX+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(A, LZX, NW)                                        0807

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, LZX+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL IN(A, LZY, NW)                                         0808

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, LZX+NW<=MEMSIZ+1,
C    1<=LZY, LZY+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL CSR(A, EX)                                             0809

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, LZX+NW<=MEMSIZ+1,
C    1<=LZY, LZY+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(A, LZY, NW)                                        0810

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPY+5KZN+LPN==KPN+5KTN+1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPY+5KZN<=KPN+5KTN, KPN+5KTN+NW<=KPY+5KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, LZX+NW<=MEMSIZ+1,
C    1<=LZY, LZY+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KPN = LPN                                                   0811

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=KPN,
C    KPN+KPY+5KZN<=5KTN+MEMSIZ+2, 5KTN+NWQ+2<=KPN+KPY+5KZN,
C    KPN+NW<=MEMSIZ+1, KPY+KTN<=KZN+MEMSIZ+1, KPY+2KTN<=2KZN+MEMSIZ+1,
C    2KZN+NWQ+1<=KPY+2KTN, KZN+NWQ+1<=KPY+KTN, 5KTN+NWQ+4<=KPY+5KZN,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, LZX+NW<=MEMSIZ+1,
C    1<=LZY, LZY+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KPY = LPY                                                   0812

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY==LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 5KZN+KZX==6KTN, KZN+LTN==KTN+1,
C    6KZN+LZX==6KTN+1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=KPN,
C    5KTN+NWQ+1<=KPN+5KZN+MEMSIZ, 6KTN+NWQ+1<=KPN+6KZN+MEMSIZ,
C    7KTN+NWQ+1<=KPN+7KZN+MEMSIZ, KPN+7KZN+NWQ<=7KTN+MEMSIZ+1,
C    KPN+6KZN+NWQ<=6KTN+MEMSIZ+1, KPN+5KZN+NWQ<=5KTN+MEMSIZ+1,
C    KPN+NW<=MEMSIZ+1, KPN+NWQ+2<=MEMSIZ, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWH+1<=KZX, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    LH<=LEV, 1<=LH, LZX+NW<=MEMSIZ+1, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KZX = LZX                                                   0813

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY==LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    7KZN+KZY+LZO==7KTN+KZO+1, 6KZN+KZX==6KTN+1, KZN+LTN==KTN+1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX==LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=KPN,
C    5KTN+NWQ+1<=KPN+5KZN+MEMSIZ, 6KTN+NWQ+1<=KPN+6KZN+MEMSIZ,
C    7KTN+NWQ+1<=KPN+7KZN+MEMSIZ, KPN+7KZN+NWQ<=7KTN+MEMSIZ+1,
C    KPN+6KZN+NWQ<=6KTN+MEMSIZ+1, KPN+5KZN+NWQ<=5KTN+MEMSIZ+1,
C    KPN+NW<=MEMSIZ+1, KPN+NWQ+2<=MEMSIZ, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KZN+KZY<=7KTN+MEMSIZ+1, 7KTN+NWH+2<=7KZN+KZY,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+NW<=MEMSIZ+1, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

            KZY = LZY                                                   0814

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY==LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX==6KTN+1, KZN+LTN==KTN+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX==LZX, KZY==LZY, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=KPN, 5KTN+NWQ+1<=KPN+5KZN+MEMSIZ,
C    6KTN+NWQ+1<=KPN+6KZN+MEMSIZ, 7KTN+NWQ+1<=KPN+7KZN+MEMSIZ,
C    KPN+7KZN+NWQ<=7KTN+MEMSIZ+1, KPN+6KZN+NWQ<=6KTN+MEMSIZ+1,
C    KPN+5KZN+NWQ<=5KTN+MEMSIZ+1, KPN+NW<=MEMSIZ+1, KPN+NWQ+2<=MEMSIZ,
C    4KTN+322<=KTO+4KZN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ,
C    KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, 5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+NW<=MEMSIZ+1, 1<=KZY, KZY+NW<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

C
C IN PHYSICAL SPACE - FIND  (U,V).GRAD(T):
C
            DO 560 K = 1, 4                                             0818

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249, KPRESS==1,
C    KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY<=KZY+1,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    4KTN+322<=KTO+4KZN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ,
C    KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, 5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+NW<=KZY+MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(A, KPY, NWQ)                                     0819

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249, KPRESS==1,
C    KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY<=KZY+1,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN, KZN<=KTN,
C    7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LZY+NW<=KZY+MEMSIZ+1, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               CALL IN(A(1,K1Q), KPN, NWQ)                              0820

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249, KPRESS==1,
C    KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY<=KZY+1, 1<=KPN,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LZY+NW<=KZY+MEMSIZ+1, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               CALL IN(A(1,K2Q), KZY, NWQ)                              0821

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249, KPRESS==1,
C    KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY<=KZY+1, 1<=KPN,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LZY+NW<=KZY+MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(A(1,K3Q), KZX, NWQ)                              0822

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249, KPRESS==1,
C    KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY<=KZY+1, 1<=KPN,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

               DO 570 I = 1, N2PD                                       0823

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249, KPRESS==1,
C    KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=K, K<=4, K+LZY<=KZY+1,
C    1<=KPN, 5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

                  IPH = (I+1)/2                                         0824

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249, KPRESS==1,
C    KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=K,
C    K<=4, K+LZY<=KZY+1, 1<=KPN, 5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

                  GG = G(IPH)                                           0825

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249, KPRESS==1,
C    KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=K,
C    K<=4, K+LZY<=KZY+1, 1<=KPN, 5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

                  DO 580 J = 1, N1E                                     0826

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249, KPRESS==1,
C    KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=J,
C    J<=16, 1<=K, K<=4, K+LZY<=KZY+1, 1<=KPN,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

                     A(I,J) = A(I,J)*A(I,K3QM+J)-A(I,K1QM+J)*A(I,K2QM   0827
     &               +J)*GG                                             0827

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249, KPRESS==1,
C    KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=J,
C    J<=16, 1<=K, K<=4, K+LZY<=KZY+1, 1<=KPN,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

580                  CONTINUE                                           0829

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==17,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249,
C    KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 2IPH<=I+1, I<=2IPH, 1<=K,
C    K<=4, K+LZY<=KZY+1, 1<=KPN, 5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

570               CONTINUE                                              0830

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249,
C    KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY<=KZY+1, 1<=KPN,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

               CALL OUT(A, KZY, NWQ)                                    0831

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249,
C    KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY<=KZY+1, 1<=KPN,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

               KPN = KPN+NWQ                                            0832

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZY+LPN+NWQ==KPN+LZY,
C    KPP==249, KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, 6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY<=KZY+1,
C    KPN+7KZN+LZY<=7KTN+KZY+MEMSIZ+1, KPN+6KZN+LZY<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY<=5KTN+KZY+MEMSIZ+1,
C    5KTN+KZY+2NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+2NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+2NWQ+1<=KPN+7KZN+LZY+MEMSIZ, KPN+LZY+2<=KZY+MEMSIZ,
C    KPN+LZY+NW<=KZY+MEMSIZ+NWQ+1, KZY+NWQ+1<=KPN+LZY, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, 1<=KPY, KPY+NWQ<=MEMSIZ+1, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

               KPY = KPY+NWQ                                            0833

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZY+LPN+NWQ==KPN+LZY,
C    KPP==249, KPRESS==1, KZY+LPY+NWQ==KPY+LZY, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY<=KZY+1,
C    KPN+7KZN+LZY<=7KTN+KZY+MEMSIZ+1, KPN+6KZN+LZY<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY<=5KTN+KZY+MEMSIZ+1,
C    5KTN+KZY+2NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+2NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+2NWQ+1<=KPN+7KZN+LZY+MEMSIZ, KPN+LZY+2<=KZY+MEMSIZ,
C    KPN+LZY+NW<=KZY+MEMSIZ+NWQ+1, KZY+NWQ+1<=KPN+LZY, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=KZX, KZX+LZY+NW<=KZY+MEMSIZ+1,
C    KZX+NWQ<=MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

               KZX = KZX+NWQ                                            0834

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZY+LPN+NWQ==KPN+LZY,
C    KPP==249, KPRESS==1, KZY+LPY+NWQ==KPY+LZY, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 6KTN+KZY+NWQ==6KZN+KZX+LZY-1, KZN+LTN==KTN+1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZY+LZX+NWQ==KZX+LZY, LE==1, LMAPP==1, LSKIP==2, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY<=KZY+1,
C    KPN+7KZN+LZY<=7KTN+KZY+MEMSIZ+1, KPN+6KZN+LZY<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY<=5KTN+KZY+MEMSIZ+1,
C    5KTN+KZY+2NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+2NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+2NWQ+1<=KPN+7KZN+LZY+MEMSIZ, KPN+LZY+2<=KZY+MEMSIZ,
C    KPN+LZY+NW<=KZY+MEMSIZ+NWQ+1, KZY+NWQ+1<=KPN+LZY, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 4KTN+322<=KTO+4KZN,
C    KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LZY+NW<=KZY+MEMSIZ+NWQ+1,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               KZY = KZY+NWQ                                            0835

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN, KPP==249,
C    KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZY+NWQ<=KZY+1,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4KTN+322<=KTO+4KZN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ,
C    KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, 5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+NW<=KZY+MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

560            CONTINUE                                                 0836

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN,
C    KPP==249, KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, 6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4KTN+322<=KTO+4KZN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ,
C    KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, 5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+NW<=KZY+MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWQ+3<=KZY, KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

            ISIGN = -1                                                  0837

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN,
C    KPP==249, KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, 6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4KTN+322<=KTO+4KZN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ,
C    KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, 5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+NW<=KZY+MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWQ+3<=KZY, KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

            CALL IN(A, LZY, NW)                                         0838

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN,
C    KPP==249, KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, 6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4KTN+322<=KTO+4KZN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ,
C    KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, 5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+NW<=KZY+MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWQ+3<=KZY, KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

            CALL RCS(A, EX)                                             0839

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN,
C    KPP==249, KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, 6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4KTN+322<=KTO+4KZN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ,
C    KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, 5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+NW<=KZY+MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWQ+3<=KZY, KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

            CALL OUT(A, LZY, NW)                                        0840

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN,
C    KPP==249, KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, 6KZN+KZX+LZY==6KTN+KZY+1, KZN+LTN==KTN+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2,
C    5KTN+KZY+NWQ+1<=KPN+5KZN+LZY+MEMSIZ,
C    6KTN+KZY+NWQ+1<=KPN+6KZN+LZY+MEMSIZ,
C    7KTN+KZY+NWQ+1<=KPN+7KZN+LZY+MEMSIZ,
C    KPN+7KZN+LZY+NWQ<=7KTN+KZY+MEMSIZ+1,
C    KPN+6KZN+LZY+NWQ<=6KTN+KZY+MEMSIZ+1,
C    KPN+5KZN+LZY+NWQ<=5KTN+KZY+MEMSIZ+1, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    4KTN+322<=KTO+4KZN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KTN<=5KZN+MEMSIZ+1, KTN+NW<=KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ,
C    KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, 5KZN+NWH+1<=6KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+NW<=KZY+MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWQ+3<=KZY, KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

            KTN = LTN                                                   0841

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN,
C    KPP==249, KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, 6KTN+KZY==KZX+LZY+5, KTN==LTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 5KTN+KZY+NWQ<=KPN+LZY+MEMSIZ+4,
C    6KTN+KZY+NWQ<=KPN+LZY+MEMSIZ+5, 7KTN+KZY+NWQ<=KPN+LZY+MEMSIZ+6,
C    KPN+LZY+NWQ+6<=7KTN+KZY+MEMSIZ, KPN+LZY+NWQ+5<=6KTN+KZY+MEMSIZ,
C    KPN+LZY+NWQ+4<=5KTN+KZY+MEMSIZ, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN,
C    4KTN+318<=KTO, KTN+KZN<=MEMSIZ+2, 6KTN+KZN<=MEMSIZ+7,
C    NWH+7<=6KTN+KZN, NWH+2<=KTN+KZN, 7KTN+KZO<=LZO+MEMSIZ+7,
C    LZO+NWH+7<=7KTN+KZO, KTN+NW<=MEMSIZ+1, 7KTN+NW<=MEMSIZ+7,
C    NWQ+2<=2KTN+MEMSIZ, NWQ+1<=KTN+MEMSIZ, KTN+NWQ<=MEMSIZ+1,
C    2KTN+NWQ<=MEMSIZ+2, 5KTN+NWQ<=MEMSIZ+2, 6KTN+NWQ<=MEMSIZ+3,
C    7KTN+NWQ<=MEMSIZ+4, KTO<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+NW<=KZY+MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWQ+3<=KZY, KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

            KTO = LTO                                                   0842

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+LZY==KZY+LPN,
C    KPP==249, KPRESS==1, KPY+LZY==KZY+LPY, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, 6KTN+KZY==KZX+LZY+5, KTN==LTN, KTO==LTO, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 5KTN+KZY+NWQ<=KPN+LZY+MEMSIZ+4,
C    6KTN+KZY+NWQ<=KPN+LZY+MEMSIZ+5, 7KTN+KZY+NWQ<=KPN+LZY+MEMSIZ+6,
C    KPN+LZY+NWQ+6<=7KTN+KZY+MEMSIZ, KPN+LZY+NWQ+5<=6KTN+KZY+MEMSIZ,
C    KPN+LZY+NWQ+4<=5KTN+KZY+MEMSIZ, KZY+1<=KPN+LZY,
C    KPN+LZY+NW<=KZY+MEMSIZ+1, KPN+LZY+NWQ+2<=KZY+MEMSIZ,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN,
C    KTN+KZN<=MEMSIZ+2, 6KTN+KZN<=MEMSIZ+7, NWH+7<=6KTN+KZN,
C    NWH+2<=KTN+KZN, 7KTN+KZO<=LZO+MEMSIZ+7, LZO+NWH+7<=7KTN+KZO,
C    4KTN+317<=MEMSIZ, KTN+NW<=MEMSIZ+1, 7KTN+NW<=MEMSIZ+7,
C    NWQ+2<=2KTN+MEMSIZ, NWQ+1<=KTN+MEMSIZ, KTN+NWQ<=MEMSIZ+1,
C    2KTN+NWQ<=MEMSIZ+2, 5KTN+NWQ<=MEMSIZ+2, 6KTN+NWQ<=MEMSIZ+3,
C    7KTN+NWQ<=MEMSIZ+4, KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+NW<=KZY+MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWQ+3<=KZY, KZY<=MEMSIZ+1, NWQ+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

            KZY = LZY                                                   0843

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6KTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+6KTN==KZX+LPY+5,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTN==LTN, 6KTN==LZX+5,
C    KTO==LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZY==LZY, LE==1, LMAPP==1, LSKIP==2, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6KTN,
C    KPN+6KTN+NW<=KZX+MEMSIZ+6, KZX+NWQ+1<=KPN+KTN+MEMSIZ,
C    KTN+KZX+NWQ<=KPN+MEMSIZ+1, KPN+NWQ+1<=KTN+KZX+MEMSIZ,
C    KPN+KTN+NWQ<=KZX+MEMSIZ+1, KPN+6KTN+NWQ<=KZX+MEMSIZ+3,
C    KZX+NWQ<=KPN+MEMSIZ, KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, KTN+KZN<=MEMSIZ+2,
C    6KTN+KZN<=MEMSIZ+7, NWH+7<=6KTN+KZN, NWH+2<=KTN+KZN,
C    7KTN+KZO<=LZO+MEMSIZ+7, LZO+NWH+7<=7KTN+KZO,
C    KZX+KZY+4<=6KTN+MEMSIZ, 6KTN+NWQ<=KZX+KZY+4, 6KTN+NWQ<=KZX+2,
C    4KTN+317<=MEMSIZ, KTN+NW<=MEMSIZ+1, 6KTN+NW<=MEMSIZ+6,
C    7KTN+NW<=MEMSIZ+7, NWQ+2<=2KTN+MEMSIZ, NWQ+1<=KTN+MEMSIZ,
C    KTN+NWQ<=MEMSIZ+1, 2KTN+NWQ<=MEMSIZ+2, 5KTN+NWQ<=MEMSIZ+2,
C    6KTN+NWQ<=MEMSIZ+3, 7KTN+NWQ<=MEMSIZ+4, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NW<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            DO 590 K = 1, 2                                             0844

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249,
C    KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+LZY<=KZY+1,
C    KZX+6KZY+6<=KPN+6KTN+6LZY, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               CALL IN(CA, KTO, NWH)                                    0845

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249,
C    KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+LZY<=KZY+1,
C    KZX+6KZY+6<=KPN+6KTN+6LZY, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(A(1,K2Q), KTN, NWH)                              0846

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249,
C    KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+LZY<=KZY+1,
C    KZX+6KZY+6<=KPN+6KTN+6LZY, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               DO 600 J = K2Q, N1H                                      0847

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249,
C    KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 33<=J, J<=64, 1<=K, K<=2,
C    K+LZY<=KZY+1, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  DO 610 I = 1, N2PD                                    0848

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249,
C    KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=258, 33<=J, J<=64,
C    1<=K, K<=2, K+LZY<=KZY+1, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                     A(I,J) = 0.5*A(I,J)                                0849

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249,
C    KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=258, 33<=J, J<=64,
C    1<=K, K<=2, K+LZY<=KZY+1, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

610                  CONTINUE                                           0850

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5,
C    KPP==249, KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+LZY==KZY+LTN,
C    6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    33<=J, J<=64, 1<=K, K<=2, K+LZY<=KZY+1,
C    KZX+6KZY+6<=KPN+6KTN+6LZY, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

600               CONTINUE                                              0851

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5,
C    KPP==249, KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+LZY==KZY+LTN,
C    6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=2, K+LZY<=KZY+1, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL OUT(A(1,K2Q), KTO, NWH)                             0852

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5,
C    KPP==249, KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+LZY==KZY+LTN,
C    6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=2, K+LZY<=KZY+1, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(CA(1,K2Q), KZY, NWH)                             0853

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5,
C    KPP==249, KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+LZY==KZY+LTN,
C    6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=2, K+LZY<=KZY+1, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               DO 620 J = 1, N1Q                                        0854

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249,
C    KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2,
C    K+LZY<=KZY+1, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  K2QJ = J+K2QM                                         0855

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5,
C    KPP==249, KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+LZY==KZY+LTN,
C    6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=J, J<=32, 1<=K, K<=2, K+LZY<=KZY+1, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  DO 630 I = 1, N2P                                     0856

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5,
C    KPP==249, KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+LZY==KZY+LTN,
C    6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2, K+LZY<=KZY+1,
C    KZX+6KZY+6<=KPN+6KTN+6LZY, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                     CA(I,J) = CA(I,J)+DTFAC*CA(I,K2QJ)                 0857

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6KTN+6LZY==KZX+6KZY+LPN+5,
C    KPP==249, KPRESS==1, KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+LZY==KZY+LTN,
C    6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2, K+LZY<=KZY+1,
C    KZX+6KZY+6<=KPN+6KTN+6LZY, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

630                  CONTINUE                                           0858

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249, KPRESS==1,
C    KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+LZY<=KZY+1,
C    KZX+6KZY+6<=KPN+6KTN+6LZY, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

620               CONTINUE                                              0859

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249, KPRESS==1,
C    KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+LZY<=KZY+1,
C    KZX+6KZY+6<=KPN+6KTN+6LZY, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL OUT(CA, KTN, NWH)                                   0860

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249, KPRESS==1,
C    KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+LZY<=KZY+1,
C    KZX+6KZY+6<=KPN+6KTN+6LZY, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN+NWH<=MEMSIZ+1, 1<=KTO, KTO+NWH<=MEMSIZ+1, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=MEMSIZ+1,
C    LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               KTN = KTN+NWH                                            0861

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KZX+6KZY+LPN+6NWH==KPN+6KTN+6LZY-5, KPP==249, KPRESS==1,
C    KZX+6KZY+LPY+6NWH==KPY+6KTN+6LZY-5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZY+LTN+NWH==KTN+LZY, 6KZY+LZX+6NWH==6KTN+6LZY-5,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+LZY<=KZY+1,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6NWH+6,
C    KZX+KZY+NWH+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+NWH+1,
C    KPN+KZY+NWH+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+NWH+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+6NWH+3,
C    KZX+6KZY+6NWH+6<=KPN+6KTN+6LZY, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN+KZN+LZY<=KZY+MEMSIZ+NWH+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+6NWH+7, 6KZY+7NWH+7<=6KTN+KZN+6LZY,
C    KZY+2NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7NWH+7,
C    7KZY+LZO+8NWH+7<=7KTN+KZO+7LZY,
C    KZX+6KZY+6NWH+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+6NWH+4, 6KTN+6LZY+NWQ<=KZX+6KZY+6NWH+2,
C    KTN+LZY+NW<=KZY+MEMSIZ+NWH+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6NWH+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7NWH+7,
C    4KTN+4LZY+317<=4KZY+MEMSIZ+4NWH,
C    2KZY+2NWH+NWQ+2<=2KTN+2LZY+MEMSIZ, KZY+NWH+NWQ+1<=KTN+LZY+MEMSIZ,
C    KTN+LZY+NWQ<=KZY+MEMSIZ+NWH+1, 2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2NWH+2,
C    5KTN+5LZY+NWQ<=5KZY+MEMSIZ+5NWH+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+6NWH+3,
C    7KTN+7LZY+NWQ<=7KZY+MEMSIZ+7NWH+4, KZY+NWH+1<=KTN+LZY,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, 1<=KTO, KTO+NWH<=MEMSIZ+1,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               KTO = KTO+NWH                                            0862

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KZX+6KZY+LPN+6NWH==KPN+6KTN+6LZY-5, KPP==249, KPRESS==1,
C    KZX+6KZY+LPY+6NWH==KPY+6KTN+6LZY-5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZY+LTN+NWH==KTN+LZY, 6KZY+LZX+6NWH==6KTN+6LZY-5,
C    KZY+LTO+NWH==KTO+LZY, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K+LZY<=KZY+1, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6NWH+6,
C    KZX+KZY+NWH+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+NWH+1,
C    KPN+KZY+NWH+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+NWH+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+6NWH+3,
C    KZX+6KZY+6NWH+6<=KPN+6KTN+6LZY, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN+KZN+LZY<=KZY+MEMSIZ+NWH+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+6NWH+7, 6KZY+7NWH+7<=6KTN+KZN+6LZY,
C    KZY+2NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7NWH+7,
C    7KZY+LZO+8NWH+7<=7KTN+KZO+7LZY,
C    KZX+6KZY+6NWH+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+6NWH+4, 6KTN+6LZY+NWQ<=KZX+6KZY+6NWH+2,
C    KTN+LZY+NW<=KZY+MEMSIZ+NWH+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6NWH+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7NWH+7,
C    4KTN+4LZY+317<=4KZY+MEMSIZ+4NWH,
C    2KZY+2NWH+NWQ+2<=2KTN+2LZY+MEMSIZ, KZY+NWH+NWQ+1<=KTN+LZY+MEMSIZ,
C    KTN+LZY+NWQ<=KZY+MEMSIZ+NWH+1, 2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2NWH+2,
C    5KTN+5LZY+NWQ<=5KZY+MEMSIZ+5NWH+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+6NWH+3,
C    7KTN+7LZY+NWQ<=7KZY+MEMSIZ+7NWH+4, KZY+NWH+1<=KTN+LZY,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=MEMSIZ+1, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               KZY = KZY+NWH                                            0863

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249, KPRESS==1,
C    KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+LZY+NWH<=KZY+1,
C    KZX+6KZY+6<=KPN+6KTN+6LZY, KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

590            CONTINUE                                                 0864
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249, KPRESS==1,
C    KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}


         DTF = 0.25*DTT*FX                                              0867

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249, KPRESS==1,
C    KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

         F = -DTF                                                       0868

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249, KPRESS==1,
C    KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN+KZN+LZY<=KZY+MEMSIZ+2,
C    6KTN+KZN+6LZY<=6KZY+MEMSIZ+7, 6KZY+NWH+7<=6KTN+KZN+6LZY,
C    KZY+NWH+2<=KTN+KZN+LZY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH,
C    1<=NWQ}

         KZN = LZN                                                      0869

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6KTN+6LZY==KZX+6KZY+LPN+5, KPP==249, KPRESS==1,
C    KPY+6KTN+6LZY==KZX+6KZY+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+LZY==KZY+LTN, 6KTN+6LZY==6KZY+LZX+5, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6KZY+6<=KPN+6KTN+6LZY,
C    KPN+6KTN+6LZY+NW<=KZX+6KZY+MEMSIZ+6,
C    KZX+KZY+NWQ+1<=KPN+KTN+LZY+MEMSIZ,
C    KTN+KZX+LZY+NWQ<=KPN+KZY+MEMSIZ+1,
C    KPN+KZY+NWQ+1<=KTN+KZX+LZY+MEMSIZ,
C    KPN+KTN+LZY+NWQ<=KZX+KZY+MEMSIZ+1,
C    KPN+6KTN+6LZY+NWQ<=KZX+6KZY+MEMSIZ+3, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 7KTN+KZO+7LZY<=7KZY+LZO+MEMSIZ+7,
C    7KZY+LZO+NWH+7<=7KTN+KZO+7LZY, KZX+6KZY+4<=6KTN+5LZY+MEMSIZ,
C    6KTN+5LZY+NWQ<=KZX+6KZY+4, 6KTN+6LZY+NWQ<=KZX+6KZY+2,
C    KZY+1<=KTN+LZY, 4KTN+4LZY+317<=4KZY+MEMSIZ,
C    KTN+LZY+NW<=KZY+MEMSIZ+1, 6KTN+6LZY+NW<=6KZY+MEMSIZ+6,
C    7KTN+7LZY+NW<=7KZY+MEMSIZ+7, 6KZY+NWH+6<=6KTN+6LZY+MEMSIZ,
C    5KZY+NWH+5<=5KTN+5LZY+MEMSIZ, KZY+NWH+1<=KTN+LZY+MEMSIZ,
C    KTN+LZY+NWH<=KZY+MEMSIZ, 5KTN+5LZY+NWH<=5KZY+MEMSIZ+5,
C    6KTN+6LZY+NWH<=6KZY+MEMSIZ+5, 2KZY+NWQ+2<=2KTN+2LZY+MEMSIZ,
C    KZY+NWQ+1<=KTN+LZY+MEMSIZ, KTN+LZY+NWQ<=KZY+MEMSIZ+1,
C    2KTN+2LZY+NWQ<=2KZY+MEMSIZ+2, 5KTN+5LZY+NWQ<=5KZY+MEMSIZ+2,
C    6KTN+6LZY+NWQ<=6KZY+MEMSIZ+3, 7KTN+7LZY+NWQ<=7KZY+MEMSIZ+4,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         KTN = LTN                                                      0870

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6KTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+6KTN==KZX+LPY+5,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTN==LTN, 6KTN==LZX+5,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KZX+6<=KPN+6KTN,
C    KPN+6KTN+NW<=KZX+MEMSIZ+6, KZX+NWQ+1<=KPN+KTN+MEMSIZ,
C    KTN+KZX+NWQ<=KPN+MEMSIZ+1, KPN+NWQ+1<=KTN+KZX+MEMSIZ,
C    KPN+KTN+NWQ<=KZX+MEMSIZ+1, KPN+6KTN+NWQ<=KZX+MEMSIZ+3,
C    KZX+NWQ<=KPN+MEMSIZ, KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN,
C    7KTN+KZO<=LZO+MEMSIZ+7, LZO+NWH+7<=7KTN+KZO,
C    KZX+LZY+4<=6KTN+MEMSIZ, 6KTN+NWQ<=KZX+LZY+4, 6KTN+NWQ<=KZX+2,
C    KTN+KZY<=LZY+MEMSIZ+1, LZY+NWH+1<=KTN+KZY, 4KTN+317<=MEMSIZ,
C    KTN+NW<=MEMSIZ+1, 6KTN+NW<=MEMSIZ+6, 7KTN+NW<=MEMSIZ+7,
C    NWH+6<=6KTN+MEMSIZ, NWH+5<=5KTN+MEMSIZ, NWH+1<=KTN+MEMSIZ,
C    KTN+NWH<=MEMSIZ, 5KTN+NWH<=MEMSIZ+5, 6KTN+NWH<=MEMSIZ+5,
C    NWQ+2<=2KTN+MEMSIZ, NWQ+1<=KTN+MEMSIZ, KTN+NWQ<=MEMSIZ+1,
C    2KTN+NWQ<=MEMSIZ+2, 5KTN+NWQ<=MEMSIZ+2, 6KTN+NWQ<=MEMSIZ+3,
C    7KTN+NWQ<=MEMSIZ+4, KTO<=MEMSIZ+1, NWH+1<=KTO, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         DO 640 K = 1, 2                                                0871

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, 6KZN+KZX<=KPN+6KTN,
C    KPN+6KTN+NW<=6KZN+KZX+MEMSIZ, KZN+KZX+NWQ<=KPN+KTN+MEMSIZ,
C    KTN+KZX+NWQ<=KPN+KZN+MEMSIZ, KPN+KZN+NWQ<=KTN+KZX+MEMSIZ,
C    KPN+KTN+NWQ<=KZN+KZX+MEMSIZ, KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ,
C    KZX+NWQ<=KPN+MEMSIZ, KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, KZN<=KTN,
C    7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KZN+KZX+LZY<=6KTN+MEMSIZ+2, 6KTN+NWQ+2<=6KZN+KZX+LZY,
C    6KTN+NWQ+4<=6KZN+KZX, KTN+KZY<=KZN+LZY+MEMSIZ,
C    KZN+LZY+NWH<=KTN+KZY, 4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ,
C    6KTN+NW<=6KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    6KZN+NWH<=6KTN+MEMSIZ, 5KZN+NWH<=5KTN+MEMSIZ,
C    KZN+NWH<=KTN+MEMSIZ, KTN+NWH+1<=KZN+MEMSIZ,
C    5KTN+NWH<=5KZN+MEMSIZ, 6KTN+NWH+1<=6KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            IF (NOTEMP.NE.1) CALL IN(CA, KTN, NWH)                      0872

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, 6KZN+KZX<=KPN+6KTN,
C    KPN+6KTN+NW<=6KZN+KZX+MEMSIZ, KZN+KZX+NWQ<=KPN+KTN+MEMSIZ,
C    KTN+KZX+NWQ<=KPN+KZN+MEMSIZ, KPN+KZN+NWQ<=KTN+KZX+MEMSIZ,
C    KPN+KTN+NWQ<=KZN+KZX+MEMSIZ, KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ,
C    KZX+NWQ<=KPN+MEMSIZ, KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, KZN<=KTN,
C    7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KZN+KZX+LZY<=6KTN+MEMSIZ+2, 6KTN+NWQ+2<=6KZN+KZX+LZY,
C    6KTN+NWQ+4<=6KZN+KZX, KTN+KZY<=KZN+LZY+MEMSIZ,
C    KZN+LZY+NWH<=KTN+KZY, 4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ,
C    6KTN+NW<=6KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    6KZN+NWH<=6KTN+MEMSIZ, 5KZN+NWH<=5KTN+MEMSIZ,
C    KZN+NWH<=KTN+MEMSIZ, KTN+NWH+1<=KZN+MEMSIZ,
C    5KTN+NWH<=5KZN+MEMSIZ, 6KTN+NWH+1<=6KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1, NWH+1<=KTO, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL IN(CA(1,K2Q), KZN, NWH)                                0873

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, 6KZN+KZX<=KPN+6KTN,
C    KPN+6KTN+NW<=6KZN+KZX+MEMSIZ, KZN+KZX+NWQ<=KPN+KTN+MEMSIZ,
C    KTN+KZX+NWQ<=KPN+KZN+MEMSIZ, KPN+KZN+NWQ<=KTN+KZX+MEMSIZ,
C    KPN+KTN+NWQ<=KZN+KZX+MEMSIZ, KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ,
C    KZX+NWQ<=KPN+MEMSIZ, KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, KZN<=KTN,
C    7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KZN+KZX+LZY<=6KTN+MEMSIZ+2, 6KTN+NWQ+2<=6KZN+KZX+LZY,
C    6KTN+NWQ+4<=6KZN+KZX, KTN+KZY<=KZN+LZY+MEMSIZ,
C    KZN+LZY+NWH<=KTN+KZY, 4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ,
C    6KTN+NW<=6KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    6KZN+NWH<=6KTN+MEMSIZ, 5KZN+NWH<=5KTN+MEMSIZ,
C    KZN+NWH<=KTN+MEMSIZ, KTN+NWH+1<=KZN+MEMSIZ,
C    5KTN+NWH<=5KZN+MEMSIZ, 6KTN+NWH+1<=6KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ,
C    KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV, 1<=LH,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    1<=NW, 1<=NWH, 1<=NWQ}

            DO 650 J = 1, N1Q                                           0874

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K<=KZN,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               K2QJ = J+K2QM                                            0875

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K<=KZN,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               F = F+DTF                                                0876

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K<=KZN,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               IF (NOTEMP.NE.1) THEN                                    0877

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K<=KZN,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  DO 660 I = 1, N2P                                     0878

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                     WORK(I) = F*U(I)                                   0879

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                     CA(I,J) = CMPLX(1.0, -WORK(I))*CA(I,J)/(1.0+WORK   0880
     &               (I)*WORK(I))                                       0880

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

660                  CONTINUE                                           0882
               ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1,
C    KPP==249, KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}


               DO 670 I = 1, N2P                                        0885

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  WORK(I) = F*U(I)                                      0886

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

                  CA(I,K2QJ) = CMPLX(1.0, -WORK(I))*CA(I,K2QJ)/(1.0+    0887
     &            WORK(I)*WORK(I))                                      0887

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

670               CONTINUE                                              0889

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1,
C    KPP==249, KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

650            CONTINUE                                                 0890

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1,
C    KPP==249, KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            IF (NOTEMP.NE.1) CALL OUT(CA, KTN, NWH)                     0891

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1,
C    KPP==249, KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(CA(1,K2Q), KZN, NWH)                               0892

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1,
C    KPP==249, KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 1<=KTN, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN+NWH<=MEMSIZ+1, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY, LH<=LEV,
C    1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KTN = KTN+NWH                                               0893

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN+6NWH==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY+6NWH==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN+NWH==KTN+1, 6KZN+LZX+6NWH==6KTN+1, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    KPN+6KTN+NW<=6KZN+KZX+MEMSIZ+6NWH,
C    KZN+KZX+NWH+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ+NWH,
C    KPN+KZN+NWH+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ+NWH,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ+6NWH, 6KZN+KZX+6NWH<=KPN+6KTN,
C    KZX+NWQ<=KPN+MEMSIZ, KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    7KTN+KZO<=7KZN+LZO+MEMSIZ+7NWH, 7KZN+LZO+8NWH<=7KTN+KZO,
C    6KZN+KZX+LZY+6NWH<=6KTN+MEMSIZ+2, 6KTN+NWQ+2<=6KZN+KZX+LZY+6NWH,
C    6KTN+NWQ+4<=6KZN+KZX+6NWH, KTN+KZY<=KZN+LZY+MEMSIZ+NWH,
C    KZN+LZY+2NWH<=KTN+KZY, KTN+1<=KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ+NWH,
C    6KTN+NW<=6KZN+MEMSIZ+6NWH, 7KTN+NW<=7KZN+MEMSIZ+7NWH,
C    6KZN+7NWH<=6KTN+MEMSIZ, 5KZN+6NWH<=5KTN+MEMSIZ,
C    KZN+2NWH<=KTN+MEMSIZ, 4KTN+321<=4KZN+MEMSIZ+4NWH,
C    5KTN<=5KZN+MEMSIZ+4NWH, 6KTN+1<=6KZN+MEMSIZ+5NWH,
C    2KZN+2NWH+NWQ<=2KTN+MEMSIZ, KZN+NWH+NWQ<=KTN+MEMSIZ,
C    KTN+NWQ<=KZN+MEMSIZ+NWH, 2KTN+NWQ<=2KZN+MEMSIZ+2NWH,
C    5KTN+NWQ+3<=5KZN+MEMSIZ+5NWH, 6KTN+NWQ+3<=6KZN+MEMSIZ+6NWH,
C    7KTN+NWQ+3<=7KZN+MEMSIZ+7NWH, KZN+NWH<=KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KZN = KZN+NWH                                               0894

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, 6KZN+KZX+LPN==KPN+6KTN+1,
C    KPP==249, KPRESS==1, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+NWH<=KZN,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+1<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

640         CONTINUE                                                    0895

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 6KZN+KZX<=KPN+6KTN,
C    KPN+6KTN+NW<=6KZN+KZX+MEMSIZ, KZN+KZX+NWQ<=KPN+KTN+MEMSIZ,
C    KTN+KZX+NWQ<=KPN+KZN+MEMSIZ, KPN+KZN+NWQ<=KTN+KZX+MEMSIZ,
C    KPN+KTN+NWQ<=KZN+KZX+MEMSIZ, KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ,
C    KZX+NWQ<=KPN+MEMSIZ, KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, KZN<=KTN,
C    7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KZN+KZX+LZY<=6KTN+MEMSIZ+2, 6KTN+NWQ+2<=6KZN+KZX+LZY,
C    6KTN+NWQ+4<=6KZN+KZX, KTN+KZY<=KZN+LZY+MEMSIZ,
C    KZN+LZY+NWH<=KTN+KZY, 4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ,
C    6KTN+NW<=6KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    6KZN+NWH<=6KTN+MEMSIZ, 5KZN+NWH<=5KTN+MEMSIZ,
C    KZN+NWH<=KTN+MEMSIZ, KTN+NWH+1<=KZN+MEMSIZ,
C    5KTN+NWH<=5KZN+MEMSIZ, 6KTN+NWH+1<=6KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         NPTS = 2*N2                                                    0896

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 6KZN+KZX<=KPN+6KTN,
C    KPN+6KTN+NW<=6KZN+KZX+MEMSIZ, KZN+KZX+NWQ<=KPN+KTN+MEMSIZ,
C    KTN+KZX+NWQ<=KPN+KZN+MEMSIZ, KPN+KZN+NWQ<=KTN+KZX+MEMSIZ,
C    KPN+KTN+NWQ<=KZN+KZX+MEMSIZ, KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ,
C    KZX+NWQ<=KPN+MEMSIZ, KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, KZN<=KTN,
C    7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KZN+KZX+LZY<=6KTN+MEMSIZ+2, 6KTN+NWQ+2<=6KZN+KZX+LZY,
C    6KTN+NWQ+4<=6KZN+KZX, KTN+KZY<=KZN+LZY+MEMSIZ,
C    KZN+LZY+NWH<=KTN+KZY, 4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ,
C    6KTN+NW<=6KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    6KZN+NWH<=6KTN+MEMSIZ, 5KZN+NWH<=5KTN+MEMSIZ,
C    KZN+NWH<=KTN+MEMSIZ, KTN+NWH+1<=KZN+MEMSIZ,
C    5KTN+NWH<=5KZN+MEMSIZ, 6KTN+NWH+1<=6KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         NSKIP = 1                                                      0897

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         MTRN = N1H                                                     0898

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         MSKIP = N2P                                                    0899

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         ISIGN = -1                                                     0900

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         IEXSHF = NMAX2/NPTS                                            0901

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         CALL XLOG2(NPTS, LOG)                                          0902

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         CALL IN(A, LZN, NW)                                            0903

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

         CALL ACAC(A, EX, WORK)                                         0904

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 255<=NPTS, NPTS<=256,
C    1<=NW, 1<=NWH, 1<=NWQ}

         CALL OUT(A, LZN, NW)                                           0905

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 255<=NPTS, NPTS<=256,
C    1<=NW, 1<=NWH, 1<=NWQ}

         IF (NOTEMP.NE.1) THEN                                          0906

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KZN<=KTN, 7KTN+KZO<=7KZN+LZO+MEMSIZ,
C    7KZN+LZO+NWH<=7KTN+KZO, 6KZN+KZX+LZY<=6KTN+MEMSIZ+2,
C    6KTN+NWQ+2<=6KZN+KZX+LZY, 6KTN+NWQ+4<=6KZN+KZX,
C    KTN+KZY<=KZN+LZY+MEMSIZ, KZN+LZY+NWH<=KTN+KZY,
C    4KTN+321<=4KZN+MEMSIZ, KTN+NW<=KZN+MEMSIZ, 6KTN+NW<=6KZN+MEMSIZ,
C    7KTN+NW<=7KZN+MEMSIZ, 6KZN+NWH<=6KTN+MEMSIZ,
C    5KZN+NWH<=5KTN+MEMSIZ, KZN+NWH<=KTN+MEMSIZ,
C    KTN+NWH+1<=KZN+MEMSIZ, 5KTN+NWH<=5KZN+MEMSIZ,
C    6KTN+NWH+1<=6KZN+MEMSIZ, 2KZN+NWQ<=2KTN+MEMSIZ,
C    KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ, 2KTN+NWQ<=2KZN+MEMSIZ,
C    5KTN+NWQ+3<=5KZN+MEMSIZ, 6KTN+NWQ+3<=6KZN+MEMSIZ,
C    7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 255<=NPTS, NPTS<=256,
C    1<=NW, 1<=NWH, 1<=NWQ}

            CALL IN(A, LTN, NW)                                         0907

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KZN+KZX+LZY<=6KTN+MEMSIZ+2, 6KTN+NWQ+2<=6KZN+KZX+LZY,
C    6KTN+NWQ+4<=6KZN+KZX, KTN+KZY<=KZN+LZY+MEMSIZ,
C    KZN+LZY+NWH<=KTN+KZY, 4KTN+321<=4KZN+MEMSIZ,
C    6KTN+NW<=6KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    6KZN+NWH<=6KTN+MEMSIZ, 5KZN+NWH<=5KTN+MEMSIZ,
C    KZN+NWH<=KTN+MEMSIZ, KTN+NWH+1<=KZN+MEMSIZ,
C    5KTN+NWH<=5KZN+MEMSIZ, 6KTN+NWH+1<=6KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN, LTN+NW<=MEMSIZ+1, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL ACAC(A, EX, WORK)                                      0908

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KZN+KZX+LZY<=6KTN+MEMSIZ+2, 6KTN+NWQ+2<=6KZN+KZX+LZY,
C    6KTN+NWQ+4<=6KZN+KZX, KTN+KZY<=KZN+LZY+MEMSIZ,
C    KZN+LZY+NWH<=KTN+KZY, 4KTN+321<=4KZN+MEMSIZ,
C    6KTN+NW<=6KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    6KZN+NWH<=6KTN+MEMSIZ, 5KZN+NWH<=5KTN+MEMSIZ,
C    KZN+NWH<=KTN+MEMSIZ, KTN+NWH+1<=KZN+MEMSIZ,
C    5KTN+NWH<=5KZN+MEMSIZ, 6KTN+NWH+1<=6KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN, LTN+NW<=MEMSIZ+1, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(A, LTN, NW)                                        0909
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KZN+LTN==KTN+1, 6KZN+LZX==6KTN+1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    6KZN+KZX<=KPN+6KTN, KPN+6KTN+NW<=6KZN+KZX+MEMSIZ,
C    KZN+KZX+NWQ<=KPN+KTN+MEMSIZ, KTN+KZX+NWQ<=KPN+KZN+MEMSIZ,
C    KPN+KZN+NWQ<=KTN+KZX+MEMSIZ, KPN+KTN+NWQ<=KZN+KZX+MEMSIZ,
C    KPN+6KTN+NWQ+3<=6KZN+KZX+MEMSIZ, KZX+NWQ<=KPN+MEMSIZ,
C    KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, 7KTN+KZO<=7KZN+LZO+MEMSIZ, 7KZN+LZO+NWH<=7KTN+KZO,
C    6KZN+KZX+LZY<=6KTN+MEMSIZ+2, 6KTN+NWQ+2<=6KZN+KZX+LZY,
C    6KTN+NWQ+4<=6KZN+KZX, KTN+KZY<=KZN+LZY+MEMSIZ,
C    KZN+LZY+NWH<=KTN+KZY, 4KTN+321<=4KZN+MEMSIZ,
C    6KTN+NW<=6KZN+MEMSIZ, 7KTN+NW<=7KZN+MEMSIZ,
C    6KZN+NWH<=6KTN+MEMSIZ, 5KZN+NWH<=5KTN+MEMSIZ,
C    KZN+NWH<=KTN+MEMSIZ, KTN+NWH+1<=KZN+MEMSIZ,
C    5KTN+NWH<=5KZN+MEMSIZ, 6KTN+NWH+1<=6KZN+MEMSIZ,
C    2KZN+NWQ<=2KTN+MEMSIZ, KZN+NWQ<=KTN+MEMSIZ, KTN+NWQ<=KZN+MEMSIZ,
C    2KTN+NWQ<=2KZN+MEMSIZ, 5KTN+NWQ+3<=5KZN+MEMSIZ,
C    6KTN+NWQ+3<=6KZN+MEMSIZ, 7KTN+NWQ+3<=7KZN+MEMSIZ, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1,
C    NWH+1<=KZY, LH<=LEV, 1<=LH, 1<=LTN, LTN+NW<=MEMSIZ+1, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}


         KZN = LZN                                                      0912

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZX+6<=KPN+6LTN,
C    KPN+6LTN+NW<=KZX+MEMSIZ+6, KZX+NWQ+1<=KPN+LTN+MEMSIZ,
C    KZX+LTN+NWQ<=KPN+MEMSIZ+1, KPN+NWQ+1<=KZX+LTN+MEMSIZ,
C    KPN+LTN+NWQ<=KZX+MEMSIZ+1, KPN+6LTN+NWQ<=KZX+MEMSIZ+3,
C    KZX+NWQ<=KPN+MEMSIZ, KPN+NWQ<=KZX+MEMSIZ, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ,
C    LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    LH<=LEV, 1<=LH, 1<=LTN, 4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ,
C    NWH+5<=5LTN+MEMSIZ, NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ,
C    5LTN+NWH<=MEMSIZ+5, 6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ,
C    NWQ+1<=LTN+MEMSIZ, LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2,
C    5LTN+NWQ<=MEMSIZ+2, 6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         KPN = LPN                                                      0913

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=KPN, KPN+KZX+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KPN+KZX+4,
C    5LTN+NWQ<=KPN+MEMSIZ+4, 6LTN+NWQ<=KPN+MEMSIZ+5,
C    7LTN+NWQ<=KPN+MEMSIZ+6, KPN+NWQ+6<=7LTN+MEMSIZ,
C    KPN+NWQ+5<=6LTN+MEMSIZ, KPN+NWQ+4<=5LTN+MEMSIZ, KPN+NW<=MEMSIZ+1,
C    KPN+NWQ+2<=MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ,
C    LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    LH<=LEV, 1<=LH, 1<=LTN, 4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ,
C    NWH+5<=5LTN+MEMSIZ, NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ,
C    5LTN+NWH<=MEMSIZ+5, 6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ,
C    NWQ+1<=LTN+MEMSIZ, LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2,
C    5LTN+NWQ<=MEMSIZ+2, 6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         F2 = 1./(4.*REAL(N2))                                          0914

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=KPN, KPN+KZX+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KPN+KZX+4,
C    5LTN+NWQ<=KPN+MEMSIZ+4, 6LTN+NWQ<=KPN+MEMSIZ+5,
C    7LTN+NWQ<=KPN+MEMSIZ+6, KPN+NWQ+6<=7LTN+MEMSIZ,
C    KPN+NWQ+5<=6LTN+MEMSIZ, KPN+NWQ+4<=5LTN+MEMSIZ, KPN+NW<=MEMSIZ+1,
C    KPN+NWQ+2<=MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ,
C    LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    LH<=LEV, 1<=LH, 1<=LTN, 4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ,
C    NWH+5<=5LTN+MEMSIZ, NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ,
C    5LTN+NWH<=MEMSIZ+5, 6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ,
C    NWQ+1<=LTN+MEMSIZ, LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2,
C    5LTN+NWQ<=MEMSIZ+2, 6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         F1 = RNU*DTT                                                   0915

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=KPN, KPN+KZX+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KPN+KZX+4,
C    5LTN+NWQ<=KPN+MEMSIZ+4, 6LTN+NWQ<=KPN+MEMSIZ+5,
C    7LTN+NWQ<=KPN+MEMSIZ+6, KPN+NWQ+6<=7LTN+MEMSIZ,
C    KPN+NWQ+5<=6LTN+MEMSIZ, KPN+NWQ+4<=5LTN+MEMSIZ, KPN+NW<=MEMSIZ+1,
C    KPN+NWQ+2<=MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ,
C    LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    LH<=LEV, 1<=LH, 1<=LTN, 4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ,
C    NWH+5<=5LTN+MEMSIZ, NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ,
C    5LTN+NWH<=MEMSIZ+5, 6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ,
C    NWQ+1<=LTN+MEMSIZ, LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2,
C    5LTN+NWQ<=MEMSIZ+2, 6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

C
C FIND PRESSURE NOW OR NEVER (IF REQUIRED...)
C
         CALL IN(EVAL, LEIG, NWEIG)                                     0919

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=KPN, KPN+KZX+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KPN+KZX+4,
C    5LTN+NWQ<=KPN+MEMSIZ+4, 6LTN+NWQ<=KPN+MEMSIZ+5,
C    7LTN+NWQ<=KPN+MEMSIZ+6, KPN+NWQ+6<=7LTN+MEMSIZ,
C    KPN+NWQ+5<=6LTN+MEMSIZ, KPN+NWQ+4<=5LTN+MEMSIZ, KPN+NW<=MEMSIZ+1,
C    KPN+NWQ+2<=MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ,
C    LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         LVECT = N2M                                                    0920

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=KPN, KPN+KZX+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KPN+KZX+4,
C    5LTN+NWQ<=KPN+MEMSIZ+4, 6LTN+NWQ<=KPN+MEMSIZ+5,
C    7LTN+NWQ<=KPN+MEMSIZ+6, KPN+NWQ+6<=7LTN+MEMSIZ,
C    KPN+NWQ+5<=6LTN+MEMSIZ, KPN+NWQ+4<=5LTN+MEMSIZ, KPN+NW<=MEMSIZ+1,
C    KPN+NWQ+2<=MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ,
C    LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         LSKIP = 2                                                      0921

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=KPN, KPN+KZX+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KPN+KZX+4,
C    5LTN+NWQ<=KPN+MEMSIZ+4, 6LTN+NWQ<=KPN+MEMSIZ+5,
C    7LTN+NWQ<=KPN+MEMSIZ+6, KPN+NWQ+6<=7LTN+MEMSIZ,
C    KPN+NWQ+5<=6LTN+MEMSIZ, KPN+NWQ+4<=5LTN+MEMSIZ, KPN+NW<=MEMSIZ+1,
C    KPN+NWQ+2<=MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ,
C    LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         NVECT = 2                                                      0922

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=KPN, KPN+KZX+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KPN+KZX+4,
C    5LTN+NWQ<=KPN+MEMSIZ+4, 6LTN+NWQ<=KPN+MEMSIZ+5,
C    7LTN+NWQ<=KPN+MEMSIZ+6, KPN+NWQ+6<=7LTN+MEMSIZ,
C    KPN+NWQ+5<=6LTN+MEMSIZ, KPN+NWQ+4<=5LTN+MEMSIZ, KPN+NW<=MEMSIZ+1,
C    KPN+NWQ+2<=MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ,
C    LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         NVSKIP = 1                                                     0923

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=KPN, KPN+KZX+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KPN+KZX+4,
C    5LTN+NWQ<=KPN+MEMSIZ+4, 6LTN+NWQ<=KPN+MEMSIZ+5,
C    7LTN+NWQ<=KPN+MEMSIZ+6, KPN+NWQ+6<=7LTN+MEMSIZ,
C    KPN+NWQ+5<=6LTN+MEMSIZ, KPN+NWQ+4<=5LTN+MEMSIZ, KPN+NW<=MEMSIZ+1,
C    KPN+NWQ+2<=MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ,
C    LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         FXSQ = FX*FX                                                   0924

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==LPN,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, 6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=KPN, KPN+KZX+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KPN+KZX+4,
C    5LTN+NWQ<=KPN+MEMSIZ+4, 6LTN+NWQ<=KPN+MEMSIZ+5,
C    7LTN+NWQ<=KPN+MEMSIZ+6, KPN+NWQ+6<=7LTN+MEMSIZ,
C    KPN+NWQ+5<=6LTN+MEMSIZ, KPN+NWQ+4<=5LTN+MEMSIZ, KPN+NW<=MEMSIZ+1,
C    KPN+NWQ+2<=MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ,
C    LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1,
C    NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

C
C UPDATE VORTICITY AND FIND THE NEW STREAMFUNCTION:
C
         DO 680 J = 1, N1H                                              0928

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, J<=KZN,
C    KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, KZO+7LTN<=LZO+MEMSIZ+7,
C    LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LZY+4<=6LTN+MEMSIZ,
C    6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY+LTN<=LZY+MEMSIZ+1, LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, 1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV,
C    1<=LH, 1<=LTN, 4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ,
C    NWH+5<=5LTN+MEMSIZ, NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ,
C    5LTN+NWH<=MEMSIZ+5, 6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ,
C    NWQ+1<=LTN+MEMSIZ, LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2,
C    5LTN+NWQ<=MEMSIZ+2, 6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4,
C    1<=LZY, LZY+NW<=MEMSIZ+1, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL IN(CWORK, KZN, N2PD)                                   0929

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, J<=KZN,
C    KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            F = REAL((J-1)*(J-1))*FXSQ                                  0930

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, J<=KZN,
C    KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            DO 690 I = 2, N2                                            0931

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=I, I<=128, 1<=J,
C    J<=64, J<=KZN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

               CWORK(I) = CWORK(I)*F2/(1.0-F1*(EVAL(I-1)-F))            0932

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=I, I<=128, 1<=J,
C    J<=64, J<=KZN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

               CWORK2(I) = CWORK(I)/(EVAL(I-1)-F)                       0933

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=I, I<=128, 1<=J,
C    J<=64, J<=KZN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

690            CONTINUE                                                 0934

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J<=KZN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CWORK(1) = CWORK(1)*F2/(1.0+F1*F)                           0935

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J<=KZN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CWORK2(1) = 0.0                                             0936

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J<=KZN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            IF (F.NE.0.0) CWORK2(1) = -CWORK(1)/F                       0937

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J<=KZN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CWORK(N2P) = 0.0                                            0938

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J<=KZN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CWORK2(N2P) = 0.0                                           0939

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J<=KZN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(CWORK, KZN, N2PD)                                  0940

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J<=KZN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(CWORK2, KPN, N2PD)                                 0941

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J<=KZN, 1<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN+257<=MEMSIZ, KPY<=MEMSIZ+1,
C    NWQ+1<=KPY, KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+257<=MEMSIZ,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            KPN = KPN+N2PD                                              0942

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN-257, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J<=KZN, 259<=KPN, KZN+258<=KPN,
C    KPN+KZX<=KZN+6LTN+MEMSIZ+253, KZN+6LTN+NWQ+253<=KPN+KZX,
C    KZN+5LTN+NWQ+253<=KPN+MEMSIZ, KZN+6LTN+NWQ+252<=KPN+MEMSIZ,
C    KZN+7LTN+NWQ+251<=KPN+MEMSIZ, KPN+NWQ<=KZN+7LTN+MEMSIZ+251,
C    KPN+NWQ<=KZN+6LTN+MEMSIZ+252, KPN+NWQ<=KZN+5LTN+MEMSIZ+253,
C    KPN+NW<=KZN+MEMSIZ+258, KPN+NWQ<=KZN+MEMSIZ+255, KPN<=MEMSIZ+1,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+257<=MEMSIZ, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            KZN = KZN+N2PD                                              0943

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+258<=KZN, 259<=KPN, KZN<=KPN,
C    KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KTO<=MEMSIZ+1, NWH+1<=KTO, 259<=KZN,
C    KZN<=MEMSIZ+1, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

680         CONTINUE                                                    0944

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

C
C DE-ALIASE UPDATED FIELDS IF REQUESTED:
C
         IF (NOALS.EQ.1) CALL DEALSE(CA, N2P, N1H, LZN)                 0948

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         IF (NOALS.EQ.1) CALL DEALSE(CA, N2P, N1H, LPN)                 0949

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         IF (NOTEMP.NE.1) THEN                                          0950

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

C
C UPDATE TEMPERATURE:
C
            IF (NOALS.EQ.1) CALL IN(EVAL, LEIG, NWEIG)                  0954

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTN<=LTN+MEMSIZ, LTN+NWH+1<=KTN, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            KTN = LTN                                                   0955

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6KTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN==LTN, 6KTN==LZX+5, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, KPN+KZX+5<=6KTN+KZN+MEMSIZ,
C    6KTN+KZN+NWQ<=KPN+KZX+5, 5KTN+KZN+NWQ<=KPN+MEMSIZ+5,
C    6KTN+KZN+NWQ<=KPN+MEMSIZ+6, 7KTN+KZN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=7KTN+KZN+MEMSIZ, KPN+NWQ+6<=6KTN+KZN+MEMSIZ,
C    KPN+NWQ+5<=5KTN+KZN+MEMSIZ, KZN<=KPN, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    1<=KTN, 7KTN+KZO<=LZO+MEMSIZ+7, LZO+NWH+7<=7KTN+KZO,
C    KZX+LZY+4<=6KTN+MEMSIZ, 6KTN+NWQ<=KZX+LZY+4, 6KTN+NWQ<=KZX+2,
C    KTN+KZY<=LZY+MEMSIZ+1, LZY+NWH+1<=KTN+KZY, 4KTN+317<=MEMSIZ,
C    KTN+NW<=MEMSIZ+1, 6KTN+NW<=MEMSIZ+6, 7KTN+NW<=MEMSIZ+7,
C    NWH+6<=6KTN+MEMSIZ, NWH+5<=5KTN+MEMSIZ, NWH+1<=KTN+MEMSIZ,
C    KTN+NWH<=MEMSIZ, 5KTN+NWH<=MEMSIZ+5, 6KTN+NWH<=MEMSIZ+5,
C    NWQ+2<=2KTN+MEMSIZ, NWQ+1<=KTN+MEMSIZ, KTN+NWQ<=MEMSIZ+1,
C    2KTN+NWQ<=MEMSIZ+2, 5KTN+NWQ<=MEMSIZ+2, 6KTN+NWQ<=MEMSIZ+3,
C    7KTN+NWQ<=MEMSIZ+4, KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN,
C    KZN<=MEMSIZ+1, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, 1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV,
C    1<=LH, LPN<=MEMSIZ, 1<=LZY, LZY+NW<=MEMSIZ+1, 1<=MEMSIZ,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            F1 = RKAPA*DTT                                              0956

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6KTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN==LTN, 6KTN==LZX+5, KTO+LZY==KZY+LTO,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, KPN+KZX+5<=6KTN+KZN+MEMSIZ,
C    6KTN+KZN+NWQ<=KPN+KZX+5, 5KTN+KZN+NWQ<=KPN+MEMSIZ+5,
C    6KTN+KZN+NWQ<=KPN+MEMSIZ+6, 7KTN+KZN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=7KTN+KZN+MEMSIZ, KPN+NWQ+6<=6KTN+KZN+MEMSIZ,
C    KPN+NWQ+5<=5KTN+KZN+MEMSIZ, KZN<=KPN, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    1<=KTN, 7KTN+KZO<=LZO+MEMSIZ+7, LZO+NWH+7<=7KTN+KZO,
C    KZX+LZY+4<=6KTN+MEMSIZ, 6KTN+NWQ<=KZX+LZY+4, 6KTN+NWQ<=KZX+2,
C    KTN+KZY<=LZY+MEMSIZ+1, LZY+NWH+1<=KTN+KZY, 4KTN+317<=MEMSIZ,
C    KTN+NW<=MEMSIZ+1, 6KTN+NW<=MEMSIZ+6, 7KTN+NW<=MEMSIZ+7,
C    NWH+6<=6KTN+MEMSIZ, NWH+5<=5KTN+MEMSIZ, NWH+1<=KTN+MEMSIZ,
C    KTN+NWH<=MEMSIZ, 5KTN+NWH<=MEMSIZ+5, 6KTN+NWH<=MEMSIZ+5,
C    NWQ+2<=2KTN+MEMSIZ, NWQ+1<=KTN+MEMSIZ, KTN+NWQ<=MEMSIZ+1,
C    2KTN+NWQ<=MEMSIZ+2, 5KTN+NWQ<=MEMSIZ+2, 6KTN+NWQ<=MEMSIZ+3,
C    7KTN+NWQ<=MEMSIZ+4, KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN,
C    KZN<=MEMSIZ+1, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, KZX<=MEMSIZ+1, NWQ+1<=KZX, LZY+NWH+1<=KZY,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, 1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV,
C    1<=LH, LPN<=MEMSIZ, 1<=LZY, LZY+NW<=MEMSIZ+1, 1<=MEMSIZ,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

            DO 700 J = 1, N1H                                           0957

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    J+LTN<=KTN+1, 259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(CWORK, KTN, N2PD)                                0958

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    J+LTN<=KTN+1, 259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    1<=KTN, KTN+257<=MEMSIZ, KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN,
C    KZN<=MEMSIZ+1, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

               F = REAL((J-1)*(J-1))*FXSQ                               0959

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    J+LTN<=KTN+1, 259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    1<=KTN, KTN+257<=MEMSIZ, KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN,
C    KZN<=MEMSIZ+1, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN,
C    KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

               DO 710 I = 2, N2                                         0960

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=I, I<=128, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, KZN<=KPN,
C    KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, KTN+257<=MEMSIZ,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

                  CWORK(I) = CWORK(I)*F2/(1.0-F1*(EVAL(I-1)-F))         0961

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=I, I<=128, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, KZN<=KPN,
C    KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, KTN+257<=MEMSIZ,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

710               CONTINUE                                              0962

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, KZN<=KPN,
C    KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, KTN+257<=MEMSIZ,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

               CWORK(1) = CWORK(1)*F2/(1.0+F1*F)                        0963

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, KZN<=KPN,
C    KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, KTN+257<=MEMSIZ,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

               CWORK(N2P) = 0.0                                         0964

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, KZN<=KPN,
C    KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, KTN+257<=MEMSIZ,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL OUT(CWORK, KTN, N2PD)                               0965

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, KZN<=KPN,
C    KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 1<=KTN, KTN+257<=MEMSIZ,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

               KTN = KTN+N2PD                                           0966

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+LTN+257<=KTN, 259<=KPN, KZN<=KPN,
C    KPN+KZX+5<=KZN+6LTN+MEMSIZ, KZN+6LTN+NWQ<=KPN+KZX+5,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1,
C    KPY<=MEMSIZ+1, NWQ+1<=KPY, 259<=KTN, KTN<=MEMSIZ+1,
C    KTO<=MEMSIZ+1, NWH+1<=KTO, 322<=KZN, KZN<=MEMSIZ+1,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO,
C    KZX+LZY+4<=6LTN+MEMSIZ, 6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2,
C    KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY+LTN<=LZY+MEMSIZ+1,
C    LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY, KZY<=MEMSIZ+1, NWH+1<=KZY,
C    1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV, 1<=LH, LPN<=MEMSIZ, 1<=LTN,
C    4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ,
C    NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5,
C    6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

700            CONTINUE                                                 0967

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    259<=KTN, LTN+321<=KTN, KTN<=MEMSIZ+1, KTO<=MEMSIZ+1, NWH+1<=KTO,
C    322<=KZN, KZN<=MEMSIZ+1, KZO+7LTN<=LZO+MEMSIZ+7,
C    LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LZY+4<=6LTN+MEMSIZ,
C    6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY+LTN<=LZY+MEMSIZ+1, LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, 1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV,
C    1<=LH, LPN<=MEMSIZ, 1<=LTN, 4LTN+317<=MEMSIZ, LTN+NW<=MEMSIZ+1,
C    6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7, NWH+6<=6LTN+MEMSIZ,
C    NWH+5<=5LTN+MEMSIZ, NWH+1<=LTN+MEMSIZ, LTN+NWH<=MEMSIZ,
C    5LTN+NWH<=MEMSIZ+5, 6LTN+NWH<=MEMSIZ+5, NWQ+2<=2LTN+MEMSIZ,
C    NWQ+1<=LTN+MEMSIZ, LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2,
C    5LTN+NWQ<=MEMSIZ+2, 6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4,
C    1<=LZY, LZY+NW<=MEMSIZ+1, 1<=MEMSIZ, NW<=MEMSIZ, NWH+1<=MEMSIZ,
C    NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NW, 1<=NWH,
C    1<=NWQ}

C
C DE-ALIASE IF REQUESTED:
C
            IF (NOALS.EQ.1) CALL DEALSE(CA, N2P, N1H, LTN)              0971
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    259<=KTN, LTN+321<=KTN, KTN<=MEMSIZ+1, KTO<=MEMSIZ+1, NWH+1<=KTO,
C    322<=KZN, KZN<=MEMSIZ+1, KZO+7LTN<=LZO+MEMSIZ+7,
C    LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LZY+4<=6LTN+MEMSIZ,
C    6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY+LTN<=LZY+MEMSIZ+1, LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, 1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV,
C    1<=LH, LPN<=MEMSIZ, 1<=LTN, LTN<=MEMSIZ, 4LTN+317<=MEMSIZ,
C    LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7,
C    NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ, NWH+1<=LTN+MEMSIZ,
C    LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5, 6LTN+NWH<=MEMSIZ+5,
C    NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ, LTN+NWQ<=MEMSIZ+1,
C    2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2, 6LTN+NWQ<=MEMSIZ+3,
C    7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1, 1<=MEMSIZ,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

C
C AT LAST, THE END OF THE TIME STEP:
C
         DTT = DT+DT                                                    0976

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    259<=KTN, LTN+321<=KTN, KTN<=MEMSIZ+1, KTO<=MEMSIZ+1, NWH+1<=KTO,
C    322<=KZN, KZN<=MEMSIZ+1, KZO+7LTN<=LZO+MEMSIZ+7,
C    LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LZY+4<=6LTN+MEMSIZ,
C    6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY+LTN<=LZY+MEMSIZ+1, LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, 1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV,
C    1<=LH, LPN<=MEMSIZ, 1<=LTN, LTN<=MEMSIZ, 4LTN+317<=MEMSIZ,
C    LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7,
C    NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ, NWH+1<=LTN+MEMSIZ,
C    LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5, 6LTN+NWH<=MEMSIZ+5,
C    NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ, LTN+NWQ<=MEMSIZ+1,
C    2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2, 6LTN+NWQ<=MEMSIZ+3,
C    7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1, 1<=MEMSIZ,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         T = T+DT                                                       0977

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    6LTN==LZX+5, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, KZN<=KPN, KPN+KZX+5<=KZN+6LTN+MEMSIZ,
C    KZN+6LTN+NWQ<=KPN+KZX+5, KZN+5LTN+NWQ<=KPN+MEMSIZ+5,
C    KZN+6LTN+NWQ<=KPN+MEMSIZ+6, KZN+7LTN+NWQ<=KPN+MEMSIZ+7,
C    KPN+NWQ+7<=KZN+7LTN+MEMSIZ, KPN+NWQ+6<=KZN+6LTN+MEMSIZ,
C    KPN+NWQ+5<=KZN+5LTN+MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, KPN<=MEMSIZ+1, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    259<=KTN, LTN+321<=KTN, KTN<=MEMSIZ+1, KTO<=MEMSIZ+1, NWH+1<=KTO,
C    322<=KZN, KZN<=MEMSIZ+1, KZO+7LTN<=LZO+MEMSIZ+7,
C    LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, KZX+LZY+4<=6LTN+MEMSIZ,
C    6LTN+NWQ<=KZX+LZY+4, 6LTN+NWQ<=KZX+2, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY+LTN<=LZY+MEMSIZ+1, LZY+NWH+1<=KZY+LTN, LZY+NWH+1<=KZY,
C    KZY<=MEMSIZ+1, NWH+1<=KZY, 1<=LEIG, LEIG+126<=MEMSIZ, LH<=LEV,
C    1<=LH, LPN<=MEMSIZ, 1<=LTN, LTN<=MEMSIZ, 4LTN+317<=MEMSIZ,
C    LTN+NW<=MEMSIZ+1, 6LTN+NW<=MEMSIZ+6, 7LTN+NW<=MEMSIZ+7,
C    NWH+6<=6LTN+MEMSIZ, NWH+5<=5LTN+MEMSIZ, NWH+1<=LTN+MEMSIZ,
C    LTN+NWH<=MEMSIZ, 5LTN+NWH<=MEMSIZ+5, 6LTN+NWH<=MEMSIZ+5,
C    NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ, LTN+NWQ<=MEMSIZ+1,
C    2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2, 6LTN+NWQ<=MEMSIZ+3,
C    7LTN+NWQ<=MEMSIZ+4, 1<=LZY, LZY+NW<=MEMSIZ+1, 1<=MEMSIZ,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 1<=NW, 1<=NWH, 1<=NWQ}

         NSTEPS = NSTEPS+1                                              0978

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NW, 1<=NWH, 1<=NWQ}

         IF (NUMBER.GE.NSTEPS) GOTO 150                                 0979
C#
      ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

C
      WRITE (6, 9010) TXXXIN, TXXOUT, TXXRCS, TXXCSR, TXSCSC, TXACAC    0983
     &, TFTVMT, TXSHUF, TUSHUF, TXPRNT, TXLOG2                          0983

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      WRITE (6, 9020) EXXRCS, EXXCSR, EXSCSC, EXACAC, EFTVMT            0985

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      WRITE (6, 9030) NXXXIN, NXXOUT, NXXRCS, NXXCSR, NXSCSC, NXACAC    0986
     &, NFTVMT, NXSHUF, NUSHUF, NXPRNT, NXLOG2                          0986

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

C
      CALL BUG('AFTER  ALL')                                            0989

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

C
      CALL CPUTIM(CPU2)                                                 0991

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      CALL ELAPSE(TCLCK2)                                               0992

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

C
      TWALL = MOD(TCLCK2-TCLCK1+1000000.0, 1000000.0)                   0994

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      WRITE (6, 9040) TWALL                                             0995

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      WRITE (1, *)                                                      0996

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      WRITE (1, *) 'ELAPSED CPU TIME IN SECONDS: ', CPU2-CPU1           0997

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

C MFLOPS RATE = MFLOP 1 CPU CRAY X-MP/CPU TIME
      WRITE (1, *) 'MFLOPS RATE: ', 1657.863/(CPU2-CPU1)                0999

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      WRITE (1, *) 'ELAPSED WALLCLOCK TIME IN SECONDS: ', TWALL         1000

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      WRITE (1, 9050)                                                   1001

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      WRITE (1, 9080) (CDAT(I), I = 1, 15)                              1002

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      VALID = 1                                                         1003

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, VALID==1, KZN<=KPN,
C    KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

      DO 720 I = 1, 15                                                  1004

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=15,
C    KZN<=KPN, KZN+5LTN+NWQ<=KPN+MEMSIZ+5, KZN+6LTN+NWQ<=KPN+MEMSIZ+6,
C    KZN+7LTN+NWQ<=KPN+MEMSIZ+7, KPN+NWQ+7<=KZN+7LTN+MEMSIZ,
C    KPN+NWQ+6<=KZN+6LTN+MEMSIZ, KPN+NWQ+5<=KZN+5LTN+MEMSIZ,
C    KPN+NW<=KZN+MEMSIZ, KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+7<=KZO+7LTN, KZO<=LZO+MEMSIZ,
C    LZO+NWH+1<=KZO, KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH,
C    1<=LTN, 8LTN+119<=MEMSIZ, 5LTN+NW<=MEMSIZ+5, 6LTN+NW<=MEMSIZ+6,
C    7LTN+NW<=MEMSIZ+7, NWQ+2<=2LTN+MEMSIZ, NWQ+1<=LTN+MEMSIZ,
C    LTN+NWQ<=MEMSIZ+1, 2LTN+NWQ<=MEMSIZ+2, 5LTN+NWQ<=MEMSIZ+2,
C    6LTN+NWQ<=MEMSIZ+3, 7LTN+NWQ<=MEMSIZ+4, NW<=MEMSIZ,
C    NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

         IF (I.EQ.3.OR.I.EQ.13) THEN                                    1005

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, 7LEIG==8LZY-1, LMAPP==1,
C    LPY==5LTN-4, 6LPY==5LZX+1, LSKIP==2, 4LTN==LTO+3, LVECT==127,
C    LZN==1, 7LZX==6LZY+1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 3<=I, I<=13,
C    KZN<=KPN, 8KZN+5LEIG+8NWQ<=8KPN+8MEMSIZ+5,
C    8KZN+7LEIG+8NWQ<=8KPN+8MEMSIZ+7, 4KZN+3LEIG+4NWQ<=4KPN+4MEMSIZ+3,
C    4KPN+4NWQ+3<=4KZN+3LEIG+4MEMSIZ, 8KPN+8NWQ+7<=8KZN+7LEIG+8MEMSIZ,
C    8KPN+8NWQ+5<=8KZN+5LEIG+8MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN, 8KZO+7LEIG<=8LZO+8MEMSIZ+7,
C    8LZO+8NWH+7<=8KZO+7LEIG, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=LEIG, LEIG+126<=MEMSIZ,
C    3LEIG+4NW<=4MEMSIZ+3, 5LEIG+8NW<=8MEMSIZ+5, 7LEIG+8NW<=8MEMSIZ+7,
C    8NWQ+1<=LEIG+8MEMSIZ, 4NWQ+1<=LEIG+4MEMSIZ, LEIG+8NWQ<=8MEMSIZ+1,
C    LEIG+4NWQ<=4MEMSIZ+1, 3LEIG+4NWQ+9<=4MEMSIZ,
C    5LEIG+8NWQ+19<=8MEMSIZ, 7LEIG+8NWQ+17<=8MEMSIZ, LH<=LEV, 1<=LH,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

            IF (ABS(CDAT(I)).GT.ABS(VDAT(I))) VALID = 0                 1006

         ELSEIF (ABS(VDAT(I)-CDAT(I)).GT.ABS(.01*VDAT(I))) THEN         1005

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, 7LEIG==8LZY-1, LMAPP==1,
C    LPY==5LTN-4, 6LPY==5LZX+1, LSKIP==2, 4LTN==LTO+3, LVECT==127,
C    LZN==1, 7LZX==6LZY+1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=15,
C    KZN<=KPN, 8KZN+5LEIG+8NWQ<=8KPN+8MEMSIZ+5,
C    8KZN+7LEIG+8NWQ<=8KPN+8MEMSIZ+7, 4KZN+3LEIG+4NWQ<=4KPN+4MEMSIZ+3,
C    4KPN+4NWQ+3<=4KZN+3LEIG+4MEMSIZ, 8KPN+8NWQ+7<=8KZN+7LEIG+8MEMSIZ,
C    8KPN+8NWQ+5<=8KZN+5LEIG+8MEMSIZ, KPN+NW<=KZN+MEMSIZ,
C    KPN+NWQ+3<=KZN+MEMSIZ, 65<=KZN, 8KZO+7LEIG<=8LZO+8MEMSIZ+7,
C    8LZO+8NWH+7<=8KZO+7LEIG, KZO<=LZO+MEMSIZ, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=LEIG, LEIG+126<=MEMSIZ,
C    3LEIG+4NW<=4MEMSIZ+3, 5LEIG+8NW<=8MEMSIZ+5, 7LEIG+8NW<=8MEMSIZ+7,
C    8NWQ+1<=LEIG+8MEMSIZ, 4NWQ+1<=LEIG+4MEMSIZ, LEIG+8NWQ<=8MEMSIZ+1,
C    LEIG+4NWQ<=4MEMSIZ+1, 3LEIG+4NWQ+9<=4MEMSIZ,
C    5LEIG+8NWQ+19<=8MEMSIZ, 7LEIG+8NWQ+17<=8MEMSIZ, LH<=LEV, 1<=LH,
C    NW<=MEMSIZ, NWH+1<=MEMSIZ, NWQ<=MEMSIZ, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

            VALID = 0                                                   1009
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=15,
C    LPN+64<=KPN, KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LPN,
C    LPN+NW<=MEMSIZ+1, LPN+NWQ+2<=MEMSIZ, 1<=LTN, 8LTN+119<=MEMSIZ,
C    7LTN+NW<=MEMSIZ+7, 7LTN+NWQ<=MEMSIZ+4, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}


720      CONTINUE                                                       1012

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {I==16, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5, 7LTN==LZY+6,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LPN+64<=KPN,
C    KZO+7LTN<=LZO+MEMSIZ+7, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    LPN+NWQ+2<=MEMSIZ, 1<=LTN, 8LTN+119<=MEMSIZ, 7LTN+NW<=MEMSIZ+7,
C    7LTN+NWQ<=MEMSIZ+4, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

C
      IF (VALID.EQ.1) THEN                                              1014

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {I==16, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, 7LEIG==8LZY-1, LMAPP==1,
C    6LPY==5LZX+1, 7LPY==5LZY+2, LSKIP==2, 4LTN==LTO+3, 6LTN==LZX+5,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, VALID==1,
C    LPN+64<=KPN, 8KZO+7LEIG<=8LZO+8MEMSIZ+7, LZO+NWH+1<=KZO,
C    KZO<=MEMSIZ+1, NWH+1<=KZO, 1<=LEIG, LEIG+126<=MEMSIZ,
C    7LEIG+8NW<=8MEMSIZ+7, 7LEIG+8NWQ+17<=8MEMSIZ, LH<=LEV, 1<=LH,
C    1<=LPN, LPN+NW<=MEMSIZ+1, LPN+NWQ+2<=MEMSIZ, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

         WRITE (1, 9060)                                                1015

      ELSE

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {I==16, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==8LTN-7, LMAPP==1,
C    6LPY==5LZX+1, 7LPY==5LZY+2, LSKIP==2, 7LTN==LZY+6, 3LTO==2LZX+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LPN+64<=KPN,
C    4KZO+7LTO<=4LZO+4MEMSIZ+7, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    LPN+NWQ+2<=MEMSIZ, 1<=LTO, 2LTO+125<=MEMSIZ, 7LTO+4NW<=4MEMSIZ+7,
C    7LTO+4NWQ+5<=4MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}

         WRITE (1, 9070)                                                1018
      ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {I==16, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+LPN==KPN+1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LEIG==2LTO-1, LMAPP==1,
C    4LPY==5LTO-1, LSKIP==2, 4LTN==LTO+3, 3LTO==2LZX+1, 7LTO==4LZY+3,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LPN+64<=KPN,
C    4KZO+7LTO<=4LZO+4MEMSIZ+7, LZO+NWH+1<=KZO, KZO<=MEMSIZ+1,
C    NWH+1<=KZO, LH<=LEV, 1<=LH, 1<=LPN, LPN+NW<=MEMSIZ+1,
C    LPN+NWQ+2<=MEMSIZ, 1<=LTO, 2LTO+125<=MEMSIZ, 7LTO+4NW<=4MEMSIZ+7,
C    7LTO+4NWQ+5<=4MEMSIZ, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NW, 1<=NWH, 1<=NWQ}


      STOP                                                              1021

C  P() {0==-1}


9000  FORMAT(1X,'OUTPUT FOR PERFECT CLUB BENCHMARK: OCEAN INSTRUMENTED V
     &ERSION',/,1X,'$Revision: 1.A.1 $ $Author: psharma $',/)           1023

C  P() {0==-1}

C


9010  FORMAT(/,2X,'SUBROUTINE    IN, EX-TIME FOR FIRST CALL =',1P,E13.6,
     &' SECONDS',/,2X,'SUBROUTINE   OUT, EX-TIME FOR FIRST CALL =',1P,E1
     &3.6,/,2X,'SUBROUTINE   RCS, EX-TIME FOR FIRST CALL =',1P,E13.6,/,2
     &X,'SUBROUTINE   CSR, EX-TIME FOR FIRST CALL =',1P,E13.6,/,2X,'SUBR
     &OUTINE  SCSC, EX-TIME FOR FIRST CALL =',1P,E13.6,/,2X,'SUBROUTINE 
     & ACAC, EX-TIME FOR FIRST CALL =',1P,E13.6,/,2X,'SUBROUTINE FTRVMT 
     &EX-TIME FOR FIRST CALL =',1P,E13.6,/,2X,'SUBROUTINE  SHUF, EX-TIME
     & FOR FIRST CALL =',1P,E13.6,/,2X,'SUBROUTINE UNSHUF EX-TIME FOR FI
     &RST CALL =',1P,E13.6,/,2X,'SUBROUTINE RPRINT EX-TIME FOR FIRST CAL
     &L =',1P,E13.6,/,2X,'SUBROUTINE XLOG2, EX-TIME FOR FIRST CALL =',1P
     &,E13.6)                                                           1027

C  P() {0==-1}


9020  FORMAT(/,2X,'SUBROUTINE   RCS, EX-TIME LAST TIMESTEP  =',1P,E13.6,
     &' SECONDS',/,2X,'SUBROUTINE   CSR, EX-TIME LAST TIMESTEP  =',1P,E1
     &3.6,/,2X,'SUBROUTINE  SCSC, EX-TIME LAST TIMESTEP  =',1P,E13.6,/,2
     &X,'SUBROUTINE  ACAC, EX-TIME LAST TIMESTEP  =',1P,E13.6,/,2X,'SUBR
     &OUTINE FTRVMT EX-TIME LAST TIMESTEP  =',1P,E13.6)                 1043

C  P() {0==-1}



9030  FORMAT(/,2X,'SUBROUTINE    IN, CUMULATIVE CALLS TO    =',I12,/,2X,
     &'SUBROUTINE   OUT, CUMULATIVE CALLS TO    =',I12,/,2X,'SUBROUTINE 
     &  RCS, CUMULATIVE CALLS TO    =',I12,/,2X,'SUBROUTINE   CSR, CUMUL
     &ATIVE CALLS TO    =',I12,/,2X,'SUBROUTINE  SCSC, CUMULATIVE CALLS 
     &TO    =',I12,/,2X,'SUBROUTINE  ACAC, CUMULATIVE CALLS TO    =',I12
     &,/,2X,'SUBROUTINE FTRVMT CUMULATIVE CALLS TO    =',I12,/,2X,'SUBRO
     &UTINE  SHUF, CUMULATIVE CALLS TO    =',I12,/,2X,'SUBROUTINE UNSHUF
     & CUMULATIVE CALLS TO    =',I12,/,2X,'SUBROUTINE RPRINT CUMULATIVE 
     &CALLS TO    =',I12,/,2X,'SUBROUTINE XLOG2, CUMULATIVE CALLS TO    
     &=',I12)                                                           1051

C  P() {0==-1}

9040  FORMAT(/,2X,'MEASURE OF WALL-CLOCK TIME (ENVIRONMENT SENSITIVE)',/
     &,2X,'FOR EXECUTION ONLY =',1P,E13.6,1X,'SECONDS')                 1064

C  P() {0==-1}

C
9050  FORMAT(/,1X,'VALIDATION PARAMETERS:',/)                           1067

C  P() {0==-1}

9060  FORMAT(/,/,1X,'RESULTS FOR THIS RUN ARE:   VALID')                1068

C  P() {0==-1}

9070  FORMAT(/,/,1X,'RESULTS FOR THIS RUN ARE: INVALID')                1069

C  P() {0==-1}

9080  FORMAT(5E15.5)                                                    1070

      END
