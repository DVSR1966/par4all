setproperty ABORT_ON_USER_ERROR TRUE
delete outlining02
create outlining02 outlining02.c


echo
echo Initial code
echo

# activate PRINT_CODE_CUMULATED_EFFECTS
display PRINTED_FILE[main]

echo
echo Code after outlining
echo

setproperty OUTLINE_MODULE_NAME "outlined"
setproperty OUTLINE_LABEL "l0"
apply OUTLINE[main]
display PRINTED_FILE[main]
display PRINTED_FILE[outlined]

echo
echo Unsplit resulting code
echo

apply UNSPLIT
shell gcc outlining02.c -o outlining
shell gcc outlining02.database/Src/outlining02.c -o outlining02.database/Src/outlining
shell if test `outlining02.database/Src/outlining` = `outlining`; then echo "ok"; else echo "ko" ; fi
shell rm -rf outlining02.database/Src/outlining outlining

close
delete outlining02
quit

