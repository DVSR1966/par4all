Ticket 550. See comments in C file.
