
Inital code

void convol(int isi, int isj, float new_image[isi][isj], float image[isi][isj], float kernel[3][3])
{
   int i;
   int j;

   for(i = 0; i <= isi-1; i += 1)
      for(j = 0; j <= isj-1; j += 1)
         new_image[i][j] = image[i][j];

   for(i = 1; i <= isi-2; i += 1)
      for(j = 1; j <= isj-2; j += 1)
         run_kernel(i, j, isi, isj, new_image, image, kernel);
}
void run_kernel(int i, int j, int isi, int isj, float new_image[isi][isj], float image[isi][isj], float kernel[3][3])
{
   int ki;
   int kj;
   new_image[i][j] = 0.;
   for(ki = 0; ki <= 2; ki += 1)
      for(kj = 0; kj <= 2; kj += 1)
         

         new_image[i][j] = new_image[i][j]+image[i+ki-3/2][j+kj-3/2]*kernel[ki][kj];
   new_image[i][j] = new_image[i][j]/(3*3);
}

After Inlining

void convol(int isi, int isj, float new_image[isi][isj], float image[isi][isj], float kernel[3][3])
{
   int i;
   int j;

   for(i = 0; i <= isi-1; i += 1)
      for(j = 0; j <= isj-1; j += 1)
         new_image[i][j] = image[i][j];

   for(i = 1; i <= isi-2; i += 1)
      for(j = 1; j <= isj-2; j += 1) {
         int ki;
         int kj;
         new_image[i][j] = 0.;
         for(ki = 0; ki <= 2; ki += 1)
            for(kj = 0; kj <= 2; kj += 1)
               

               new_image[i][j] = new_image[i][j]+image[i+ki-3/2][j+kj-3/2]*kernel[ki][kj];
         new_image[i][j] = new_image[i][j]/(3*3);
      }
}

after Kernelize

void convol(int isi, int isj, float new_image[isi][isj], float image[isi][isj], float kernel[3][3])
{
   int i;
   int j;

#pragma omp parallel for private(j)
l99997:
   for(i = 0; i <= isi-1; i += 1)
#pragma omp parallel for 
l99998:
      for(j = 0; j <= isj-1; j += 1)
         new_image[i][j] = image[i][j];

l99993:   work(isi, isj, image, kernel, new_image);
}
void work(int isi, int isj, float image[isi][isj], float kernel[3][3], float new_image[isi][isj])
{
   int j;
   int i;
   extern void microcode(int i, int isi, int isj, float image[isi][isj], float kernel[3][3], float new_image[isi][isj]);

l99993:
   for(i = 1; i <= isi-2; i += 128)
      microcode(i, isi, isj, image, kernel, new_image);
}
void microcode(int i, int isi, int isj, float image[isi][isj], float kernel[3][3], float new_image[isi][isj])
{
   int j;
   {
      int i_1;
      for(i_1 = i; i_1 <= MIN(i+127, isi-2); i_1 += 1)
l99994:
         for(j = 1; j <= isj-2; j += 1) {
            int ki;
            int kj;
            new_image[i_1][j] = 0.;
l99995:
            for(ki = 0; ki <= 2; ki += 1)
l99996:
               for(kj = 0; kj <= 2; kj += 1)
                  

                  new_image[i_1][j] = new_image[i_1][j]+image[i_1+ki-3/2][j+kj-3/2]*kernel[ki][kj];
            new_image[i_1][j] = new_image[i_1][j]/(3*3);
         }
   }
}
void microcode(int i, int isi, int isj, float image[isi][isj], float kernel[3][3], float new_image[isi][isj])
{
   int j;
   {
      int i_1;
      for(i_1 = i; i_1 <= MIN(i+127, isi-2); i_1 += 1)
l99994:
         for(j = 1; j <= isj-2; j += 1) {
            int ki;
            int kj;
            new_image[i_1][j] = 0.;
l99995:
            for(ki = 0; ki <= 2; ki += 1)
l99996:
               for(kj = 0; kj <= 2; kj += 1)
                  

                  new_image[i_1][j] = new_image[i_1][j]+image[i_1+ki-1][j+kj-1]*kernel[ki][kj];
            new_image[i_1][j] = new_image[i_1][j]/9;
         }
   }
   ;
}

Microcode after normalization

found invalid expression new_image[i_1][j] of basic float
found invalid expression 0. of basic float
found invalid expression new_image[i_1][j] of basic float
found invalid expression new_image[i_1][j] of basic float
found invalid expression image[i_1+ki-1][j+kj-1] of basic float
found invalid expression kernel[ki][kj] of basic float
found invalid expression new_image[i_1][j] of basic float
found invalid expression new_image[i_1][j] of basic float
image seems an image
kernel seems a kernel
new_image seems an image

Microcode after scalarization

void microcode(int i, int isi, int isj, float image[isi][isj], float kernel[3][3], float new_image[isi][isj])
{
   float __scalar__0;
   int j;
   {
      int i_1;
      for(i_1 = i; i_1 <= MIN(i+127, isi-2); i_1 += 1)
l99994:
         for(j = 1; j <= isj-2; j += 1) {
            int ki;
            int kj;
            __scalar__0 = 0.;
l99995:
            for(ki = 0; ki <= 2; ki += 1)
l99996:
               for(kj = 0; kj <= 2; kj += 1)
                  

                  __scalar__0 = __scalar__0+image[i_1+ki-1][j+kj-1]*kernel[ki][kj];
            __scalar__0 = __scalar__0/9;
            new_image[i_1][j] = __scalar__0;
         }
   }
   ;
}

Microcode After array conversion

void microcode(int i, int isi, int isj, float *image, float *kernel, float *new_image)
{
   float __scalar__0;
   int j;
   {
      int i_1;
      for(i_1 = i; i_1 <= MIN(i+127, isi-2); i_1 += 1)
l99994:
         for(j = 1; j <= isj-2; j += 1) {
            int ki;
            int kj;
            __scalar__0 = 0.;
l99995:
            for(ki = 0; ki <= 2; ki += 1)
l99996:
               for(kj = 0; kj <= 2; kj += 1)
                  

                  __scalar__0 = __scalar__0+image[j+kj-1+isj*(i_1+ki-1)]*kernel[kj+3*ki];
            __scalar__0 = __scalar__0/9;
            new_image[j+isj*i_1] = __scalar__0;
         }
   }
   ;
}

Microcode after flattening

void microcode(int i, int isi, int isj, float *image, float *kernel, float *new_image)
{
   ;
}

Microcode after CSE

void microcode(int i, int isi, int isj, float *image, float *kernel, float *new_image)
{
   ;
}

Microcode after ICM

void microcode(int i, int isi, int isj, float *image, float *kernel, float *new_image)
{
}

Microcode After atomization

void microcode(int i, int isi, int isj, float *image, float *kernel, float *new_image)
{
}
